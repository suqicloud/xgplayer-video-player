!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("core-js/modules/es.json.stringify.js"),require("core-js/modules/es.regexp.exec.js"),require("core-js/modules/es.regexp.test.js"),require("core-js/modules/es.object.to-string.js"),require("core-js/modules/es.promise.js"),require("core-js/modules/es.promise.finally.js"),require("core-js/modules/es.object.assign.js"),require("core-js/modules/es.array.splice.js"),require("core-js/modules/web.dom-collections.for-each.js"),require("core-js/modules/es.object.keys.js"),require("core-js/modules/es.function.name.js"),require("core-js/modules/es.array.concat.js"),require("xgplayer"),require("core-js/modules/es.array.map.js"),require("core-js/modules/es.array.iterator.js"),require("core-js/modules/es.typed-array.uint8-array.js"),require("core-js/modules/esnext.typed-array.at.js"),require("core-js/modules/es.typed-array.copy-within.js"),require("core-js/modules/es.typed-array.every.js"),require("core-js/modules/es.typed-array.fill.js"),require("core-js/modules/es.typed-array.filter.js"),require("core-js/modules/es.typed-array.find.js"),require("core-js/modules/es.typed-array.find-index.js"),require("core-js/modules/esnext.typed-array.find-last.js"),require("core-js/modules/esnext.typed-array.find-last-index.js"),require("core-js/modules/es.typed-array.for-each.js"),require("core-js/modules/es.typed-array.includes.js"),require("core-js/modules/es.typed-array.index-of.js"),require("core-js/modules/es.typed-array.iterator.js"),require("core-js/modules/es.typed-array.join.js"),require("core-js/modules/es.typed-array.last-index-of.js"),require("core-js/modules/es.typed-array.map.js"),require("core-js/modules/es.typed-array.reduce.js"),require("core-js/modules/es.typed-array.reduce-right.js"),require("core-js/modules/es.typed-array.reverse.js"),require("core-js/modules/es.typed-array.set.js"),require("core-js/modules/es.typed-array.slice.js"),require("core-js/modules/es.typed-array.some.js"),require("core-js/modules/es.typed-array.sort.js"),require("core-js/modules/es.typed-array.subarray.js"),require("core-js/modules/es.typed-array.to-locale-string.js"),require("core-js/modules/es.typed-array.to-string.js"),require("core-js/modules/es.array.find.js"),require("core-js/modules/es.number.constructor.js"),require("core-js/modules/es.array.filter.js"),require("core-js/modules/es.array.slice.js"),require("core-js/modules/es.symbol.js"),require("core-js/modules/es.symbol.iterator.js"),require("core-js/modules/es.string.iterator.js"),require("core-js/modules/web.dom-collections.iterator.js"),require("core-js/modules/es.symbol.description.js"),require("core-js/modules/es.array.includes.js"),require("core-js/modules/es.string.includes.js"),require("core-js/modules/es.number.is-finite.js"),require("core-js/modules/es.regexp.to-string.js"),require("core-js/modules/es.math.hypot.js"),require("core-js/modules/es.array.join.js"),require("core-js/modules/es.string.from-code-point.js"),require("core-js/modules/es.array.sort.js"),require("core-js/modules/es.regexp.flags.js"),require("core-js/modules/es.string.pad-start.js"),require("core-js/modules/es.array.from.js"),require("core-js/modules/es.array-buffer.constructor.js"),require("core-js/modules/es.typed-array.int8-array.js"),require("core-js/modules/es.typed-array.uint8-clamped-array.js"),require("core-js/modules/es.typed-array.int16-array.js"),require("core-js/modules/es.typed-array.uint16-array.js"),require("core-js/modules/es.typed-array.int32-array.js"),require("core-js/modules/es.typed-array.uint32-array.js"),require("core-js/modules/es.typed-array.float32-array.js"),require("core-js/modules/es.typed-array.float64-array.js"),require("core-js/modules/web.url.js"),require("core-js/modules/web.url-search-params.js"),require("core-js/modules/es.string.replace.js"),require("core-js/modules/es.number.is-nan.js"),require("core-js/modules/es.object.get-prototype-of.js"),require("core-js/modules/es.string.trim.js"),require("core-js/modules/es.set.js")):"function"==typeof define&&define.amd?define(["core-js/modules/es.json.stringify.js","core-js/modules/es.regexp.exec.js","core-js/modules/es.regexp.test.js","core-js/modules/es.object.to-string.js","core-js/modules/es.promise.js","core-js/modules/es.promise.finally.js","core-js/modules/es.object.assign.js","core-js/modules/es.array.splice.js","core-js/modules/web.dom-collections.for-each.js","core-js/modules/es.object.keys.js","core-js/modules/es.function.name.js","core-js/modules/es.array.concat.js","xgplayer","core-js/modules/es.array.map.js","core-js/modules/es.array.iterator.js","core-js/modules/es.typed-array.uint8-array.js","core-js/modules/esnext.typed-array.at.js","core-js/modules/es.typed-array.copy-within.js","core-js/modules/es.typed-array.every.js","core-js/modules/es.typed-array.fill.js","core-js/modules/es.typed-array.filter.js","core-js/modules/es.typed-array.find.js","core-js/modules/es.typed-array.find-index.js","core-js/modules/esnext.typed-array.find-last.js","core-js/modules/esnext.typed-array.find-last-index.js","core-js/modules/es.typed-array.for-each.js","core-js/modules/es.typed-array.includes.js","core-js/modules/es.typed-array.index-of.js","core-js/modules/es.typed-array.iterator.js","core-js/modules/es.typed-array.join.js","core-js/modules/es.typed-array.last-index-of.js","core-js/modules/es.typed-array.map.js","core-js/modules/es.typed-array.reduce.js","core-js/modules/es.typed-array.reduce-right.js","core-js/modules/es.typed-array.reverse.js","core-js/modules/es.typed-array.set.js","core-js/modules/es.typed-array.slice.js","core-js/modules/es.typed-array.some.js","core-js/modules/es.typed-array.sort.js","core-js/modules/es.typed-array.subarray.js","core-js/modules/es.typed-array.to-locale-string.js","core-js/modules/es.typed-array.to-string.js","core-js/modules/es.array.find.js","core-js/modules/es.number.constructor.js","core-js/modules/es.array.filter.js","core-js/modules/es.array.slice.js","core-js/modules/es.symbol.js","core-js/modules/es.symbol.iterator.js","core-js/modules/es.string.iterator.js","core-js/modules/web.dom-collections.iterator.js","core-js/modules/es.symbol.description.js","core-js/modules/es.array.includes.js","core-js/modules/es.string.includes.js","core-js/modules/es.number.is-finite.js","core-js/modules/es.regexp.to-string.js","core-js/modules/es.math.hypot.js","core-js/modules/es.array.join.js","core-js/modules/es.string.from-code-point.js","core-js/modules/es.array.sort.js","core-js/modules/es.regexp.flags.js","core-js/modules/es.string.pad-start.js","core-js/modules/es.array.from.js","core-js/modules/es.array-buffer.constructor.js","core-js/modules/es.typed-array.int8-array.js","core-js/modules/es.typed-array.uint8-clamped-array.js","core-js/modules/es.typed-array.int16-array.js","core-js/modules/es.typed-array.uint16-array.js","core-js/modules/es.typed-array.int32-array.js","core-js/modules/es.typed-array.uint32-array.js","core-js/modules/es.typed-array.float32-array.js","core-js/modules/es.typed-array.float64-array.js","core-js/modules/web.url.js","core-js/modules/web.url-search-params.js","core-js/modules/es.string.replace.js","core-js/modules/es.number.is-nan.js","core-js/modules/es.object.get-prototype-of.js","core-js/modules/es.string.trim.js","core-js/modules/es.set.js"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).Mp4Plugin=t(null,null,null,null,null,null,null,null,null,null,null,null,e.Player)}(this,(function(e,t,i,n,s,a,r,l,o,d,c,u,m){"use strict";function h(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function p(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?h(Object(i),!0).forEach((function(t){G(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):h(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Z(){Z=function(){return e};var e={},t=Object.prototype,i=t.hasOwnProperty,n=Object.defineProperty||function(e,t,i){e[t]=i.value},s="function"==typeof Symbol?Symbol:{},a=s.iterator||"@@iterator",r=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function o(e,t,i){return Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{o({},"")}catch(k){o=function(e,t,i){return e[t]=i}}function d(e,t,i,s){var a=t&&t.prototype instanceof m?t:m,r=Object.create(a.prototype),l=new g(s||[]);return n(r,"_invoke",{value:G(e,i,l)}),r}function c(e,t,i){try{return{type:"normal",arg:e.call(t,i)}}catch(k){return{type:"throw",arg:k}}}e.wrap=d;var u={};function m(){}function h(){}function p(){}var y={};o(y,a,(function(){return this}));var b=Object.getPrototypeOf,f=b&&b(b(V([])));f&&f!==t&&i.call(f,a)&&(y=f);var X=p.prototype=m.prototype=Object.create(y);function L(e){["next","throw","return"].forEach((function(t){o(e,t,(function(e){return this._invoke(t,e)}))}))}function W(e,t){function s(n,a,r,l){var o=c(e[n],e,a);if("throw"!==o.type){var d=o.arg,u=d.value;return u&&"object"==typeof u&&i.call(u,"__await")?t.resolve(u.__await).then((function(e){s("next",e,r,l)}),(function(e){s("throw",e,r,l)})):t.resolve(u).then((function(e){d.value=e,r(d)}),(function(e){return s("throw",e,r,l)}))}l(o.arg)}var a;n(this,"_invoke",{value:function(e,i){function n(){return new t((function(t,n){s(e,i,t,n)}))}return a=a?a.then(n,n):n()}})}function G(e,t,i){var n="suspendedStart";return function(s,a){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===s)throw a;return{value:void 0,done:!0}}for(i.method=s,i.arg=a;;){var r=i.delegate;if(r){var l=v(r,i);if(l){if(l===u)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if("suspendedStart"===n)throw n="completed",i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n="executing";var o=c(e,t,i);if("normal"===o.type){if(n=i.done?"completed":"suspendedYield",o.arg===u)continue;return{value:o.arg,done:i.done}}"throw"===o.type&&(n="completed",i.method="throw",i.arg=o.arg)}}}function v(e,t){var i=t.method,n=e.iterator[i];if(void 0===n)return t.delegate=null,"throw"===i&&e.iterator.return&&(t.method="return",t.arg=void 0,v(e,t),"throw"===t.method)||"return"!==i&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+i+"' method")),u;var s=c(n,e.iterator,t.arg);if("throw"===s.type)return t.method="throw",t.arg=s.arg,t.delegate=null,u;var a=s.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function g(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function V(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,s=function t(){for(;++n<e.length;)if(i.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return s.next=s}}return{next:Y}}function Y(){return{value:void 0,done:!0}}return h.prototype=p,n(X,"constructor",{value:p,configurable:!0}),n(p,"constructor",{value:h,configurable:!0}),h.displayName=o(p,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,o(e,l,"GeneratorFunction")),e.prototype=Object.create(X),e},e.awrap=function(e){return{__await:e}},L(W.prototype),o(W.prototype,r,(function(){return this})),e.AsyncIterator=W,e.async=function(t,i,n,s,a){void 0===a&&(a=Promise);var r=new W(d(t,i,n,s),a);return e.isGeneratorFunction(i)?r:r.next().then((function(e){return e.done?e.value:r.next()}))},L(X),o(X,l,"Generator"),o(X,a,(function(){return this})),o(X,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),i=[];for(var n in t)i.push(n);return i.reverse(),function e(){for(;i.length;){var n=i.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=V,g.prototype={constructor:g,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(i,n){return r.type="throw",r.arg=e,t.next=i,n&&(t.method="next",t.arg=void 0),!!n}for(var s=this.tryEntries.length-1;s>=0;--s){var a=this.tryEntries[s],r=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var l=i.call(a,"catchLoc"),o=i.call(a,"finallyLoc");if(l&&o){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!o)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var s=this.tryEntries[n];if(s.tryLoc<=this.prev&&i.call(s,"finallyLoc")&&this.prev<s.finallyLoc){var a=s;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var r=a?a.completion:{};return r.type=e,r.arg=t,a?(this.method="next",this.next=a.finallyLoc,u):this.complete(r)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.finallyLoc===e)return this.complete(i.completion,i.afterLoc),S(i),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.tryLoc===e){var n=i.completion;if("throw"===n.type){var s=n.arg;S(i)}return s}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,i){return this.delegate={iterator:V(e),resultName:t,nextLoc:i},"next"===this.method&&(this.arg=void 0),u}},e}function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e,t,i,n,s,a,r){try{var l=e[a](r),o=l.value}catch(d){return void i(d)}l.done?t(o):Promise.resolve(o).then(n,s)}function f(e){return function(){var t=this,i=arguments;return new Promise((function(n,s){var a=e.apply(t,i);function r(e){b(a,n,s,r,l,"next",e)}function l(e){b(a,n,s,r,l,"throw",e)}r(void 0)}))}}function X(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function L(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,z(n.key),n)}}function W(e,t,i){return t&&L(e.prototype,t),i&&L(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function G(e,t,i){return(t=z(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function v(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&S(e,t)}function x(e){return(x=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e,t){return(S=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function g(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function V(e,t,i){return(V=g()?Reflect.construct.bind():function(e,t,i){var n=[null];n.push.apply(n,t);var s=new(Function.bind.apply(e,n));return i&&S(s,i.prototype),s}).apply(null,arguments)}function Y(e){var t="function"==typeof Map?new Map:void 0;return Y=function(e){if(null===e||(i=e,-1===Function.toString.call(i).indexOf("[native code]")))return e;var i;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return V(e,arguments,x(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),S(n,e)},Y(e)}function k(e,t){if(null==e)return{};var i,n,s=function(e,t){if(null==e)return{};var i,n,s={},a=Object.keys(e);for(n=0;n<a.length;n++)i=a[n],t.indexOf(i)>=0||(s[i]=e[i]);return s}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)i=a[n],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(s[i]=e[i])}return s}function R(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function T(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return R(e)}function w(e){var t=g();return function(){var i,n=x(e);if(t){var s=x(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return T(this,i)}}function M(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=x(e)););return e}function K(){return K="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,i){var n=M(e,t);if(n){var s=Object.getOwnPropertyDescriptor(n,t);return s.get?s.get.call(arguments.length<3?e:i):s.value}},K.apply(this,arguments)}function I(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var n,s,a,r,l=[],o=!0,d=!1;try{if(a=(i=i.call(e)).next,0===t){if(Object(i)!==i)return;o=!1}else for(;!(o=(n=a.call(i)).done)&&(l.push(n.value),l.length!==t);o=!0);}catch(c){d=!0,s=c}finally{try{if(!o&&null!=i.return&&(r=i.return(),Object(r)!==r))return}finally{if(d)throw s}}return l}}(e,t)||C(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function H(e){return function(e){if(Array.isArray(e))return N(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||C(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,t){if(e){if("string"==typeof e)return N(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?N(e,t):void 0}}function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function F(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=C(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0,s=function(){};return{s:s,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,r=!0,l=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return r=e.done,e},e:function(e){l=!0,a=e},f:function(){try{r||null==i.return||i.return()}finally{if(l)throw a}}}}function z(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var U={exports:{}};!function(e){var t=Object.prototype.hasOwnProperty,i="~";function n(){}function s(e,t,i){this.fn=e,this.context=t,this.once=i||!1}function a(e,t,n,a,r){if("function"!=typeof n)throw new TypeError("The listener must be a function");var l=new s(n,a||e,r),o=i?i+t:t;return e._events[o]?e._events[o].fn?e._events[o]=[e._events[o],l]:e._events[o].push(l):(e._events[o]=l,e._eventsCount++),e}function r(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function l(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(i=!1)),l.prototype.eventNames=function(){var e,n,s=[];if(0===this._eventsCount)return s;for(n in e=this._events)t.call(e,n)&&s.push(i?n.slice(1):n);return Object.getOwnPropertySymbols?s.concat(Object.getOwnPropertySymbols(e)):s},l.prototype.listeners=function(e){var t=i?i+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var s=0,a=n.length,r=new Array(a);s<a;s++)r[s]=n[s].fn;return r},l.prototype.listenerCount=function(e){var t=i?i+e:e,n=this._events[t];return n?n.fn?1:n.length:0},l.prototype.emit=function(e,t,n,s,a,r){var l=i?i+e:e;if(!this._events[l])return!1;var o,d,c=this._events[l],u=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),u){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,n),!0;case 4:return c.fn.call(c.context,t,n,s),!0;case 5:return c.fn.call(c.context,t,n,s,a),!0;case 6:return c.fn.call(c.context,t,n,s,a,r),!0}for(d=1,o=new Array(u-1);d<u;d++)o[d-1]=arguments[d];c.fn.apply(c.context,o)}else{var m,h=c.length;for(d=0;d<h;d++)switch(c[d].once&&this.removeListener(e,c[d].fn,void 0,!0),u){case 1:c[d].fn.call(c[d].context);break;case 2:c[d].fn.call(c[d].context,t);break;case 3:c[d].fn.call(c[d].context,t,n);break;case 4:c[d].fn.call(c[d].context,t,n,s);break;default:if(!o)for(m=1,o=new Array(u-1);m<u;m++)o[m-1]=arguments[m];c[d].fn.apply(c[d].context,o)}}return!0},l.prototype.on=function(e,t,i){return a(this,e,t,i,!1)},l.prototype.once=function(e,t,i){return a(this,e,t,i,!0)},l.prototype.removeListener=function(e,t,n,s){var a=i?i+e:e;if(!this._events[a])return this;if(!t)return r(this,a),this;var l=this._events[a];if(l.fn)l.fn!==t||s&&!l.once||n&&l.context!==n||r(this,a);else{for(var o=0,d=[],c=l.length;o<c;o++)(l[o].fn!==t||s&&!l[o].once||n&&l[o].context!==n)&&d.push(l[o]);d.length?this._events[a]=1===d.length?d[0]:d:r(this,a)}return this},l.prototype.removeAllListeners=function(e){var t;return e?(t=i?i+e:e,this._events[t]&&r(this,t)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=i,l.EventEmitter=l,e.exports=l}(U);var J,j=U.exports,P={};Object.defineProperty(P,"__esModule",{value:!0}),P.default=function(e){for(var t=0,i=arguments.length,n=Array(i>1?i-1:0),s=1;s<i;s++)n[s-1]=arguments[s];var a=!0,r=!1,l=void 0;try{for(var o,d=n[Symbol.iterator]();!(a=(o=d.next()).done);a=!0){var c=o.value;t+=c.length}}catch(X){r=!0,l=X}finally{try{!a&&d.return&&d.return()}finally{if(r)throw l}}var u=new e(t),m=0,h=!0,p=!1,Z=void 0;try{for(var y,b=n[Symbol.iterator]();!(h=(y=b.next()).done);h=!0){var f=y.value;u.set(f,m),m+=f.length}}catch(X){p=!0,Z=X}finally{try{!h&&b.return&&b.return()}finally{if(p)throw Z}}return u};var E=((J=P)&&J.__esModule?J:{default:J}).default,D="video",B="audio",_="metadata",Q="av1",O="avc",A="hevc",q="aac",$="g7110a",ee="g7110m",te="opus",ie="LARGE_AV_SHIFT",ne="LARGE_VIDEO_GAP",se="LARGE_VIDEO_GAP_BETWEEN_CHUNK",ae="LARGE_AUDIO_GAP",re="AUDIO_FILLED",le="AUDIO_DROPPED",oe=function(){function e(){X(this,e),G(this,"id",1),G(this,"type",D),G(this,"codecType",O),G(this,"pid",-1),G(this,"hvcC",void 0),G(this,"codec",""),G(this,"timescale",0),G(this,"formatTimescale",0),G(this,"sequenceNumber",0),G(this,"baseMediaDecodeTime",0),G(this,"baseDts",0),G(this,"duration",0),G(this,"warnings",[]),G(this,"samples",[]),G(this,"pps",[]),G(this,"sps",[]),G(this,"vps",[]),G(this,"fpsNum",0),G(this,"fpsDen",0),G(this,"sarRatio",[]),G(this,"width",0),G(this,"height",0),G(this,"nalUnitSize",4),G(this,"present",!1),G(this,"isVideoEncryption",!1),G(this,"isAudioEncryption",!1),G(this,"isVideo",!0),G(this,"lastKeyFrameDts",0),G(this,"kid",null),G(this,"pssh",null),G(this,"ext",void 0)}return W(e,[{key:"reset",value:function(){this.sequenceNumber=this.width=this.height=this.fpsDen=this.fpsNum=this.duration=this.baseMediaDecodeTime=this.timescale=0,this.codec="",this.present=!1,this.pid=-1,this.pps=[],this.sps=[],this.vps=[],this.sarRatio=[],this.samples=[],this.warnings=[],this.hvcC=null}},{key:"firstDts",get:function(){return this.samples.length?this.samples[0].dts:null}},{key:"firstPts",get:function(){return this.samples.length?this.samples[0].pts:null}},{key:"samplesDuration",get:function(){if(this.samples.length>0){var e=this.samples[0],t=this.samples[this.samples.length-1];return t.dts-e.dts+t.duration}return 0}},{key:"exist",value:function(){return!!/av01/.test(this.codec)||!!(this.pps.length&&this.sps.length&&this.codec)}},{key:"hasSample",value:function(){return!!this.samples.length}},{key:"isEncryption",get:function(){return this.isVideoEncryption}}]),e}(),de=function(){function e(){X(this,e),G(this,"id",2),G(this,"type",B),G(this,"codecType",q),G(this,"pid",-1),G(this,"codec",""),G(this,"sequenceNumber",0),G(this,"sampleDuration",0),G(this,"timescale",0),G(this,"formatTimescale",0),G(this,"baseMediaDecodeTime",0),G(this,"duration",0),G(this,"warnings",[]),G(this,"samples",[]),G(this,"baseDts",0),G(this,"sampleSize",16),G(this,"sampleRate",0),G(this,"channelCount",0),G(this,"objectType",0),G(this,"sampleRateIndex",0),G(this,"config",[]),G(this,"present",!1),G(this,"isVideoEncryption",!1),G(this,"isAudioEncryption",!1),G(this,"kid",null),G(this,"ext",void 0)}return W(e,[{key:"reset",value:function(){this.sequenceNumber=0,this.timescale=0,this.sampleDuration=0,this.sampleRate=0,this.channelCount=0,this.baseMediaDecodeTime=0,this.present=!1,this.pid=-1,this.codec="",this.samples=[],this.config=[],this.warnings=[]}},{key:"exist",value:function(){return!(!(this.sampleRate&&this.channelCount&&this.codec)||this.codecType!==q&&this.codecType!==$&&this.codecType!==ee&&this.codecType!==te)}},{key:"hasSample",value:function(){return!!this.samples.length}},{key:"isEncryption",get:function(){return this.isAudioEncryption}},{key:"firstDts",get:function(){return this.samples.length?this.samples[0].dts:null}},{key:"firstPts",get:function(){return this.samples.length?this.samples[0].pts:null}},{key:"samplesDuration",get:function(){if(this.samples.length>0){var e=this.samples[0],t=this.samples[this.samples.length-1];return t.dts-e.dts+t.duration}return 0}}]),e}(),ce=function(){function e(t,i,n){X(this,e),G(this,"flag",{}),G(this,"keyframe",!1),G(this,"gopId",0),G(this,"duration",0),G(this,"size",0),G(this,"units",[]),G(this,"chromaFormat",420),this.originPts=this.pts=t,this.originDts=this.dts=i,n&&(this.units=n)}return W(e,[{key:"cts",get:function(){return this.pts-this.dts}},{key:"setToKeyframe",value:function(){this.keyframe=!0,this.flag.dependsOn=2,this.flag.isNonSyncSample=0}}]),e}(),ue=W((function e(t,i,n,s){X(this,e),G(this,"duration",1024),G(this,"flag",{dependsOn:2,isNonSyncSample:0}),G(this,"keyframe",!0),this.originPts=this.pts=this.dts=t,this.data=i,this.size=i.byteLength,this.sampleOffset=s,n&&(this.duration=n)})),me=W((function e(t,i){X(this,e),G(this,"time",0),this.data=t,this.originPts=this.pts=i})),he=function(e){v(i,e);var t=w(i);function i(){return X(this,i),t.apply(this,arguments)}return W(i)}(me),pe=function(e){v(i,e);var t=w(i);function i(){return X(this,i),t.apply(this,arguments)}return W(i)}(me),Ze=function(){function e(){X(this,e),G(this,"id",3),G(this,"type",_),G(this,"timescale",0),G(this,"flvScriptSamples",[]),G(this,"seiSamples",[])}return W(e,[{key:"exist",value:function(){return!(!this.flvScriptSamples.length&&!this.seiSamples.length||!this.timescale)}},{key:"reset",value:function(){this.timescale=0,this.flvScriptSamples=[],this.seiSamples=[]}},{key:"hasSample",value:function(){return!(!this.flvScriptSamples.length&&!this.seiSamples.length)}}]),e}(),ye=function(){function e(t){if(X(this,e),G(this,"_bytesAvailable",void 0),G(this,"_bitsAvailable",0),G(this,"_word",0),!t)throw new Error("ExpGolomb data params is required");this._data=t,this._bytesAvailable=t.byteLength,this._bytesAvailable&&this._loadWord()}return W(e,[{key:"bitsAvailable",get:function(){return this._bitsAvailable}},{key:"_loadWord",value:function(){var e=this._data.byteLength-this._bytesAvailable,t=Math.min(4,this._bytesAvailable);if(0===t)throw new Error("No bytes available");var i=new Uint8Array(4);i.set(this._data.subarray(e,e+t)),this._word=new DataView(i.buffer).getUint32(0),this._bitsAvailable=8*t,this._bytesAvailable-=t}},{key:"skipBits",value:function(e){if(this._bitsAvailable>e)this._word<<=e,this._bitsAvailable-=e;else{e-=this._bitsAvailable;var t=Math.floor(e/8);e-=8*t,this._bytesAvailable-=t,this._loadWord(),this._word<<=e,this._bitsAvailable-=e}}},{key:"readBits",value:function(e){if(e>32)throw new Error("Cannot read more than 32 bits");var t=Math.min(this._bitsAvailable,e),i=this._word>>>32-t;return this._bitsAvailable-=t,this._bitsAvailable>0?this._word<<=t:this._bytesAvailable>0&&this._loadWord(),(t=e-t)>0&&this._bitsAvailable?i<<t|this.readBits(t):i}},{key:"skipLZ",value:function(){var e;for(e=0;e<this._bitsAvailable;++e)if(0!=(this._word&2147483648>>>e))return this._word<<=e,this._bitsAvailable-=e,e;return this._loadWord(),e+this.skipLZ()}},{key:"skipUEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"readUEG",value:function(){var e=this.skipLZ();return this.readBits(e+1)-1}},{key:"readEG",value:function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}},{key:"readBool",value:function(){return 1===this.readBits(1)}},{key:"readUByte",value:function(){return this.readBits(8)}},{key:"skipScalingList",value:function(e){for(var t=8,i=8,n=0;n<e;n++)0!==i&&(i=(t+this.readEG()+256)%256),t=0===i?t:i}}]),e}(),be=function(){function e(t){X(this,e),this.name=t||"",this._prefix="[".concat(this.name,"]")}return W(e,[{key:"warn",value:function(){var t;if(!e.disabled){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];(t=console).warn.apply(t,[this._prefix].concat(n))}}}],[{key:"enable",value:function(){e.disabled=!1}},{key:"disable",value:function(){e.disabled=!0}}]),e}();G(be,"disabled",!0);var fe=function(){function e(){X(this,e)}return W(e,null,[{key:"decode",value:function(t){for(var i=[],n=t,s=0,a=t.length;s<a;)if(n[s]<128)i.push(String.fromCharCode(n[s])),++s;else{if(n[s]<192);else if(n[s]<224){if(e._checkContinuation(n,s,1)){var r=(31&n[s])<<6|63&n[s+1];if(r>=128){i.push(String.fromCharCode(65535&r)),s+=2;continue}}}else if(n[s]<240){if(e._checkContinuation(n,s,2)){var l=(15&n[s])<<12|(63&n[s+1])<<6|63&n[s+2];if(l>=2048&&55296!=(63488&l)){i.push(String.fromCharCode(65535&l)),s+=3;continue}}}else if(n[s]<248&&e._checkContinuation(n,s,3)){var o=(7&n[s])<<18|(63&n[s+1])<<12|(63&n[s+2])<<6|63&n[s+3];if(o>65536&&o<1114112){o-=65536,i.push(String.fromCharCode(o>>>10|55296)),i.push(String.fromCharCode(1023&o|56320)),s+=4;continue}}i.push(String.fromCharCode(65533)),++s}return i.join("")}},{key:"_checkContinuation",value:function(e,t,i){var n=e;if(t+i<n.length){for(;i--;)if(128!=(192&n[++t]))return!1;return!0}return!1}}]),e}(),Xe="undefined"!=typeof window,Le=Xe&&navigator.userAgent.toLocaleLowerCase(),We=Xe&&/^((?!chrome|android).)*safari/.test(Le),Ge=Xe&&Le.includes("firefox"),ve=Xe&&Le.includes("android");function xe(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];t=t.filter(Boolean);var n=new Uint8Array(t.reduce((function(e,t){return e+t.byteLength}),0)),s=0;return t.forEach((function(e){n.set(e,s),s+=e.byteLength})),n}var Se=Math.pow(2,32);function ge(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(e[t]<<8)+(e[t+1]||0)}function Ve(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(e[t]<<24>>>0)+(e[t+1]<<16)+(e[t+2]<<8)+(e[t+3]||0)}function Ye(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Ve(e,t)*Se+Ve(e,t+4)}function ke(e){for(var t,i="avc1.",n=0;n<3;n++)(t=e[n].toString(16)).length<2&&(t="0".concat(t)),i+=t;return i}function Re(e){var t="";if(e.forEach((function(e){t+=function(e){return("0"+Number(e).toString(16)).slice(-2).toUpperCase()}(e)})),t.length<=32)for(var i=32-t.length,n=0;n<i;n++)t+="0";return t}function Te(e){if(!Array.isArray(e)){for(var t=[],i="",n=0;n<e.length;n++)n%2&&(i=e[n-1]+e[n],t.push(parseInt(i,16)),i="");return t}return e.map((function(e){return parseInt(e,16)}))}function we(e,t){return Number(e+"."+t)}var Me=function(){function e(){X(this,e)}return W(e,null,[{key:"getRateIndexByRate",value:function(t){return e.FREQ.indexOf(t)}},{key:"parseADTS",value:function(t,i){for(var n=t.length,s=0;s+2<n&&(255!==t[s]||240!=(246&t[s+1]));)s++;if(!(s>=n)){var a=s,r=[],l=(60&t[s+2])>>>2,o=e.FREQ[l];if(!o)throw new Error("Invalid sampling index: ".concat(l));for(var d,c,u=1+((192&t[s+2])>>>6),m=(1&t[s+2])<<2|(192&t[s+3])>>>6,h=e._getConfig(l,m,u),p=h.config,Z=h.codec,y=0,b=e.getFrameDuration(o);s+7<n;)if(255===t[s]&&240==(246&t[s+1])){if(!(c=(3&t[s+3])<<11|t[s+4]<<3|(224&t[s+5])>>5)||n-s<c)break;d=2*(1&~t[s+1]),r.push({pts:i+y*b,data:t.subarray(s+7+d,s+c)}),y++,s+=c}else s++;return{skip:a,remaining:s>=n?void 0:t.subarray(s),frames:r,samplingFrequencyIndex:l,sampleRate:o,objectType:u,channelCount:m,codec:Z,config:p,originCodec:"mp4a.40.".concat(u)}}}},{key:"parseAudioSpecificConfig",value:function(t){if(t.length){var i=t[0]>>>3,n=(7&t[0])<<1|t[1]>>>7,s=(120&t[1])>>>3,a=e.FREQ[n];if(a){var r=e._getConfig(n,s,i);return{samplingFrequencyIndex:n,sampleRate:a,objectType:i,channelCount:s,config:r.config,codec:r.codec,originCodec:"mp4a.40.".concat(i)}}}}},{key:"getFrameDuration",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:9e4;return 1024*t/e}},{key:"_getConfig",value:function(e,t,i){var n,s,a=[];return Ge?e>=6?(n=5,s=e-3):(n=2,s=e):ve?(n=2,s=e):(n=2===i||5===i?i:5,s=e,e>=6?s=e-3:1===t&&(n=2,s=e)),a[0]=n<<3,a[0]|=(14&e)>>1,a[1]=(1&e)<<7,a[1]|=t<<3,5===n&&(a[1]|=(14&s)>>1,a[2]=(1&s)<<7,a[2]|=8,a[3]=0),{config:a,codec:"mp4a.40.".concat(n)}}},{key:"getSilentFrame",value:function(e,t){if("mp4a.40.2"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}}}]),e}();G(Me,"FREQ",[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350]);var Ke=function(){function e(){X(this,e)}return W(e,null,[{key:"parseAnnexB",value:function(e){for(var t=e.length,i=2,n=0;null!==e[i]&&void 0!==e[i]&&1!==e[i];)i++;if((n=++i+2)>=t)return[];for(var s=[];n<t;)switch(e[n]){case 0:if(0!==e[n-1]){n+=2;break}if(0!==e[n-2]){n++;break}i!==n-2&&s.push(e.subarray(i,n-2));do{n++}while(1!==e[n]&&n<t);n=(i=n+1)+2;break;case 1:if(0!==e[n-1]||0!==e[n-2]){n+=3;break}i!==n-2&&s.push(e.subarray(i,n-2)),n=(i=n+1)+2;break;default:n+=3}return i<t&&s.push(e.subarray(i)),s}},{key:"parseAvcC",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;if(!(e.length<4)){for(var i,n=e.length,s=[],a=0;a+t<n;)if(i=Ve(e,a),3===t&&(i>>>=8),a+=t,i){if(a+i>n)break;s.push(e.subarray(a,a+i)),a+=i}return s}}},{key:"parseSEI",value:function(e,t){for(var i=e.length,n=t?2:1,s=0,a=0,r="";255===e[n];)s+=255,n++;for(s+=e[n++];255===e[n];)a+=255,n++;if(a+=e[n++],5===s&&i>n+16)for(var l=0;l<16;l++)r+=e[n].toString(16),n++;return{payload:e.subarray(n,n+a),type:s,size:a,uuid:r}}},{key:"removeEPB",value:function(e){for(var t=e.byteLength,i=[],n=1;n<t-2;)0===e[n]&&0===e[n+1]&&3===e[n+2]?(i.push(n+2),n+=2):n++;if(!i.length)return e;var s=t-i.length,a=new Uint8Array(s),r=0;for(n=0;n<s;r++,n++)r===i[0]&&(r++,i.shift()),a[n]=e[r];return a}}]),e}(),Ie=function(){function e(){X(this,e)}return W(e,null,[{key:"parseAVCDecoderConfigurationRecord",value:function(t){if(!(t.length<7)){for(var i,n,s=1+(3&t[4]),a=[],r=[],l=6,o=31&t[5],d=0;d<o;d++)if(n=t[l]<<8|t[l+1],l+=2,n){var c=t.subarray(l,l+n);l+=n,a.push(c),i||(i=e.parseSPS(Ke.removeEPB(c)))}var u,m=t[l];l++;for(var h=0;h<m;h++)u=t[l]<<8|t[l+1],l+=2,u&&(r.push(t.subarray(l,l+u)),l+=u);return{sps:i,spsArr:a,ppsArr:r,nalUnitSize:s}}}},{key:"parseSPS",value:function(e){var t=new ye(e);t.readUByte();var i=t.readUByte(),n=t.readUByte(),s=t.readUByte();t.skipUEG();var a=420;if(100===i||110===i||122===i||244===i||44===i||83===i||86===i||118===i||128===i||138===i||144===i){var r=t.readUEG();if(r<=3&&(a=[0,420,422,444][r]),3===r&&t.skipBits(1),t.skipUEG(),t.skipUEG(),t.skipBits(1),t.readBool())for(var l=3!==r?8:12,o=0;o<l;o++)t.readBool()&&(o<6?t.skipScalingList(16):t.skipScalingList(64))}t.skipUEG();var d=t.readUEG();if(0===d)t.readUEG();else if(1===d){t.skipBits(1),t.skipUEG(),t.skipUEG();for(var c=t.readUEG(),u=0;u<c;u++)t.skipUEG()}t.skipUEG(),t.skipBits(1);var m=t.readUEG(),h=t.readUEG(),p=t.readBits(1);0===p&&t.skipBits(1),t.skipBits(1);var Z,y,b,f,X,L=0,W=0,G=0,v=0;if(t.readBool()&&(L=t.readUEG(),W=t.readUEG(),G=t.readUEG(),v=t.readUEG()),t.readBool()){if(t.readBool())switch(t.readUByte()){case 1:Z=[1,1];break;case 2:Z=[12,11];break;case 3:Z=[10,11];break;case 4:Z=[16,11];break;case 5:Z=[40,33];break;case 6:Z=[24,11];break;case 7:Z=[20,11];break;case 8:Z=[32,11];break;case 9:Z=[80,33];break;case 10:Z=[18,11];break;case 11:Z=[15,11];break;case 12:Z=[64,33];break;case 13:Z=[160,99];break;case 14:Z=[4,3];break;case 15:Z=[3,2];break;case 16:Z=[2,1];break;case 255:Z=[t.readUByte()<<8|t.readUByte(),t.readUByte()<<8|t.readUByte()]}if(t.readBool()&&t.readBool(),t.readBool()&&(t.readBits(4),t.readBool()&&t.readBits(24)),t.readBool()&&(t.readUEG(),t.readUEG()),t.readBool()){var x=t.readBits(32),S=t.readBits(32);y=t.readBool(),X=(b=S)/(f=2*x)}}return{codec:ke(e.subarray(1,4)),profileIdc:i,profileCompatibility:n,levelIdc:s,chromaFormat:a,width:Math.ceil(16*(m+1)-2*(L+W)),height:(2-p)*(h+1)*16-(p?2:4)*(G+v),sarRatio:Z,fpsNum:b,fpsDen:f,fps:X,fixedFrame:y}}}]),e}(),He=function(){function e(){X(this,e)}return W(e,null,[{key:"parseHEVCDecoderConfigurationRecord",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(t.length<23)){i=i||{};for(var n,s,a,r,l,o=1+(3&t[21]),d=[],c=[],u=[],m=23,h=t[22],p=0;p<h;p++){a=63&t[m],r=t[m+1]<<8|t[m+2],m+=3;for(var Z=0;Z<r;Z++)if(l=t[m]<<8|t[m+1],m+=2,l){switch(a){case 32:var y=t.subarray(m,m+l);n||(n=e.parseVPS(Ke.removeEPB(y),i)),u.push(y);break;case 33:var b=t.subarray(m,m+l);s||(s=e.parseSPS(Ke.removeEPB(b),i)),d.push(b);break;case 34:c.push(t.subarray(m,m+l))}m+=l}}return{hvcC:i,sps:s,spsArr:d,ppsArr:c,vpsArr:u,nalUnitSize:o}}}},{key:"parseVPS",value:function(t,i){i=i||{};var n=new ye(t);n.readUByte(),n.readUByte(),n.readBits(12);var s=n.readBits(3);return i.numTemporalLayers=Math.max(i.numTemporalLayers||0,s+1),n.readBits(17),e._parseProfileTierLevel(n,s,i),i}},{key:"parseSPS",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i=i||{};var n=new ye(t);n.readUByte(),n.readUByte(),n.readBits(4);var s=n.readBits(3);i.numTemporalLayers=Math.max(s+1,i.numTemporalLayers||0),i.temporalIdNested=n.readBits(1),e._parseProfileTierLevel(n,s,i),n.readUEG();var a=i.chromaFormatIdc=n.readUEG(),r=420;a<=3&&(r=[0,420,422,444][a]);var l=0;3===a&&(l=n.readBits(1));var o,d,c,u,m=n.readUEG(),h=n.readUEG(),p=n.readBits(1);if(1===p&&(o=n.readUEG(),d=n.readUEG(),c=n.readUEG(),u=n.readUEG()),i.bitDepthLumaMinus8=n.readUEG(),i.bitDepthChromaMinus8=n.readUEG(),1===p){var Z=1!==a&&2!==a||0!==l?1:2,y=1===a&&0===l?2:1;m-=Z*(d+o),h-=y*(u+c)}return{codec:"hev1.1.6.L93.B0",width:m,height:h,chromaFormat:r,hvcC:i}}},{key:"_parseProfileTierLevel",value:function(e,t,i){var n=i.generalTierFlag||0;i.generalProfileSpace=e.readBits(2),i.generalTierFlag=Math.max(e.readBits(1),n),i.generalProfileIdc=Math.max(e.readBits(5),i.generalProfileIdc||0),i.generalProfileCompatibilityFlags=e.readBits(32),i.generalConstraintIndicatorFlags=[e.readBits(8),e.readBits(8),e.readBits(8),e.readBits(8),e.readBits(8),e.readBits(8)];var s=e.readBits(8);n<i.generalTierFlag?i.generalLevelIdc=s:i.generalLevelIdc=Math.max(s,i.generalLevelIdc||0);var a=[],r=[];if(t>e.bitsAvailable)throw new Error("maxSubLayersMinus inavlid size ".concat(t));for(var l=0;l<t;l++)a[l]=e.readBits(1),r[l]=e.readBits(1);t>0&&e.readBits(2*(8-t));for(var o=0;o<t;o++)0!==a[o]&&(e.readBits(2),e.readBits(1),e.readBits(5),e.readBits(16),e.readBits(16),e.readBits(4),e.readBits(16),e.readBits(16),e.readBits(12)),0!==r[o]&&e.readBits(8)}}]),e}(),Ce=function(){function e(){X(this,e)}return W(e,null,[{key:"getFrameDuration",value:function(e){return 20}},{key:"parseHeaderPackets",value:function(e){if(e.length){for(var t=new DataView(e.buffer,e.byteOffset,e.byteLength),i="",n=0;n<8;n++)i+=String.fromCodePoint(e[n]);if("OpusHead"!==i)throw new Error("Invalid Opus MagicSignature");var s=e[9];console.log("Pre-skip",e[10],e[11]);var a=t.getUint32(12,!0),r=t.getInt16(16,!0);if(a){return{outputGain:r,sampleRate:a,channelCount:s,config:new Uint8Array(e.buffer,e.byteOffset+8,e.byteLength-8),codec:"opus",originCodec:"opus"}}}}}]),e}(),Ne=1e3,Fe=5e3,ze=function(){function e(t,i,n){X(this,e),this.videoTrack=t,this.audioTrack=i,this.metadataTrack=n,this._baseDts=-1,this._baseDtsInited=!1,this._audioNextPts=void 0,this._videoNextDts=void 0,this._audioTimestampBreak=0,this._videoTimestampBreak=0,this._lastVideoDuration=0,this._keyFrameInNextChunk=!1,this._lastAudioExceptionGapDot=-1/0,this._lastAudioExceptionOverlapDot=-1/0,this._lastAudioExceptionLargeGapDot=-1/0,this._lastVideoExceptionLargeGapDot=-1/0,this._lastVideoExceptionChunkFirstDtsDot=-1/0}return W(e,[{key:"fix",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];t=Math.round(1e3*t);var s=this.videoTrack,a=this.audioTrack;!i&&n||(this._videoLastSample=null,this._audioNextPts=void 0,this._videoNextDts=void 0,this._audioTimestampBreak=0,this._videoTimestampBreak=0,this._lastAudioExceptionGapDot=-1/0,this._lastAudioExceptionOverlapDot=-1/0,this._lastAudioExceptionLargeGapDot=-1/0,this._lastVideoExceptionLargeGapDot=-1/0,this._lastVideoExceptionChunkFirstDtsDot=-1/0),i&&!n&&(this._baseDtsInited=!1),this._baseDtsInited||this._calculateBaseDts(a,s),!n&&t&&(this._audioNextPts=this._videoNextDts=t);var r=this._baseDtsInited&&(this._videoTimestampBreak||!this.videoTrack.exist())&&(this._audioTimestampBreak||!this.audioTrack.exist());if(r&&this._resetBaseDtsWhenStreamBreaked(),this._fixAudio(a),this._keyFrameInNextChunk=!1,this._fixVideo(s),this.metadataTrack.exist()){var l=this.metadataTrack.timescale;this.metadataTrack.seiSamples.forEach((function(t){t.pts=t.originPts-e._baseDts,t.time=Math.max(0,t.pts)/l})),this.metadataTrack.flvScriptSamples.forEach((function(t){t.pts=t.originPts-e._baseDts,t.time=Math.max(0,t.pts)/l}))}s.samples.length&&(s.baseMediaDecodeTime=s.samples[0].dts),a.samples.length&&(a.baseMediaDecodeTime=a.samples[0].pts*a.timescale/1e3)}},{key:"_fixVideo",value:function(e){var t=this,i=e.samples;if(i.length){var n;if(i.forEach((function(e){e.dts-=t._baseDts,e.pts-=t._baseDts,e.keyframe&&(t._keyFrameInNextChunk=!0)})),e.fpsNum&&e.fpsDen)n=e.timescale*(e.fpsDen/e.fpsNum);else if(e.length>1){var s=e.samples[0],a=e.samples[i.length-1];n=Math.floor((a.dts-s.dts)/(i.length-1))}else n=this._lastVideoDuration||40;var r=i.pop();if(this._videoLastSample&&i.unshift(this._videoLastSample),this._videoLastSample=r,i.length){if(void 0===this._videoNextDts){var l=i[0];this._videoNextDts=l.dts}var o=i.length,d=0,c=i[0],u=this._videoNextDts-c.dts;if(Math.abs(u)>200){var m;if(Math.abs(c.dts-this._lastVideoExceptionChunkFirstDtsDot)>5e3)this._lastVideoExceptionChunkFirstDtsDot=c.dts,e.warnings.push({type:se,nextDts:this._videoNextDts,firstSampleDts:c.dts,nextSampleDts:null===(m=i[1])||void 0===m?void 0:m.dts,sampleDuration:u});this._videoTimestampBreak>=5?(this._videoNextDts=c.dts,this._videoTimestampBreak=0):(c.dts+=u,c.pts+=u,this.audioTrack.exist()||(this._videoTimestampBreak=1))}for(var h=0;h<o;h++){var p=i[h].dts,Z=i[h+1];((d=h<o-1?Z.dts-p:r?r.dts-p:n)>1e3||d<0)&&(this._videoTimestampBreak++,Math.abs(p-this._lastVideoExceptionLargeGapDot)>5e3&&(this._lastVideoExceptionLargeGapDot=p,e.warnings.push({type:ne,time:p/e.timescale,dts:p,originDts:i[h].originDts,nextDts:this._videoNextDts,sampleDuration:d,refSampleDuration:n})),d=n),i[h].duration=d,this._videoNextDts+=d,this._lastVideoDuration=d}}}}},{key:"_fixAudio",value:function(e){var t=this,i=e.samples;i.length&&(i.forEach((function(e){e.dts=e.pts-=t._baseDts})),this._doFixAudioInternal(e,i,1e3))}},{key:"_calculateBaseDts",value:function(e,t){var i=e.samples,n=t.samples;if(!i.length&&!n.length)return!1;var s=1/0,a=1/0;i.length&&(e.baseDts=s=i[0].pts),n.length&&(t.baseDts=a=n[0].dts),this._baseDts=Math.min(s,a);var r=a-s;return Number.isFinite(r)&&Math.abs(r)>500&&t.warnings.push({type:ie,videoBaseDts:a,audioBasePts:s,baseDts:this._baseDts,delta:r}),this._baseDtsInited=!0,!0}},{key:"_resetBaseDtsWhenStreamBreaked",value:function(){this._calculateBaseDts(this.audioTrack,this.videoTrack)&&(this.audioTrack.exist()?this.videoTrack.exist()?this._baseDts-=Math.min(this._audioNextPts,this._videoNextDts):this._baseDts-=this._audioNextPts:this._baseDts-=this._videoNextDts,this._videoTimestampBreak=0,this._audioTimestampBreak=0)}},{key:"_doFixAudioInternal",value:function(e,t,i){if(!e.sampleDuration)switch(e.codecType){case q:e.sampleDuration=Me.getFrameDuration(e.timescale,i);break;case te:e.sampleDuration=Ce.getFrameDuration(e.samples,i);break;case $:case ee:e.sampleDuration=this._getG711Duration(e);break;default:console.error("can't fix audio codecType:",e.codecType)}var n=e.sampleDuration,s=e.codecType===te?20:e.codecType===q?1024:n*e.timescale/1e3;if(void 0===this._audioNextPts){var a=t[0];this._audioNextPts=a.pts}for(var r=0;r<t.length;r++){var l=this._audioNextPts,o=t[r],d=o.pts-l;if(0===r&&this._audioTimestampBreak>=5&&this._keyFrameInNextChunk&&(l=this._audioNextPts=o.dts,d=0,this._audioTimestampBreak=0),!this._audioTimestampBreak&&d>=3*n&&d<=Ne&&!We){var c=this._getSilentFrame(e)||t[0].data.subarray(),u=Math.floor(d/n);Math.abs(o.pts-this._lastAudioExceptionGapDot)>Fe&&(this._lastAudioExceptionGapDot=o.pts,e.warnings.push({type:re,pts:o.pts,originPts:o.originPts,count:u,nextPts:l,refSampleDuration:n}));for(var m=0;m<u;m++){var h=new ue(Math.floor(this._audioNextPts+n)-Math.floor(this._audioNextPts),c,s);h.originPts=Math.floor(this._baseDts+l),t.splice(r,0,h),this._audioNextPts+=n,r++}r--}else if(d<=-3*n&&d>=-1e3)Math.abs(o.pts-this._lastAudioExceptionOverlapDot)>Fe&&(this._lastAudioExceptionOverlapDot=o.pts,e.warnings.push({type:le,pts:o.pts,originPts:o.originPts,nextPts:l,refSampleDuration:n})),t.splice(r,1),r--;else{if(Math.abs(d)>Ne&&(this._audioTimestampBreak++,Math.abs(o.pts-this._lastAudioExceptionLargeGapDot)>Fe&&(this._lastAudioExceptionLargeGapDot=o.pts,e.warnings.push({type:ae,time:o.pts/1e3,pts:o.pts,originPts:o.originPts,nextPts:l,sampleDuration:d,refSampleDuration:n}))),e.codecType===te){var p=t[t.length-1];p&&(p.duration=o.pts-p.pts)}else o.dts=o.pts=l,o.duration=s;this._audioNextPts+=n}}}},{key:"_getG711Duration",value:function(e){var t=e.sampleSize,i=e.channelCount,n=e.sampleRate,s=e.samples[0];if(s)return 2*s.data.byteLength/i/(t/8)/n*1e3}},{key:"_getSilentFrame",value:function(e){return e.codecType===q?Me.getSilentFrame(e.codec,e.channelCount):new Uint8Array(8*e.sampleDuration*e.channelCount)}}]),e}(),Ue=function(){function e(){X(this,e)}return W(e,null,[{key:"parse",value:function(t){if(!(t.length<3)){var i={},n=e._parseValue(new DataView(t.buffer,t.byteOffset,t.byteLength)),s=e._parseValue(new DataView(t.buffer,t.byteOffset+n.size,t.byteLength-n.size));return i[n.data]=s.data,i}}},{key:"_parseValue",value:function(t){var i,n=t.byteLength,s=1,a=!1;switch(t.getUint8(0)){case 0:i=t.getFloat64(1),s+=8;break;case 1:i=!!t.getUint8(1),s+=1;break;case 2:var r=e._parseString(new DataView(t.buffer,t.byteOffset+s,t.byteLength-s));i=r.data,s+=r.size;break;case 3:i={};var l=0;for(9==(16777215&t.getUint32(n-4))&&(l=3);s<n-4;){var o=e._parseObject(new DataView(t.buffer,t.byteOffset+s,t.byteLength-s-l)),d=o.size,c=o.data;if(o.isEnd)break;i[c.name]=c.value,s+=d}if(s<=n-3)9===(16777215&t.getUint32(s-1))&&(s+=3);break;case 8:i={},s+=4;var u=0;for(9==(16777215&t.getUint32(n-4))&&(u=3);s<n-8;){var m=e._parseObject(new DataView(t.buffer,t.byteOffset+s,t.byteLength-s-u)),h=m.size,p=m.data;if(m.isEnd)break;i[p.name]=p.value,s+=h}if(s<=n-3)9===(16777215&t.getUint32(s-1))&&(s+=3);break;case 9:i=void 0,s=1,a=!0;break;case 10:i=[];var Z=t.getUint32(1);s+=4;for(var y=0;y<Z;y++){var b=e._parseValue(new DataView(t.buffer,t.byteOffset+s,t.byteLength-s)),f=b.data,X=b.size;i.push(f),s+=X}break;case 11:var L=t.getFloat64(s)+6e4*t.getInt16(s+8);i=new Date(L),s+=10;break;case 12:var W=t.getUint32(1);s+=4,i="",W>0&&(i=fe.decode(new Uint8Array(t.buffer,t.byteOffset+s,W))),s+=W;break;default:s=n}return{data:i,size:s,isEnd:a}}},{key:"_parseString",value:function(e){var t=e.getUint16(0),i="";return t>0&&(i=fe.decode(new Uint8Array(e.buffer,e.byteOffset+2,t))),{data:i,size:2+t}}},{key:"_parseObject",value:function(t){if(!(t.byteLength<3)){var i=e._parseString(t),n=e._parseValue(new DataView(t.buffer,t.byteOffset+i.size,t.byteLength-i.size));return{data:{name:i.data,value:n.data},size:i.size+n.size,isEnd:n.isEnd}}}}]),e}(),Je=7,je=8,Pe=10,Ee=13,De=new be("FlvDemuxer"),Be=function(){function e(t,i,n){X(this,e),G(this,"_headerParsed",!1),G(this,"_remainingData",null),G(this,"_gopId",0),G(this,"_needAddMetaBeforeKeyFrameNal",!0),this.videoTrack=t||new oe,this.audioTrack=i||new de,this.metadataTrack=n||new Ze,this._fixer=new ze(this.videoTrack,this.audioTrack,this.metadataTrack)}return W(e,[{key:"demux",value:function(t){var i,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=arguments.length>3?arguments[3]:void 0,r=this.audioTrack,l=this.videoTrack,o=this.metadataTrack;if(!n&&s||(this._remainingData=null),n&&(this._headerParsed=!1),n?(l.reset(),r.reset(),o.reset()):(l.samples=[],r.samples=[],o.seiSamples=[],o.flvScriptSamples=[],l.warnings=[],r.warnings=[],this._remainingData&&(t=xe(this._remainingData,t),this._remainingData=null)),!t.length)return{videoTrack:l,audioTrack:r,metadataTrack:o};var d=0;if(!this._headerParsed){if(!e.probe(t))throw new Error("Invalid flv file");r.present=(4&t[4])>>>2!=0,l.present=0!=(1&t[4]),this._headerParsed=!0,d=Ve(t,5)+4}for(var c,u,m,h,p,Z=t.length;d+15<Z&&(c=t[d],!(d+15+(u=t[d+1]<<16|t[d+2]<<8|t[d+3])>Z));)m=(t[d+7]<<24>>>0)+(t[d+4]<<16)+(t[d+5]<<8)+t[d+6],d+=11,h=t.subarray(d,d+u),8===c?this._parseAudio(h,m):9===c?(a&&(this.seamlessLoadingSwitching=!0),this._parseVideo(h,m)):18===c?this._parseScript(h,m):De.warn("Invalid tag type: ".concat(c)),(p=Ve(t,d+=u))!==11+u&&De.warn("Invalid PrevTagSize ".concat(p," (").concat(11+u,")")),d+=4;d<Z&&(this._remainingData=t.subarray(d)),r.formatTimescale=l.formatTimescale=l.timescale=o.timescale=1e3,r.timescale=r.codecType===te?1e3:r.sampleRate||0,!r.exist()&&r.hasSample()&&r.reset(),!l.exist()&&l.hasSample()&&l.reset();var y=o.flvScriptSamples[o.flvScriptSamples.length-1],b=null==y||null===(i=y.data)||void 0===i?void 0:i.onMetaData;return b&&(null!=l&&l.exist()&&(b.hasOwnProperty("duration")&&(l.duration=1e3*b.duration),b.hasOwnProperty("width")&&b.hasOwnProperty("height")&&(l.width=b.width,l.height=b.height)),null!=r&&r.exist()&&b.hasOwnProperty("duration")&&(r.duration=1e3*b.duration)),{videoTrack:l,audioTrack:r,metadataTrack:o}}},{key:"fix",value:function(e,t,i){return this._fixer.fix(e,t,i),{videoTrack:this.videoTrack,audioTrack:this.audioTrack,metadataTrack:this.metadataTrack}}},{key:"demuxAndFix",value:function(e,t,i,n,s){return this.demux(e,t,i,s),this.fix(n,t,i)}},{key:"_parseAudio",value:function(t,i){if(t.length){var n=(240&t[0])>>>4,s=this.audioTrack;if(n!==Pe&&n!==Je&&n!==je&&n!==Ee)return De.warn("Unsupported sound format: ".concat(n)),void s.reset();if(n!==Pe&&n!==Ee){var a=(12&t[0])>>2,r=(2&t[0])>>1,l=1&t[0];s.sampleRate=e.AUDIO_RATE[a],s.sampleSize=r?16:8,s.channelCount=l+1}switch(n){case Je:case je:this._parseG711(t,i,n);break;case Pe:this._parseAac(t,i);break;case Ee:this._parseOpus(t,i)}}}},{key:"_parseOpus",value:function(e,t){var i=this.audioTrack,n=e[1];switch(i.codecType=te,n){case 0:var s=Ce.parseHeaderPackets(e.subarray(2));s?(i.codec=s.codec,i.channelCount=s.channelCount,i.sampleRate=s.sampleRate,i.config=s.config,i.sampleDuration=Ce.getFrameDuration([],i.timescale)):(i.reset(),De.warn("Cannot parse AudioSpecificConfig",e));break;case 1:if(null==t)return;var a=new ue(t,e.subarray(2),i.sampleDuration);i.samples.push(a);break;default:De.warn("Unknown OpusPacketType: ".concat(n))}}},{key:"_parseG711",value:function(e,t,i){var n=this.audioTrack;n.codecType=7===i?$:ee,n.sampleRate=8e3,n.codec=n.codecType,n.samples.push(new ue(t,e.subarray(1)))}},{key:"_parseAac",value:function(e,t){var i=this.audioTrack;if(i.codecType=q,0===e[1]){var n=Me.parseAudioSpecificConfig(e.subarray(2));n?(i.codec=n.codec,i.channelCount=n.channelCount,i.sampleRate=n.sampleRate,i.config=n.config,i.objectType=n.objectType,i.sampleRateIndex=n.samplingFrequencyIndex):(i.reset(),De.warn("Cannot parse AudioSpecificConfig",e))}else if(1===e[1]){if(null==t)return;i.samples.push(new ue(t,e.subarray(2)))}else De.warn("Unknown AACPacketType: ".concat(e[1]))}},{key:"_parseVideo",value:function(e,t){var i=this;if(!(e.length<6)){var n=(240&e[0])>>>4,s=15&e[0],a=this.videoTrack;if(7!==s&&12!==s)return a.reset(),void De.warn("Unsupported codecId: ".concat(s));var r=12===s;a.codecType=r?A:O;var l=e[1],o=(e[2]<<16|e[3]<<8|e[4])<<8>>8;if(0===l){var d=e.subarray(5),c=r?He.parseHEVCDecoderConfigurationRecord(d):Ie.parseAVCDecoderConfigurationRecord(d);if(c){var u=c.hvcC,m=c.sps,h=c.ppsArr,p=c.spsArr,Z=c.vpsArr,y=c.nalUnitSize;u&&(a.hvcC=a.hvcC||u),m&&(a.codec=m.codec,a.width=m.width,a.height=m.height,a.sarRatio=m.sarRatio,a.fpsNum=m.fpsNum,a.fpsDen=m.fpsDen),p.length&&(a.sps=p),h.length&&(a.pps=h),Z&&Z.length&&(a.vps=Z),y&&(a.nalUnitSize=y)}else De.warn("Cannot parse ".concat(r?"HEVC":"AVC","DecoderConfigurationRecord"),e)}else if(1===l){var b=Ke.parseAvcC(e.subarray(5),a.nalUnitSize);if((b=this._checkAddMetaNalToUnits(r,b,a))&&b.length){var f=new ce(t+o,t,b);if(this.seamlessLoadingSwitching&&t<a.lastKeyFrameDts)return;this.seamlessLoadingSwitching=!1,1===n&&(f.setToKeyframe(),a.lastKeyFrameDts=t),a.samples.push(f),b.forEach((function(e){var n=r?e[0]>>>1&63:31&e[0];switch(n){case 5:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 23:if(!r&&5!==n||r&&5===n)break;f.setToKeyframe();break;case 6:case 39:case 40:if(!r&&6!==n||r&&6===n)break;i.metadataTrack.seiSamples.push(new pe(Ke.parseSEI(Ke.removeEPB(e),r),t+o))}})),f.keyframe&&this._gopId++,f.gopId=this._gopId}else De.warn("Cannot parse NALUs",e)}else 2===l||De.warn("Unknown AVCPacketType: ".concat(l))}}},{key:"_checkAddMetaNalToUnits",value:function(e,t,i){return e&&this._needAddMetaBeforeKeyFrameNal?t.map((function(e){return e[0]>>>1&63})).includes(32)?(this._needAddMetaBeforeKeyFrameNal=!1,t):(t.unshift(i.pps[0]),t.unshift(i.sps[0]),t.unshift(i.vps[0]),t.filter(Boolean)):(this._needAddMetaBeforeKeyFrameNal=!1,t)}},{key:"_parseScript",value:function(e,t){this.metadataTrack.flvScriptSamples.push(new he(Ue.parse(e),t))}}],[{key:"probe",value:function(e){return 70===e[0]&&76===e[1]&&86===e[2]&&1===e[3]&&Ve(e,5)>=9}}]),e}();G(Be,"AUDIO_RATE",[5500,11e3,22e3,44e3]),new be("TsDemuxer");var _e=function(){function e(t,i,n){X(this,e),this.dv=new DataView(t),this.start=this.offset=i||this.dv.byteOffset,this.end=n?this.start+n:this.start+this.dv.byteLength}return W(e,[{key:"buffer",get:function(){return this.dv.buffer}},{key:"unreadLength",get:function(){return Math.max(this.end-this.offset,0)}},{key:"size",get:function(){return this.end-this.start}},{key:"readFloat",value:function(e){var t=0;switch(e){case 4:t=this.dv.getFloat32(this.offset);break;case 8:t=this.dv.getFloat64(this.offset);break;default:throw new Error("read ".concat(e,"-byte float is not supported"))}return this.offset+=e,t}},{key:"back",value:function(e){this.offset-=e}},{key:"skip",value:function(e){this.offset+=e}},{key:"readInt",value:function(e){var t=this.offset;switch(this.offset+=e,e){case 1:return this.dv.getInt8(t);case 2:return this.dv.getInt16(t);case 4:return this.dv.getInt32(t);default:throw new Error("read ".concat(e,"-byte integers is not supported"))}}},{key:"read",value:function(e){var t=this.offset;switch(this.offset+=e,e){case 1:return this.dv.getUint8(t);case 2:return this.dv.getUint16(t);case 3:return(this.dv.getUint16(t)<<8)+this.dv.getUint8(t+2);case 4:return this.dv.getUint32(t);default:return this.back(e-4),this.read(e-4)+this.dv.getUint32(t)*Math.pow(256,e-4)}}},{key:"write",value:function(e,t){var i=this.offset;switch(this.offset+=e,e){case 1:return this.dv.setUint8(i,t);case 2:return this.dv.setUint16(i,t);case 3:return this.dv.setUint8(i,t>>>16),this.dv.setUint16(i+1,65535&t);case 4:return this.dv.setUint32(i,t);default:throw new Error("write ".concat(e,"-byte integers is not supported"))}}},{key:"readToBuffer",value:function(e){var t;return t=this.offset||e?this.dv.buffer.slice(this.offset,e?this.offset+e:this.end):this.dv.buffer,this.offset+=t.byteLength,t}},{key:"readToUint8",value:function(e){var t=new Uint8Array(this.dv.buffer,this.offset,e||this.unreadLength);return this.offset+=t.byteLength,t}},{key:"readString",value:function(e){for(var t=0,i="";t<e;t++)i+=String.fromCharCode(this.dv.getUint8(this.offset)),this.offset++;return i}}],[{key:"fromUint8",value:function(t){return new e(t.buffer,t.byteOffset,t.byteLength)}},{key:"concatUint8s",value:function(e){var t=new Uint8Array(e.reduce((function(e,t){return e+t.byteLength}),0)),i=0;return e.forEach((function(e){t.set(e,i),i+=e.byteLength})),t}},{key:"concatUint8",value:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return this.concatUint8s(t)}}]),e}(),Qe=function(){function e(t,i){X(this,e),this.offset=0,this.val=t,this.size=i}return W(e,[{key:"skip",value:function(e){this.offset+=e}},{key:"read",value:function(e){var t=this.size-this.offset-e;if(t>=0){var i=0,n=0;if(this.offset+=e,this.size>31){for(;n<e;n++)i+=Math.pow(2,n);return this.val/Math.pow(2,t)&i}for(;n<e;n++)i+=1<<n;return this.val>>>t&i}throw new Error("the number of the read operation exceeds the total length limit of bits")}}],[{key:"fromByte",value:function(t,i){return new e(t.read(i),i<<3)}}]),e}(),Oe=function(){function e(){X(this,e)}return W(e,null,[{key:"findBox",value:function(t,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=[];if(!t)return s;for(var a=0,r="",l=0;t.length>7;){if(a=Ve(t),r=String.fromCharCode.apply(null,t.subarray(4,8)),l=8,1===a?(a=Ye(t,8),l+=8):a||(a=t.length),!i[0]||r===i[0]){var o=t.subarray(0,a);if(!(i.length<2))return e.findBox(o.subarray(l),i.slice(1),n+l);s.push({start:n,size:a,headerSize:l,type:r,data:o})}n+=a,t=t.subarray(a)}return s}},{key:"tfhd",value:function(e){return et(e,!0,(function(e,t){e.trackId=Ve(t);var i=4,n=1&e.flags,s=2&e.flags,a=8&e.flags,r=16&e.flags,l=32&e.flags;n&&(i+=4,e.baseDataOffset=Ve(t,i),i+=4),s&&(e.sampleDescriptionIndex=Ve(t,i),i+=4),a&&(e.defaultSampleDuration=Ve(t,i),i+=4),r&&(e.defaultSampleSize=Ve(t,i),i+=4),l&&(e.defaultSampleFlags=Ve(t,i))}))}},{key:"sidx",value:function(e){return et(e,!0,(function(e,t){var i=0;e.reference_ID=Ve(t,i),i+=4,e.timescale=Ve(t,i),i+=4,0===e.version?(e.earliest_presentation_time=Ve(t,i),i+=4,e.first_offset=Ve(t,i),i+=4):(e.earliest_presentation_time=Ye(t,i),i+=8,e.first_offset=Ye(t,i),i+=8),i+=2,e.references=[];var n=ge(t,i);i+=2;for(var s=0;s<n;s++){var a={};e.references.push(a);var r=Ve(t,i);i+=4,a.reference_type=r>>31&1,a.referenced_size=2147483647&r,a.subsegment_duration=Ve(t,i),r=Ve(t,i+=4),i+=4,a.starts_with_SAP=r>>31&1,a.SAP_type=r>>28&7,a.SAP_delta_time=268435455&r}}))}},{key:"moov",value:function(t){return et(t,!1,(function(t,i,n){t.mvhd=e.mvhd(e.findBox(i,["mvhd"],n)[0]),t.trak=e.findBox(i,["trak"],n).map((function(t){return e.trak(t)})),t.pssh=e.pssh(e.findBox(i,["pssh"],n)[0])}))}},{key:"mvhd",value:function(e){return et(e,!0,(function(e,t){var i=0;1===e.version?(e.timescale=Ve(t,16),e.duration=Ye(t,20),i+=28):(e.timescale=Ve(t,8),e.duration=Ve(t,12),i+=16),e.nextTrackId=Ve(t,i+76)}))}},{key:"trak",value:function(t){return et(t,!1,(function(t,i,n){t.tkhd=e.tkhd(e.findBox(i,["tkhd"],n)[0]),t.mdia=e.mdia(e.findBox(i,["mdia"],n)[0])}))}},{key:"tkhd",value:function(e){return et(e,!0,(function(e,t){var i=_e.fromUint8(t);1===e.version?(i.read(8),i.read(8),e.trackId=i.read(4),i.read(4),e.duration=i.read(8)):(i.read(4),i.read(4),e.trackId=i.read(4),i.read(4),e.duration=i.read(4)),i.skip(16),e.matrix=[];for(var n=0;n<36;n++)e.matrix.push(i.read(1));i.back(36);for(var s,a=[],r=0;r<3;r++)a.push(we(i.readInt(2),i.readInt(2))),a.push(we(i.readInt(2),i.readInt(2))),s=i.readInt(4),a.push(we(s>>30,1073741823&s));e.rotation=function(e){if(e.length<5)return 0;var t=Math.hypot(e[0],e[3]),i=Math.hypot(e[1],e[4]);return 0===t||0===i?0:180*Math.atan2(e[1]/i,e[0]/t)/Math.PI}(a),e.width=i.read(4),e.height=i.read(4)}))}},{key:"mdia",value:function(t){return et(t,!1,(function(t,i,n){t.mdhd=e.mdhd(e.findBox(i,["mdhd"],n)[0]),t.hdlr=e.hdlr(e.findBox(i,["hdlr"],n)[0]),t.minf=e.minf(e.findBox(i,["minf"],n)[0])}))}},{key:"mdhd",value:function(e){return et(e,!0,(function(e,t){var i=0;1===e.version?(e.timescale=Ve(t,16),e.duration=Ye(t,20),i+=28):(e.timescale=Ve(t,8),e.duration=Ve(t,12),i+=16);var n=ge(t,i);e.language=String.fromCharCode(96+(n>>10&31),96+(n>>5&31),96+(31&n))}))}},{key:"hdlr",value:function(e){return et(e,!0,(function(e,t){0===e.version&&(e.handlerType=String.fromCharCode.apply(null,t.subarray(4,8)))}))}},{key:"minf",value:function(t){return et(t,!1,(function(t,i,n){t.vmhd=e.vmhd(e.findBox(i,["vmhd"],n)[0]),t.smhd=e.smhd(e.findBox(i,["smhd"],n)[0]),t.stbl=e.stbl(e.findBox(i,["stbl"],n)[0])}))}},{key:"vmhd",value:function(e){return et(e,!0,(function(e,t){e.graphicsmode=ge(t),e.opcolor=[ge(t,2),ge(t,4),ge(t,6)]}))}},{key:"smhd",value:function(e){return et(e,!0,(function(e,t){e.balance=ge(t)}))}},{key:"stbl",value:function(t){return et(t,!1,(function(t,i,n){var s,a,r;t.stsd=e.stsd(e.findBox(i,["stsd"],n)[0]),t.stts=e.stts(e.findBox(i,["stts"],n)[0]),t.ctts=e.ctts(e.findBox(i,["ctts"],n)[0]),t.stsc=e.stsc(e.findBox(i,["stsc"],n)[0]),t.stsz=e.stsz(e.findBox(i,["stsz"],n)[0]),t.stco=e.stco(e.findBox(i,["stco"],n)[0]),t.stco||(t.co64=e.co64(e.findBox(i,["co64"],n)[0]),t.stco=t.co64);var l=null===(s=t.stsd.entries[0])||void 0===s||null===(a=s.sinf)||void 0===a||null===(r=a.schi)||void 0===r?void 0:r.tenc.default_IV_size;t.stss=e.stss(e.findBox(i,["stss"],n)[0]),t.senc=e.senc(e.findBox(i,["senc"],n)[0],l)}))}},{key:"senc",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8;return et(e,!0,(function(e,i){var n=0,s=Ve(i,n);n+=4,e.samples=[];for(var a=0;a<s;a++){for(var r={InitializationVector:[]},l=0;l<t;l++)r.InitializationVector[l]=i[n+l];if(n+=t,2&e.flags){r.subsamples=[];var o=ge(i,n);n+=2;for(var d=0;d<o;d++){var c={};c.BytesOfClearData=ge(i,n),n+=2,c.BytesOfProtectedData=Ve(i,n),n+=4,r.subsamples.push(c)}}e.samples.push(r)}}))}},{key:"pssh",value:function(e){return et(e,!0,(function(e,t){for(var i=[],n=[],s=0,a=0;a<16;a++)n.push(it(t[s+a]));if(s+=16,e.version>0){var r=Ve(t,s);s+=4;for(var l=0;l<(""+r).length;l++)for(var o=0;o<16;o++){var d=t[s];s+=1,i.push(it(d))}}var c=Ve(t,s);e.data_size=c,s+=4,e.kid=i,e.system_id=n,e.buffer=t}))}},{key:"stsd",value:function(t){return et(t,!0,(function(t,i,n){t.entryCount=Ve(i),t.entries=e.findBox(i.subarray(4),[],n+4).map((function(t){switch(t.type){case"av01":return e.av01(t);case"avc1":case"avc2":case"avc3":case"avc4":return e.avc1(t);case"hvc1":case"hev1":return e.hvc1(t);case"mp4a":return e.mp4a(t);case"alaw":case"ulaw":return e.alaw(t);case"enca":return et(t,!1,(function(t,i,n){t.channelCount=ge(i,16),t.samplesize=ge(i,18),t.sampleRate=Ve(i,24)/65536,i=i.subarray(28),t.sinf=e.sinf(e.findBox(i,["sinf"],n)[0]),t.esds=e.esds(e.findBox(i,["esds"],n)[0])}));case"encv":return et(t,!1,(function(t,i,n){t.width=ge(i,24),t.height=ge(i,26),t.horizresolution=Ve(i,28),t.vertresolution=Ve(i,32),i=i.subarray(78),t.sinf=e.sinf(e.findBox(i,["sinf"],n)[0]),t.avcC=e.avcC(e.findBox(i,["avcC"],n)[0]),t.hvcC=e.hvcC(e.findBox(i,["hvcC"],n)[0]),t.pasp=e.pasp(e.findBox(i,["pasp"],n)[0])}))}})).filter(Boolean)}))}},{key:"tenc",value:function(e){return et(e,!1,(function(e,t){var i=6;e.default_IsEncrypted=t[i],i+=1,e.default_IV_size=t[i],i+=1,e.default_KID=[];for(var n=0;n<16;n++)e.default_KID.push(it(t[i])),i+=1}))}},{key:"schi",value:function(t){return et(t,!1,(function(t,i,n){t.tenc=e.tenc(e.findBox(i,["tenc"],n)[0])}))}},{key:"sinf",value:function(t){return et(t,!1,(function(t,i,n){t.schi=e.schi(e.findBox(i,["schi"],n)[0]),t.frma=e.frma(e.findBox(i,["frma"],n)[0])}))}},{key:"frma",value:function(e){return et(e,!1,(function(e,t){e.data_format="";for(var i=0;i<4;i++)e.data_format+=String.fromCharCode(t[i])}))}},{key:"colr",value:function(e){return et(e,!1,(function(t,i){var n=_e.fromUint8(i);t.data=e.data,t.colorType=n.readString(4),"nclx"===t.colorType?(t.colorPrimaries=n.read(2),t.transferCharacteristics=n.read(2),t.matrixCoefficients=n.read(2),t.fullRangeFlag=n.read(1)>>7):"rICC"!==t.colorType&&"prof"!==t.colorType||(t.iccProfile=i.readToUint8())}))}},{key:"av01",value:function(t){return et(t,!1,(function(t,i,n){var s=qe(t,i),a=i.subarray(s);n+=s,t.av1C=e.av1C(e.findBox(a,["av1C"],n)[0]),t.colr=e.colr(e.findBox(a,["colr"],n)[0])}))}},{key:"av1C",value:function(e){return et(e,!1,(function(t,i){t.data=e.data;var n,s=_e.fromUint8(i),a=Qe.fromByte(s,4);t.marker=a.read(1),t.version=a.read(7),t.seqProfile=a.read(3),t.seqLevelIdx0=a.read(5),t.seqTier0=a.read(1),t.highBitdepth=a.read(1),t.twelveBit=a.read(1),t.monochrome=a.read(1),t.chromaSubsamplingX=a.read(1),t.chromaSubsamplingY=a.read(1),t.chromaSamplePosition=a.read(2),t.reserved=a.read(3),t.initialPresentationDelayPresent=a.read(1),t.initialPresentationDelayPresent?t.initialPresentationDelayMinusOne=a.read(4):t.initialPresentationDelayMinusOne=0,t.configOBUs=s.readToUint8(),2===t.seqLevelIdx0&&1===t.highBitdepth?n=1===t.twelveBit?"12":"10":t.seqProfile<=2&&(n=1===t.highBitdepth?"10":"08"),t.codec=["av01",t.seqProfile,(t.seqLevelIdx0<10?"0"+t.seqLevelIdx0:t.seqLevelIdx0)+(t.seqTier0?"H":"M"),n].join(".")}))}},{key:"avc1",value:function(t){return et(t,!1,(function(t,i,n){var s=qe(t,i),a=i.subarray(s);n+=s,t.avcC=e.avcC(e.findBox(a,["avcC"],n)[0]),t.pasp=e.pasp(e.findBox(a,["pasp"],n)[0])}))}},{key:"avcC",value:function(e){return et(e,!1,(function(t,i){t.data=e.data,t.configurationVersion=i[0],t.AVCProfileIndication=i[1],t.profileCompatibility=i[2],t.AVCLevelIndication=i[3],t.codec=ke([i[1],i[2],i[3]]),t.lengthSizeMinusOne=3&i[4],t.spsLength=31&i[5],t.sps=[];for(var n=6,s=0;s<t.spsLength;s++){var a=ge(i,n);n+=2,t.sps.push(i.subarray(n,n+a)),n+=a}t.ppsLength=i[n],n+=1,t.pps=[];for(var r=0;r<t.ppsLength;r++){var l=ge(i,n);n+=2,t.pps.push(i.subarray(n,n+=l)),n+=l}}))}},{key:"hvc1",value:function(t){return et(t,!1,(function(t,i,n){var s=qe(t,i),a=i.subarray(s);n+=s,t.hvcC=e.hvcC(e.findBox(a,["hvcC"],n)[0]),t.pasp=e.pasp(e.findBox(a,["pasp"],n)[0])}))}},{key:"hvcC",value:function(e){return et(e,!1,(function(t,i){t.data=e.data,t.codec="hev1.1.6.L93.B0",t.configurationVersion=i[0];var n=i[1];t.generalProfileSpace=n>>6,t.generalTierFlag=(32&n)>>5,t.generalProfileIdc=31&n,t.generalProfileCompatibility=Ve(i,2),t.generalConstraintIndicatorFlags=i.subarray(6,12),t.generalLevelIdc=i[12],t.avgFrameRate=ge(i,19),t.numOfArrays=i[22],t.vps=[],t.sps=[],t.pps=[];for(var s=23,a=0,r=0,l=0,o=0;o<t.numOfArrays;o++){a=63&i[s],r=ge(i,s+1),s+=3;for(var d,c=[],u=0;u<r;u++)l=ge(i,s),s+=2,c.push(i.subarray(s,s+l)),s+=l;if(32===a)(d=t.vps).push.apply(d,c);else if(33===a){var m;(m=t.sps).push.apply(m,c)}else if(34===a){var h;(h=t.pps).push.apply(h,c)}}}))}},{key:"pasp",value:function(e){return et(e,!1,(function(e,t){e.hSpacing=Ve(t),e.vSpacing=Ve(t,4)}))}},{key:"mp4a",value:function(t){return et(t,!1,(function(t,i,n){var s=$e(t,i);t.esds=e.esds(e.findBox(i.subarray(s),["esds"],n+s)[0])}))}},{key:"esds",value:function(e){return et(e,!0,(function(e,t){e.codec="mp4a.";for(var i=0,n=0,s=0,a=0;t.length;){for(a=t[i=0],n=t[i+1],i+=2;128&n;)s=(127&n)<<7,n=t[i],i+=1;if(s+=127&n,3===a)t=t.subarray(i+3);else{if(4!==a){if(5===a){var r=e.config=t.subarray(i,i+s),l=(248&r[0])>>3;return 31===l&&r.length>=2&&(l=32+((7&r[0])<<3)+((224&r[1])>>5)),e.objectType=l,e.codec+=l.toString(16),void("."===e.codec[e.codec.length-1]&&(e.codec=e.codec.substring(0,e.codec.length-1)))}return void("."===e.codec[e.codec.length-1]&&(e.codec=e.codec.substring(0,e.codec.length-1)))}e.codec+=(t[i].toString(16)+".").padStart(3,"0"),t=t.subarray(i+13)}}}))}},{key:"alaw",value:function(e){return et(e,!1,(function(e,t){$e(e,t)}))}},{key:"stts",value:function(e){return et(e,!0,(function(e,t){for(var i=Ve(t),n=[],s=4,a=0;a<i;a++)n.push({count:Ve(t,s),delta:Ve(t,s+4)}),s+=8;e.entryCount=i,e.entries=n}))}},{key:"ctts",value:function(e){return et(e,!0,(function(e,t){var i=Ve(t),n=[],s=4;if(1===e.version)for(var a=0;a<i;a++)n.push({count:Ve(t,s),offset:Ve(t,s+4)}),s+=8;else for(var r=0;r<i;r++)n.push({count:Ve(t,s),offset:-(1+~Ve(t,s+4))}),s+=8;e.entryCount=i,e.entries=n}))}},{key:"stsc",value:function(e){return et(e,!0,(function(e,t){for(var i=Ve(t),n=[],s=4,a=0;a<i;a++)n.push({firstChunk:Ve(t,s),samplesPerChunk:Ve(t,s+4),sampleDescriptionIndex:Ve(t,s+8)}),s+=12;e.entryCount=i,e.entries=n}))}},{key:"stsz",value:function(e){return et(e,!0,(function(e,t){var i=Ve(t),n=Ve(t,4),s=[];if(!i)for(var a=8,r=0;r<n;r++)s.push(Ve(t,a)),a+=4;e.sampleSize=i,e.sampleCount=n,e.entrySizes=s}))}},{key:"stco",value:function(e){return et(e,!0,(function(e,t){for(var i=Ve(t),n=[],s=4,a=0;a<i;a++)n.push(Ve(t,s)),s+=4;e.entryCount=i,e.entries=n}))}},{key:"co64",value:function(e){return et(e,!0,(function(e,t){for(var i=Ve(t),n=[],s=4,a=0;a<i;a++)n.push(Ye(t,s)),s+=8;e.entryCount=i,e.entries=n}))}},{key:"stss",value:function(e){return et(e,!0,(function(e,t){for(var i=Ve(t),n=[],s=4,a=0;a<i;a++)n.push(Ve(t,s)),s+=4;e.entryCount=i,e.entries=n}))}},{key:"moof",value:function(t){return et(t,!1,(function(t,i,n){t.mfhd=e.mfhd(e.findBox(i,["mfhd"],n)[0]),t.traf=e.findBox(i,["traf"],n).map((function(t){return e.traf(t)}))}))}},{key:"mfhd",value:function(e){return et(e,!0,(function(e,t){e.sequenceNumber=Ve(t)}))}},{key:"traf",value:function(t){return et(t,!1,(function(t,i,n){t.tfhd=e.tfhd(e.findBox(i,["tfhd"],n)[0]),t.tfdt=e.tfdt(e.findBox(i,["tfdt"],n)[0]),t.trun=e.trun(e.findBox(i,["trun"],n)[0])}))}},{key:"trun",value:function(e){return et(e,!0,(function(e,t){var i=e.version,n=e.flags,s=t.length,a=e.sampleCount=Ve(t),r=4;if(s>r&&1&n&&(e.dataOffset=-(1+~Ve(t,r)),r+=4),s>r&&4&n&&(e.firstSampleFlags=Ve(t,r),r+=4),e.samples=[],s>r)for(var l,o=0;o<a;o++)l={},256&n&&(l.duration=Ve(t,r),r+=4),512&n&&(l.size=Ve(t,r),r+=4),1024&n&&(l.flags=Ve(t,r),r+=4),2048&n&&(l.cts=i?-(1+~Ve(t,r+4)):Ve(t,r),r+=4),e.samples.push(l)}))}},{key:"tfdt",value:function(e){return et(e,!0,(function(e,t){1===e.version?e.baseMediaDecodeTime=Ye(t):e.baseMediaDecodeTime=Ve(t)}))}},{key:"probe",value:function(t){return!!e.findBox(t,["ftyp"])}},{key:"parseSampleFlags",value:function(e){return{isLeading:(12&e[0])>>>2,dependsOn:3&e[0],isDependedOn:(192&e[1])>>>6,hasRedundancy:(48&e[1])>>>4,paddingValue:(14&e[1])>>>1,isNonSyncSample:1&e[1],degradationPriority:e[2]<<8|e[3]}}},{key:"moovToTrack",value:function(e,t,i){var n,s,a=e.trak;if(a&&a.length){var r=a.find((function(e){var t,i;return"vide"===(null===(t=e.mdia)||void 0===t||null===(i=t.hdlr)||void 0===i?void 0:i.handlerType)})),l=a.find((function(e){var t,i;return"soun"===(null===(t=e.mdia)||void 0===t||null===(i=t.hdlr)||void 0===i?void 0:i.handlerType)}));if(r&&t){var o,d,c,u,m,h,p,Z=t,y=null===(o=r.tkhd)||void 0===o?void 0:o.trackId;null!=y&&(Z.id=r.tkhd.trackId),Z.tkhdDuration=r.tkhd.duration,Z.mvhdDurtion=e.mvhd.duration,Z.mvhdTimecale=e.mvhd.timescale,Z.timescale=Z.formatTimescale=r.mdia.mdhd.timescale,Z.duration=r.mdia.mdhd.duration||Z.mvhdDurtion/Z.mvhdTimecale*Z.timescale,Z.rotation=r.tkhd.rotation,Z.matrix=r.tkhd.matrix;var b,f,X,L,W,G,v,x,S=r.mdia.minf.stbl.stsd.entries[0];if(Z.width=S.width,Z.height=S.height,S.pasp&&(Z.sarRatio=[S.pasp.hSpacing,S.pasp.vSpacing]),S.av1C)Z.codecType=Q,Z.codec=S.av1C.codec,Z.av1C=S.av1C.data,Z.colr=S.colr.data;else if(S.hvcC)Z.codecType=A,Z.codec=S.hvcC.codec,Z.vps=S.hvcC.vps,Z.sps=S.hvcC.sps,Z.pps=S.hvcC.pps,Z.hvcC=S.hvcC.data;else{if(!S.avcC)throw new Error("unknown video stsd entry");Z.codec=S.avcC.codec,Z.sps=S.avcC.sps,Z.pps=S.avcC.pps}if(Z.present=!0,Z.ext={},Z.ext.stss=null===(d=r.mdia)||void 0===d||null===(c=d.minf)||void 0===c||null===(u=c.stbl)||void 0===u?void 0:u.stss,Z.ext.ctts=null===(m=r.mdia)||void 0===m||null===(h=m.minf)||void 0===h||null===(p=h.stbl)||void 0===p?void 0:p.ctts,S&&"encv"===S.type)Z.isVideoEncryption=!0,S.default_KID=null===(b=S.sinf)||void 0===b||null===(f=b.schi)||void 0===f?void 0:f.tenc.default_KID,S.default_IsEncrypted=null===(X=S.sinf)||void 0===X||null===(L=X.schi)||void 0===L?void 0:L.tenc.default_IsEncrypted,S.default_IV_size=null===(W=S.sinf)||void 0===W||null===(G=W.schi)||void 0===G?void 0:G.tenc.default_IV_size,Z.videoSenc=r.mdia.minf.stbl.senc&&r.mdia.minf.stbl.senc.samples,S.data_format=null===(v=S.sinf)||void 0===v||null===(x=v.frma)||void 0===x?void 0:x.data_format,Z.useEME=e.useEME,Z.kidValue=e.kidValue,Z.pssh=e.pssh,Z.encv=S}if(l&&i){var g,V,Y,k,R,T,w,M,K,I=i,H=null===(g=l.tkhd)||void 0===g?void 0:g.trackId;null!=H&&(I.id=l.tkhd.trackId),I.tkhdDuration=l.tkhd.duration,I.mvhdDurtion=e.mvhd.duration,I.mvhdTimecale=e.mvhd.timescale,I.timescale=I.formatTimescale=l.mdia.mdhd.timescale,I.duration=l.mdia.mdhd.duration||I.mvhdDurtion/I.mvhdTimecale*I.timescale;var C,N,F,z,U,J,j,P,E=l.mdia.minf.stbl.stsd.entries[0];switch(I.sampleSize=E.sampleSize,I.sampleRate=E.sampleRate,I.channelCount=E.channelCount,I.present=!0,E.type){case"alaw":I.codecType=I.codec=$,I.sampleRate=8e3;break;case"ulaw":I.codecType=I.codec=ee,I.sampleRate=8e3;break;default:I.sampleDuration=Me.getFrameDuration(I.sampleRate,I.timescale),I.sampleRateIndex=Me.getRateIndexByRate(I.sampleRate),I.objectType=(null===(n=E.esds)||void 0===n?void 0:n.objectType)||2,E.esds&&(I.config=Array.from(E.esds.config)),I.codec=(null===(s=E.esds)||void 0===s?void 0:s.codec)||"mp4a.40.2"}if(I.sampleDuration=Me.getFrameDuration(I.sampleRate,I.timescale),I.objectType=(null===(V=E.esds)||void 0===V?void 0:V.objectType)||2,E.esds&&(E.esds.config?I.config=Array.from(E.esds.config):console.warn("esds config is null")),I.codec=(null===(Y=E.esds)||void 0===Y?void 0:Y.codec)||"mp4a.40.2",I.sampleRateIndex=Me.getRateIndexByRate(I.sampleRate),I.ext={},I.ext.stss=null===(k=l.mdia)||void 0===k||null===(R=k.minf)||void 0===R||null===(T=R.stbl)||void 0===T?void 0:T.stss,I.ext.ctts=null===(w=l.mdia)||void 0===w||null===(M=w.minf)||void 0===M||null===(K=M.stbl)||void 0===K?void 0:K.ctts,I.present=!0,E&&"enca"===E.type)I.isAudioEncryption=!0,E.data_format=null===(C=E.sinf)||void 0===C||null===(N=C.frma)||void 0===N?void 0:N.data_format,E.default_KID=null===(F=E.sinf)||void 0===F||null===(z=F.schi)||void 0===z?void 0:z.tenc.default_KID,E.default_IsEncrypted=null===(U=E.sinf)||void 0===U||null===(J=U.schi)||void 0===J?void 0:J.tenc.default_IsEncrypted,E.default_IV_size=null===(j=E.sinf)||void 0===j||null===(P=j.schi)||void 0===P?void 0:P.tenc.default_IV_size,I.audioSenc=l.mdia.minf.stbl.senc&&l.mdia.minf.stbl.senc.samples,I.useEME=e.useEME,I.kidValue=e.kidValue,I.enca=E}if(i&&(i.isVideoEncryption=!!t&&t.isVideoEncryption),t&&(t.isAudioEncryption=!!i&&i.isAudioEncryption),null!=t&&t.encv||null!=i&&i.enca){var D,B,_=null==t||null===(D=t.encv)||void 0===D?void 0:D.default_KID,O=null==i||null===(B=i.enca)||void 0===B?void 0:B.default_KID,q=_||O?(_||O).join(""):null;t&&(t.kid=q),i&&(i.kid=q)}return t&&(t.flags=3841),i&&(i.flags=1793),{videoTrack:t,audioTrack:i}}}},{key:"evaluateDefaultDuration",value:function(e,t,i){var n,s=null==t||null===(n=t.samples)||void 0===n?void 0:n.length;return s?1024*s/t.timescale*e.timescale/i:1024}},{key:"moofToSamples",value:function(t,i,n){var s={};return t.mfhd&&(i&&(i.sequenceNumber=t.mfhd.sequenceNumber),n&&(n.sequenceNumber=t.mfhd.sequenceNumber)),t.traf.forEach((function(t){var a=t.tfhd,r=t.tfdt,l=t.trun;if(a&&l){r&&(i&&i.id===a.trackId&&(i.baseMediaDecodeTime=r.baseMediaDecodeTime),n&&n.id===a.trackId&&(n.baseMediaDecodeTime=r.baseMediaDecodeTime));var o=a.defaultSampleSize||0,d=a.defaultSampleDuration||e.evaluateDefaultDuration(i,n,l.samples.length||l.sampleCount),c=l.dataOffset||0,u=0,m=-1;if(!l.samples.length&&l.sampleCount){s[a.trackId]=[];for(var h=0;h<l.sampleCount;h++)s[a.trackId].push({offset:c,dts:u,duration:d,size:o}),u+=d,c+=o}else s[a.trackId]=l.samples.map((function(e,t){return(e={offset:c,dts:u,pts:u+(e.cts||0),duration:e.duration||d,size:e.size||o,gopId:m,keyframe:0===t||null!==e.flags&&void 0!==e.flags&&(65536&e.flags)>>>0!=65536}).keyframe&&(m++,e.gopId=m),u+=e.duration,c+=e.size,e}))}})),s}},{key:"moovToSamples",value:function(e){var t=e.trak;if(t&&t.length){var i=t.find((function(e){var t,i;return"vide"===(null===(t=e.mdia)||void 0===t||null===(i=t.hdlr)||void 0===i?void 0:i.handlerType)})),n=t.find((function(e){var t,i;return"soun"===(null===(t=e.mdia)||void 0===t||null===(i=t.hdlr)||void 0===i?void 0:i.handlerType)}));if(i||n){var s,a;if(i){var r,l,o=null===(r=i.mdia)||void 0===r||null===(l=r.minf)||void 0===l?void 0:l.stbl;if(!o)return;var d=o.stts,c=o.stsc,u=o.stsz,m=o.stco,h=o.stss,p=o.ctts;if(!(d&&c&&u&&m&&h))return;s=Ae(d,c,u,m,p,h)}if(n){var Z,y,b,f=null===(Z=n.mdia)||void 0===Z||null===(y=Z.minf)||void 0===y?void 0:y.stbl;if(!f)return;var X=null===(b=n.mdia.mdhd)||void 0===b?void 0:b.timescale,L=f.stts,W=f.stsc,G=f.stsz,v=f.stco;if(!(X&&L&&W&&G&&v))return;a=Ae(L,W,G,v)}return{videoSamples:s,audioSamples:a}}}}}]),e}();function Ae(e,t,i,n,s,a){var r,l,o,d=[],c=null==s?void 0:s.entries,u=t.entries,m=n.entries,h=i.entrySizes,p=null==a?void 0:a.entries;p&&(r={},p.forEach((function(e){r[e-1]=!0}))),c&&(l=[],c.forEach((function(e){for(var t=e.count,i=e.offset,n=0;n<t;n++)l.push(i)})));var Z=-1,y=0,b=0,f=0,X=0,L=0,W=u[0].samplesPerChunk,G=u[1]?u[1].firstChunk-1:1/0;return e.entries.forEach((function(e){for(var t=e.count,n=e.delta,s=0;s<t;s++)o={dts:y,duration:n,size:h[b]||i.sampleSize,offset:m[f]+L,index:b},p&&(o.keyframe=r[b],o.keyframe&&Z++,o.gopId=Z),l&&b<l.length&&(o.pts=o.dts+l[b]),d.push(o),y+=n,++b<W?L+=o.size:(f++,L=0,f>=G&&(X++,G=u[X+1]?u[X+1].firstChunk-1:1/0),W+=u[X].samplesPerChunk)})),d}function qe(e,t){return e.dataReferenceIndex=ge(t,6),e.width=ge(t,24),e.height=ge(t,26),e.horizresolution=Ve(t,28),e.vertresolution=Ve(t,32),e.frameCount=ge(t,40),e.depth=ge(t,74),78}function $e(e,t){return e.dataReferenceIndex=ge(t,6),e.channelCount=ge(t,16),e.sampleSize=ge(t,18),e.sampleRate=Ve(t,24)/65536,28}function et(e,t,i){if(e){if(e.size!==e.data.length)throw new Error("box ".concat(e.type," size !== data.length"));var n={start:e.start,size:e.size,headerSize:e.headerSize,type:e.type};return t&&(n.version=e.data[e.headerSize],n.flags=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(e[t]<<16)+(e[t+1]<<8)+(e[t+2]||0)}(e.data,e.headerSize+1),n.headerSize+=4),i(n,e.data.subarray(n.headerSize),n.start+n.headerSize),n}}var tt=function(e,t,i){for(var n=String(i),s=t>>0,a=Math.ceil(s/n.length),r=[],l=String(e);a--;)r.push(n);return r.join("").substring(0,s-l.length)+l},it=function(){for(var e=[],t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];return i.forEach((function(t){e.push(tt(Number(t).toString(16),2,0))})),e[0]},nt=function(){function e(t,i,n){X(this,e),G(this,"__loadedMoofWraps",[]),G(this,"__lastRemainData",null),G(this,"__lastRemainDataStart",0),G(this,"__nextMoofStart",-1),this.videoTrack=t||new oe,this.audioTrack=i||new de,this.metadataTrack=n||new Ze}return W(e,[{key:"demuxPart",value:function(e,t,i){var n=this,s=this.videoTrack,a=this.audioTrack,r=s.exist(),l=a.exist(),o=/av01/.test(s.codec);s.samples=[],a.samples=[];var d=e,c=t;if(this.__lastRemainData){var u=this.__lastRemainDataStart+this.__lastRemainData.byteLength;if(t<=u&&t>this.__lastRemainDataStart&&t+e.byteLength>u){var m=e.subarray(this.__lastRemainData.byteLength+this.__lastRemainDataStart-t);d=xe(this.__lastRemainData,m),c=this.__lastRemainDataStart,this.__lastRemainData=null}else this.__lastRemainData=null,this.__lastRemainDataStart=0,this.__nextMoofStart=-1}if(!i){var h=Oe.findBox(d,["moov"])[0];if(!h)throw new Error("cannot found moov box");i=Oe.moov(h)}if(d){var p=c+d.byteLength;r||l||Oe.moovToTrack(i,s,a);var Z=[];this.__nextMoofStart<0?Oe.findBox(d,["moof"],c).forEach((function(e){return Z.push(e)})):this.__nextMoofStart>=c&&this.__nextMoofStart<=p-8&&Oe.findBox(d.subarray(this.__nextMoofStart-c),["moof"],this.__nextMoofStart).forEach((function(e){return Z.push(e)})),Z.filter((function(e){return e.size<=e.data.length})).forEach((function(e){var t=Oe.moof(e);n.__nextMoofStart=t.start+Math.max.apply(Math,H(t.traf.map((function(e){return e.trun.samples.reduce((function(e,t){return e+t.size}),e.trun.dataOffset||0)})))),n.__loadedMoofWraps.push({start:t.start,nextMoofStart:n.__nextMoofStart,moof:t}),n.__loadedMoofWraps.sort((function(e,t){return e.start-t.start}))}));var y,b=F(this.__loadedMoofWraps);try{var f=function(){var e=y.value;if(e.start>p||e.nextMoofStart<c)return"continue";var t,i=e.start,r=Oe.moofToSamples(e.moof,s,a),l=s.baseMediaDecodeTime,u=a.baseMediaDecodeTime;Object.keys(r).forEach((function(e){s.id==e?r[e].some((function(e){var a=e.offset+=i;if(!(a<c)){if(a+e.size>p)return!0;var r=new ce((e.pts||e.dts)+l,e.dts+l);r.duration=e.duration,r.gopId=e.gopId,e.keyframe&&r.setToKeyframe();var u=d.subarray(a-c,a-c+e.size);if(r.data=u,!o)for(var m=0,h=u.length-1;m<h;)t=Ve(u,m),m+=4,r.units.push(u.subarray(m,m+t)),m+=t;n.__lastRemainDataStart=a+e.size,s.samples.push(r)}})):a.id==e&&r[e].some((function(e){var t=e.offset+i;if(!(t<c)){if(t+e.size>p)return!0;var s=d.subarray(t-c,t-c+e.size);a.samples.push(new ue(e.dts+u,s,e.duration)),n.__lastRemainDataStart=t+e.size}}))}))};for(b.s();!(y=b.n()).done;)f()}catch(X){b.e(X)}finally{b.f()}}return this.__lastRemainDataStart>c&&this.__lastRemainDataStart<d.byteLength+c?this.__lastRemainData=d.subarray(this.__lastRemainDataStart-c):(this.__lastRemainData=d,this.__lastRemainDataStart=c),s.samples.length&&(s.baseMediaDecodeTime=s.samples[0].pts),a.samples.length&&(a.baseMediaDecodeTime=a.samples[0].pts),{videoTrack:s,audioTrack:a,metadataTrack:this.metadataTrack}}},{key:"demux",value:function(e,t){var i=this.videoTrack,n=this.audioTrack,s=i.exist(),a=n.exist();if(i.samples=[],n.samples=[],t){if(!a){var r=Oe.findBox(t,["moov"])[0];if(!r)throw new Error("cannot found moov box");Oe.moovToTrack(Oe.moov(r),null,n)}var l=Oe.findBox(t,["moof"])[0];if(l){var o=Oe.moofToSamples(Oe.moof(l),null,n)[n.id],d=n.baseMediaDecodeTime;if(o){var c=l.start;o.map((function(e){e.offset+=c;var i=t.subarray(e.offset,e.offset+e.size);n.samples.push(new ue(e.dts+d,i,e.duration))}))}}}if(e){if(!s&&!a){var u=Oe.findBox(e,["moov"])[0];if(!u)throw new Error("cannot found moov box");Oe.moovToTrack(Oe.moov(u),i,n)}var m=Oe.findBox(e,["moof"])[0];if(m){var h,p=Oe.moofToSamples(Oe.moof(m),i,n),Z=i.baseMediaDecodeTime,y=n.baseMediaDecodeTime,b=m.start;Object.keys(p).forEach((function(t){i.id==t?p[t].map((function(t){t.offset+=b;var n=new ce((t.pts||t.dts)+Z,t.dts+Z);n.duration=t.duration,n.gopId=t.gopId,t.keyframe&&n.setToKeyframe();var s=e.subarray(t.offset,t.offset+t.size);n.data=s;for(var a=0,r=s.length-1;a<r;)h=Ve(s,a),a+=4,n.units.push(s.subarray(a,a+h)),a+=h;i.samples.push(n)})):n.id==t&&p[t].map((function(t){t.offset+=b;var i=e.subarray(t.offset,t.offset+t.size);n.samples.push(new ue(t.dts+y,i,t.duration))}))}))}}return{videoTrack:i,audioTrack:n,metadataTrack:this.metadataTrack}}},{key:"reset",value:function(){this.videoTrack.reset(),this.audioTrack.reset(),this.metadataTrack.reset()}}],[{key:"probe",value:function(e){return Oe.probe(e)}}]),e}();function st(e){for(var t=0,i=arguments.length,n=new Array(i>1?i-1:0),s=1;s<i;s++)n[s-1]=arguments[s];n.forEach((function(e){t+=e.length}));var a=new e(t),r=0;return n.forEach((function(e){a.set(e,r),r+=e.length})),a}var at=function(){function e(){X(this,e),this.buffer=new Uint8Array(0)}return W(e,[{key:"write",value:function(){for(var e=this,t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];i.forEach((function(t){t?e.buffer=st(Uint8Array,e.buffer,t):window.console.warn(t)}))}}],[{key:"writeUint16",value:function(e){return new Uint8Array([e>>8&255,255&e])}},{key:"writeUint32",value:function(e){return new Uint8Array([e>>24,e>>16&255,e>>8&255,255&e])}}]),e}(),rt=Math.pow(2,32)-1,lt=function(){function e(){X(this,e)}return W(e,null,[{key:"box",value:function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];var s=8+(i=i.filter(Boolean)).reduce((function(e,t){return e+t.byteLength}),0),a=new Uint8Array(s);a[0]=s>>24&255,a[1]=s>>16&255,a[2]=s>>8&255,a[3]=255&s,a.set(e,4);var r=8;return i.forEach((function(e){a.set(e,r),r+=e.byteLength})),a}},{key:"ftyp",value:function(t){return t.find((function(e){return e.type===D&&e.codecType===A}))?e.FTYPHEV1:e.FTYPAVC1}},{key:"initSegment",value:function(t){return xe(e.ftyp(t),e.moov(t))}},{key:"pssh",value:function(t){var i=new Uint8Array([1,0,0,0].concat([16,119,239,236,192,178,77,2,172,227,60,30,82,226,251,75],[0,0,0,1],Te(t.kid),[0,0,0,0]));return e.box(e.types.pssh,i)}},{key:"moov",value:function(t){if(t[0].useEME&&(t[0].encv||t[0].enca)){t[0].pssh||(t[0].pssh={kid:t[0].kid});var i=this.pssh(t[0].pssh);return e.box.apply(e,[e.types.moov,e.mvhd(t[0].mvhdDurtion||t[0].duration,t[0].mvhdTimecale||t[0].timescale),e.mvex(t)].concat(H(t.map((function(t){return e.trak(t)}))),[i]))}return e.box.apply(e,[e.types.moov,e.mvhd(t[0].mvhdDurtion||t[0].duration,t[0].mvhdTimecale||t[0].timescale)].concat(H(t.map((function(t){return e.trak(t)}))),[e.mvex(t)]))}},{key:"mvhd",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:9e4,n=e.box(e.types.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,i>>24&255,i>>16&255,i>>8&255,255&i,t>>24&255,t>>16&255,t>>8&255,255&t,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]));return n}},{key:"trak",value:function(t){return e.box(e.types.trak,e.tkhd(t.id,t.tkhdDuration||0,t.width,t.height),e.mdia(t))}},{key:"tkhd",value:function(t,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=e.box(e.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,t>>24&255,t>>16&255,t>>8&255,255&t,0,0,0,0,i>>24&255,i>>16&255,i>>8&255,255&i,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,n>>8&255,255&n,0,0,s>>8&255,255&s,0,0]));return a}},{key:"mdia",value:function(t){return e.box(e.types.mdia,e.mdhd(t.duration,t.timescale),e.hdlr(t.type),e.minf(t))}},{key:"mdhd",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:9e4,n=e.box(e.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,i>>24&255,i>>16&255,i>>8&255,255&i,t>>24&255,t>>16&255,t>>8&255,255&t,85,196,0,0]));return n}},{key:"hdlr",value:function(t){return e.box(e.types.hdlr,e.HDLR_TYPES[t])}},{key:"minf",value:function(t){return e.box(e.types.minf,t.type===D?e.VMHD:e.SMHD,e.DINF,e.stbl(t))}},{key:"stbl",value:function(t){var i=[];return t&&t.ext&&t.ext.stss&&i.push(e.stss(t.ext.stss.entries)),e.box(e.types.stbl,e.stsd(t),e.STTS,i[0],e.STSC,e.STSZ,e.STCO)}},{key:"stsd",value:function(t){var i;return i="audio"===t.type?t.useEME&&t.enca?e.enca(t):t.codecType===te?e.opus(t):e.mp4a(t):t.useEME&&t.encv?e.encv(t):t.av1C?e.av01(t):e.avc1hev1(t),e.box(e.types.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),i)}},{key:"enca",value:function(t){var i=t.enca.channelCount,n=t.enca.sampleRate,s=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,i,0,16,0,0,0,0,n>>8&255,255&n,0,0]),a=e.esds(t.config),r=e.sinf(t.enca);return e.box(e.types.enca,s,a,r)}},{key:"encv",value:function(t){var i,n,s=t.sps.length>0?t.sps[0]:[],a=t.pps.length>0?t.pps[0]:[],r=t.width,l=t.height,o=t.sarRatio[0],d=t.sarRatio[1],c=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,r>>8&255,255&r,l>>8&255,255&l,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),u=new Uint8Array((i=(n=[1,s[1],s[2],s[3],255,225,s.length>>>8&255,255&s.length]).concat.apply(n,H(s)).concat([1,a.length>>>8&255,255&a.length])).concat.apply(i,H(a))),m=new Uint8Array([0,0,88,57,0,15,200,192,0,4,86,72]),h=e.sinf(t.encv),p=new Uint8Array([o>>24,o>>16&255,o>>8&255,255&o,d>>24,d>>16&255,d>>8&255,255&d]);return e.box(e.types.encv,c,e.box(e.types.avcC,u),e.box(e.types.btrt,m),h,e.box(e.types.pasp,p))}},{key:"schi",value:function(t){var i=new Uint8Array([]),n=e.tenc(t);return e.box(e.types.schi,i,n)}},{key:"tenc",value:function(t){var i=new Uint8Array([0,0,0,0,0,0,255&t.default_IsEncrypted,255&t.default_IV_size].concat(Te(t.default_KID)));return e.box(e.types.tenc,i)}},{key:"sinf",value:function(t){var i=new Uint8Array([]),n=new Uint8Array([t.data_format.charCodeAt(0),t.data_format.charCodeAt(1),t.data_format.charCodeAt(2),t.data_format.charCodeAt(3)]),s=new Uint8Array([0,0,0,0,99,101,110,99,0,1,0,0]),a=e.schi(t);return e.box(e.types.sinf,i,e.box(e.types.frma,n),e.box(e.types.schm,s),a)}},{key:"av01",value:function(t){return e.box(e.types.av01,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,t.width>>8&255,255&t.width,t.height>>8&255,255&t.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),t.av1C,t.colr)}},{key:"avc1hev1",value:function(t){var i=t.codecType===A,n=i?e.types.hvc1:e.types.avc1,s=i?e.hvcC(t):e.avcC(t),a=[new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,t.width>>8&255,255&t.width,t.height>>8&255,255&t.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s];return i?a.push(e.box(e.types.fiel,new Uint8Array([1,0]))):t.sarRatio&&t.sarRatio.length>1&&a.push(e.pasp(t.sarRatio)),e.box.apply(e,[n].concat(a))}},{key:"avcC",value:function(t){var i,n,s,a=[],r=[];return t.sps.forEach((function(e){s=e.byteLength,a.push(s>>>8&255),a.push(255&s),a.push.apply(a,H(e))})),t.pps.forEach((function(e){s=e.byteLength,r.push(s>>>8&255),r.push(255&s),r.push.apply(r,H(e))})),e.box(e.types.avcC,new Uint8Array((i=(n=[1,a[3],a[4],a[5],255,224|t.sps.length]).concat.apply(n,a).concat([t.pps.length])).concat.apply(i,r)))}},{key:"hvcC",value:function(t){var i=t.hvcC;if(i instanceof ArrayBuffer||i instanceof Uint8Array)return i;var n,s=t.vps,a=t.sps,r=t.pps;if(i){var l=i.generalProfileCompatibilityFlags,o=i.generalConstraintIndicatorFlags,d=(s.length&&1)+(a.length&&1)+(r.length&&1);n=[1,i.generalProfileSpace<<6|i.generalTierFlag<<5|i.generalProfileIdc,l>>>24,l>>>16,l>>>8,l,o[0],o[1],o[2],o[3],o[4],o[5],i.generalLevelIdc,240,0,252,252|i.chromaFormatIdc,248|i.bitDepthLumaMinus8,248|i.bitDepthChromaMinus8,0,0,i.numTemporalLayers<<3|i.temporalIdNested<<2|3,d];var c=function(e){var t;n.push(e.length>>8,e.length),(t=n).push.apply(t,H(e))};s.length&&(n.push(160,0,s.length),s.forEach(c)),a.length&&(n.push(161,0,a.length),a.forEach(c)),r.length&&(n.push(162,0,r.length),r.forEach(c))}else n=[1,1,96,0,0,0,144,0,0,0,0,0,93,240,0,252,253,248,248,0,0,15,3,160,0,1,0,24,64,1,12,1,255,255,1,96,0,0,3,0,144,0,0,3,0,0,3,0,93,153,152,9,161,0,1,0,45,66,1,1,1,96,0,0,3,0,144,0,0,3,0,0,3,0,93,160,2,128,128,45,22,89,153,164,147,43,154,128,128,128,130,0,0,3,0,2,0,0,3,0,50,16,162,0,1,0,7,68,1,193,114,180,98,64];return e.box(e.types.hvcC,new Uint8Array(n))}},{key:"pasp",value:function(t){var i=I(t,2),n=i[0],s=i[1];return e.box(e.types.pasp,new Uint8Array([n>>24,n>>16&255,n>>8&255,255&n,s>>24,s>>16&255,s>>8&255,255&s]))}},{key:"mp4a",value:function(t){return e.box(e.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,t.sampleRate>>8&255,255&t.sampleRate,0,0]),t.config.length?e.esds(t.config):void 0)}},{key:"esds",value:function(t){var i=t.length;return e.box(e.types.esds,new Uint8Array([0,0,0,0,3,23+i,0,0,0,4,15+i,64,21,0,6,0,0,0,218,192,0,0,218,192,5].concat([i]).concat(t).concat([6,1,2])))}},{key:"opus",value:function(t){var i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,t.sampleRate>>8&255,255&t.sampleRate,0,0]),n=t.config.length?e.dOps(t):[];return e.box(e.types.Opus,i,n)}},{key:"dOps",value:function(t){if(t.config)return t.config[4]=t.sampleRate>>>24&255,t.config[5]=t.sampleRate>>>16&255,t.config[6]=t.sampleRate>>>8&255,t.config[7]=255&t.sampleRate,e.box(e.types.dOps,t.config)}},{key:"mvex",value:function(t){return e.box.apply(e,[e.types.mvex].concat(H(t.map((function(t){return e.trex(t.id)})))))}},{key:"trex",value:function(t){return e.box(e.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}},{key:"trex1",value:function(t){return e.box(e.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t,0,0,0,1,0,0,2,0,0,0,0,0,0,1,0,0]))}},{key:"trex2",value:function(t){return e.box(e.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t,0,0,0,1,0,0,4,0,0,0,0,0,2,0,0,0]))}},{key:"moof",value:function(t){return e.box.apply(e,[e.types.moof,e.mfhd(t[0].samples?t[0].samples[0].gopId:0)].concat(H(t.map((function(t){return e.traf(t)})))))}},{key:"mfhd",value:function(t){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))}},{key:"traf",value:function(t){var i=e.tfhd(t.id),n=e.tfdt(t,t.baseMediaDecodeTime),s=0;if(t.isVideo&&t.videoSenc&&t.videoSenc.forEach((function(e){s+=8,e.subsamples&&e.subsamples.length&&(s+=2,s+=6*e.subsamples.length)})),t.videoSencLength=s,t.useEME&&(t.isVideoEncryption||t.isAudioEncryption)){if(t.isVideoEncryption){if(t.isVideo){var a=e.saiz(t),r=e.saio(t),l=e.trun1(t),o=e.senc(t);return e.box(e.types.traf,i,n,a,r,l,o)}if(t.isAudioEncryption){var d=e.sbgp(),c=e.saiz(t),u=e.saio(t),m=e.senc(t),h=e.trun1(t);return e.box(e.types.traf,i,n,d,c,u,m,h)}var p=e.sbgp(),Z=e.trun1(t);return e.box(e.types.traf,i,n,p,Z)}if(t.isVideo){var y=e.trun1(t);return e.box(e.types.traf,i,n,y)}var b=e.sbgp(),f=e.saiz(t),X=e.saio(t),L=e.senc(t),W=e.trun1(t);return e.box(e.types.traf,i,n,b,f,X,L,W)}var G=e.sdtp(t);return e.box(e.types.traf,i,n,G,e.trun(t.samples,G.byteLength+76))}},{key:"sdtp",value:function(t){var i=new at;return t.samples.forEach((function(e){i.write(new Uint8Array(t.isVideo?[e.keyframe?32:16]:[16]))})),e.box(e.types.sdtp,this.extension(0,0),i.buffer)}},{key:"trun1",value:function(t){var i=new at,n=at.writeUint32(t.samples.length),s=null;if(t.isVideo){var a=t.videoSencLength;s=at.writeUint32(16*t.samples.length+a+149),!t.isVideoEncryption&&t.isAudioEncryption&&(s=at.writeUint32(16*t.samples.length+92))}else{var r=12*t.samples.length+124;t.isAudioEncryption&&(r=12*t.samples.length+8*t.audioSenc.length+177),s=at.writeUint32(r)}return t.samples.forEach((function(e){i.write(at.writeUint32(e.duration)),i.write(at.writeUint32(e.size)),i.write(at.writeUint32(e.keyframe?33554432:65536)),t.isVideo&&i.write(at.writeUint32(e.cts?e.cts:0))})),e.box(e.types.trun,this.extension(0,t.flags),n,s,i.buffer)}},{key:"senc",value:function(t){var i=new at,n=t.samples.length,s=t.isVideo?16:8,a=t.isVideo?2:0,r=[],l=0;return t.isVideo?(r=t.videoSenc,l=t.videoSencLength):r=t.audioSenc,l=l||s*n,i.write(at.writeUint32(16+l),e.types.senc,this.extension(0,a)),i.write(at.writeUint32(n)),r.forEach((function(e){for(var t=0;t<e.InitializationVector.length;t++)i.write(new Uint8Array([e.InitializationVector[t]]));e.subsamples&&e.subsamples.length&&(i.write(at.writeUint16(e.subsamples.length)),e.subsamples.forEach((function(e){i.write(at.writeUint16(e.BytesOfClearData)),i.write(at.writeUint32(e.BytesOfProtectedData))})))})),i.buffer}},{key:"saio",value:function(t){var i=12*t.samples.length+141;!t.isVideo&&t.isAudioEncryption&&(i=149);var n=new Uint8Array([1,0,0,0,0,0,0,1,0,0,0,0,i>>24&255,i>>16&255,i>>8&255,255&i]);return e.box(e.types.saio,n)}},{key:"saiz",value:function(t){var i=t.samples.length,n=new Uint8Array([0,0,0,0,16,i>>24&255,i>>16&255,i>>8&255,255&i]);return e.box(e.types.saiz,n)}},{key:"sbgp",value:function(){var t=new Uint8Array([114,111,108,108,0,0,0,1,0,0,1,25,0,0,0,1]);return e.box(e.types.sbgp,this.extension(0,0),t)}},{key:"extension",value:function(e,t){return new Uint8Array([e,t>>16&255,t>>8&255,255&t])}},{key:"tfhd",value:function(t){return e.box(e.types.tfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))}},{key:"tfdt",value:function(t,i){var n=Math.floor(i/(rt+1)),s=Math.floor(i%(rt+1));return t.useEME&&(t.isVideoEncryption||t.isAudioEncryption)?e.box(e.types.tfdt,new Uint8Array([0,0,0,0,s>>24,s>>16&255,s>>8&255,255&s])):e.box(e.types.tfdt,new Uint8Array([1,0,0,0,n>>24,n>>16&255,n>>8&255,255&n,s>>24,s>>16&255,s>>8&255,255&s]))}},{key:"trun",value:function(t,i){var n=t.length,s=12+16*n;i+=8+s;var a=new Uint8Array(s);a.set([0,0,15,1,n>>>24&255,n>>>16&255,n>>>8&255,255&n,i>>>24&255,i>>>16&255,i>>>8&255,255&i],0);for(var r=0;r<n;r++){var l=t[r],o=l.duration,d=l.size,c=l.flag,u=void 0===c?{}:c,m=l.cts,h=void 0===m?0:m;a.set([o>>>24&255,o>>>16&255,o>>>8&255,255&o,d>>>24&255,d>>>16&255,d>>>8&255,255&d,u.isLeading<<2|(null===u.dependsOn||void 0===u.dependsOn?1:u.dependsOn),u.isDependedOn<<6|u.hasRedundancy<<4|u.paddingValue<<1|(null===u.isNonSyncSample||void 0===u.isNonSyncSample?1:u.isNonSyncSample),61440&u.degradationPriority,15&u.degradationPriority,h>>>24&255,h>>>16&255,h>>>8&255,255&h],12+16*r)}return e.box(e.types.trun,a)}},{key:"moovMP4",value:function(t){return e.box.apply(e,[e.types.moov,e.mvhd(t[0].duration,t[0].timescale)].concat(H(t.map((function(t){return e.trackMP4(t)})))))}},{key:"trackMP4",value:function(t){return e.box(e.types.trak,e.tkhd(t.id,t.duration,t.width,t.height),e.mdiaMP4(t))}},{key:"mdiaMP4",value:function(t){return e.box(e.types.mdia,e.mdhd(t.duration,t.timescale),e.hdlr(t.type),e.minfMP4(t))}},{key:"minfMP4",value:function(t){return e.box(e.types.minf,t.type===D?e.VMHD:e.SMHD,e.DINF,e.stblMP4(t))}},{key:"stblMP4",value:function(t){var i=t.ext,n=[e.stsd(t),e.stts(i.stts),e.stsc(i.stsc),e.stsz(i.stsz),e.stco(i.stco)];return i.stss.length&&n.push(e.stss(i.stss)),i.ctts.length&&n.push(e.ctts(i.ctts)),e.box.apply(e,[e.types.stbl].concat(n))}},{key:"stts",value:function(t){var i=t.length,n=new Uint8Array(8*i),s=0;return t.forEach((function(e){var t=e.value,i=e.count;n.set([i>>24,i>>16&255,i>>8&255,255&i,t>>24,t>>16&255,t>>8&255,255&t],s),s+=8})),e.box(e.types.stts,xe(new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i]),n))}},{key:"stsc",value:function(t){var i=t.length,n=new Uint8Array(12*i),s=0;return t.forEach((function(e){var t=e.firstChunk,i=e.samplesPerChunk,a=e.sampleDescIndex;n.set([t>>24,t>>16&255,t>>8&255,255&t,i>>24,i>>16&255,i>>8&255,255&i,a>>24,a>>16&255,a>>8&255,255&a],s),s+=12})),e.box(e.types.stsc,xe(new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i]),n))}},{key:"stsz",value:function(t){var i=t.length,n=new Uint8Array(4*i),s=0;return t.forEach((function(e){n.set([e>>24,e>>16&255,e>>8&255,255&e],s),s+=4})),e.box(e.types.stsz,xe(new Uint8Array([0,0,0,0,0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i]),n))}},{key:"stco",value:function(t){var i=t.length,n=new Uint8Array(4*i),s=0;return t.forEach((function(e){n.set([e>>24,e>>16&255,e>>8&255,255&e],s),s+=4})),e.box(e.types.stco,xe(new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i]),n))}},{key:"stss",value:function(t){var i=t.length,n=new Uint8Array(4*i),s=0;return t.forEach((function(e){n.set([e>>24,e>>16&255,e>>8&255,255&e],s),s+=4})),e.box(e.types.stss,xe(new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i]),n))}},{key:"ctts",value:function(t){var i=t.length,n=new Uint8Array(8*i),s=0;return t.forEach((function(e){var t=e.value,i=e.count;n.set([i>>24,i>>16&255,i>>8&255,255&i,t>>24,t>>16&255,t>>8&255,255&t],s),s+=8})),e.box(e.types.ctts,xe(new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i]),n))}},{key:"styp",value:function(){return e.box(e.types.styp,new Uint8Array([109,115,100,104,0,0,0,0,109,115,100,104,109,115,105,120]))}},{key:"sidx",value:function(t){var i=t.timescale,n=t.samples[0].duration,s=n*t.samples.length,a=t.samples[0].sampleOffset*n,r=8;t.samples.forEach((function(e){r+=e.size}));var l=0;if(t.isVideo){var o,d=0;t.videoSenc&&(o=t.videoSenc),t.isVideo&&o.forEach((function(e){d+=8,e.subsamples&&e.subsamples.length&&(d+=2,d+=6*e.subsamples.length)})),t.videoSencLength=d,l=r+141+16*t.samples.length+d,t.useEME&&t.isAudioEncryption&&!t.isVideoEncryption&&(l=r+16*t.samples.length+84)}else l=r+116+12*t.samples.length,t.useEME&&t.isAudioEncryption&&(l=r+169+12*t.samples.length+8*t.audioSenc.length);var c=new Uint8Array([0,0,0,0,0,0,0,255&t.id,i>>24&255,i>>16&255,i>>8&255,255&i,a>>24&255,a>>16&255,a>>8&255,255&a,0,0,0,0,0,0,0,1,0,l>>16&255,l>>8&255,255&l,s>>24&255,s>>16&255,s>>8&255,255&s,144,0,0,0]);return e.box(e.types.sidx,c)}},{key:"mdat",value:function(t){return e.box(e.types.mdat,t)}}]),e}();G(lt,"types",["Opus","dOps","av01","av1C","avc1","avcC","hvc1","hvcC","dinf","dref","esds","ftyp","hdlr","mdat","mdhd","mdia","mfhd","minf","moof","moov","mp4a","mvex","mvhd","pasp","stbl","stco","stsc","stsd","stsz","stts","tfdt","tfhd","traf","trak","trex","tkhd","vmhd","smhd","ctts","stss","styp","pssh","sidx","sbgp","saiz","saio","senc","trun","encv","enca","sinf","btrt","frma","tenc","schm","schi","mehd","fiel","sdtp"].reduce((function(e,t){return e[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)],e}),Object.create(null))),G(lt,"HDLR_TYPES",{video:new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),audio:new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0])}),G(lt,"FTYPAVC1",lt.box(lt.types.ftyp,new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]))),G(lt,"FTYPHEV1",lt.box(lt.types.ftyp,new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,104,101,118,49]))),G(lt,"DINF",lt.box(lt.types.dinf,lt.box(lt.types.dref,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1])))),G(lt,"VMHD",lt.box(lt.types.vmhd,new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]))),G(lt,"SMHD",lt.box(lt.types.smhd,new Uint8Array([0,0,0,0,0,0,0,0]))),G(lt,"StblTable",new Uint8Array([0,0,0,0,0,0,0,0])),G(lt,"STTS",lt.box(lt.types.stts,lt.StblTable)),G(lt,"STSC",lt.box(lt.types.stsc,lt.StblTable)),G(lt,"STSZ",lt.box(lt.types.stsz,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]))),G(lt,"STCO",lt.box(lt.types.stco,lt.StblTable));var ot=function(){function e(t,i){X(this,e),this.name=t||"",this._prefix="[".concat(this.name,"]"),e.disabled=i}return W(e,[{key:"debug",value:function(){var t;if(!e.disabled){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];(t=console).debug.apply(t,[this._prefix].concat(n))}}},{key:"log",value:function(){var t;if(!e.disabled){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];(t=console).log.apply(t,[this._prefix].concat(n))}}},{key:"warn",value:function(){var t;if(!e.disabled){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];(t=console).warn.apply(t,[this._prefix].concat(n))}}},{key:"error",value:function(){var t;if(!e.disabled){for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];(t=console).error.apply(t,[this._prefix].concat(n))}}},{key:"table",value:function(){var t;e.disabled||(console.group(this._prefix),(t=console).table.apply(t,arguments),console.groupEnd())}}],[{key:"enable",value:function(){e.disabled=!1}},{key:"disable",value:function(){e.disabled=!0}}]),e}();G(ot,"disabled",!0);for(var dt=function(){function e(t,i,n){X(this,e),this.videoTrack=t,this.audioTrack=i;var s=/Chrome\/([^.]+)/.exec(navigator.userAgent);this.forceFirstIDR=s&&Number(s[1])<50,this.log=new ot("FMP4Remuxer",!n||!n.openLog||!n.openLog)}return W(e,[{key:"remux",value:function(){var e,t,i,n,s,a=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=this.videoTrack,o=this.audioTrack,d=l.exist(),c=o.exist(),u=[];return a&&(r&&r.initMerge?(d&&u.push(this.videoTrack),c&&u.push(this.audioTrack),i=lt.initSegment(u)):(d&&(e=lt.initSegment([this.videoTrack])),c&&(t=lt.initSegment([this.audioTrack])))),d&&l.hasSample()&&(n=this._remuxVideo()),c&&o.hasSample()&&(s=this._remuxAudio()),l.samples=[],o.samples=[],{initSegment:i,videoInitSegment:e,audioInitSegment:t,videoSegment:n,audioSegment:s}}},{key:"_remuxVideo",value:function(){var e=this.videoTrack;this.forceFirstIDR&&(e.samples[0].flag={dependsOn:2,isNonSyncSample:0});var t=e.samples,i=/av01/.test(e.codec),n=0;i?t.forEach((function(e){n+=e.data.byteLength})):t.forEach((function(e){n+=e.units.reduce((function(e,t){return e+t.byteLength}),0),n+=4*e.units.length}));var s=new Uint8Array(n);if(i)for(var a,r=0,l=t.length,o=0;r<l;r++)a=t[r],s.set(a.data,o),a.size=a.data.byteLength,o+=a.size;else for(var d,c=new DataView(s.buffer),u=function(e,i){i=t[m];var n=0;i.units.forEach((function(t){c.setUint32(e,t.byteLength),e+=4,s.set(t,e),e+=t.byteLength,n+=4+t.byteLength})),i.size=n,p=e,d=i},m=0,h=t.length,p=0;m<h;m++)u(p,d);var Z=lt.mdat(s);return xe(lt.moof([e]),Z)}},{key:"_remuxAudio",value:function(){var e=this.audioTrack,t=new Uint8Array(e.samples.reduce((function(e,t){return e+t.size}),0));e.samples.reduce((function(e,i){return t.set(i.data,e),e+i.size}),0);var i=lt.mdat(t);return xe(lt.moof([e]),i)}},{key:"reset",value:function(){this.videoTrack.reset(),this.audioTrack.reset()}}]),e}(),ct=function(){function e(){X(this,e)}return W(e,[{key:"mixIn",value:function(e){return Object.assign(this,e)}},{key:"clone",value:function(){var e=new this.constructor;return Object.assign(e,this),e}}],[{key:"create",value:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return V(this,t)}}]),e}(),ut=function(e){v(i,e);var t=w(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4*n.length;X(this,i),e=t.call(this);var a=n;if(a instanceof ArrayBuffer&&(a=new Uint8Array(a)),(a instanceof Int8Array||a instanceof Uint8ClampedArray||a instanceof Int16Array||a instanceof Uint16Array||a instanceof Int32Array||a instanceof Uint32Array||a instanceof Float32Array||a instanceof Float64Array)&&(a=new Uint8Array(a.buffer,a.byteOffset,a.byteLength)),a instanceof Uint8Array){for(var r=a.byteLength,l=[],o=0;o<r;o+=1)l[o>>>2]|=a[o]<<24-o%4*8;e.words=l,e.sigBytes=r}else e.words=n,e.sigBytes=s;return e}return W(i,[{key:"toString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:mt;return e.stringify(this)}},{key:"concat",value:function(e){var t=this.words,i=e.words,n=this.sigBytes,s=e.sigBytes;if(this.clamp(),n%4)for(var a=0;a<s;a+=1){var r=i[a>>>2]>>>24-a%4*8&255;t[n+a>>>2]|=r<<24-(n+a)%4*8}else for(var l=0;l<s;l+=4)t[n+l>>>2]=i[l>>>2];return this.sigBytes+=s,this}},{key:"clamp",value:function(){var e=this.words,t=this.sigBytes;e[t>>>2]&=4294967295<<32-t%4*8,e.length=Math.ceil(t/4)}},{key:"clone",value:function(){var e=K(x(i.prototype),"clone",this).call(this);return e.words=this.words.slice(0),e}}],[{key:"random",value:function(e){for(var t,n=[],s=function(e){var t=e,i=987654321,n=4294967295;return function(){var e=((i=36969*(65535&i)+(i>>16)&n)<<16)+(t=18e3*(65535&t)+(t>>16)&n)&n;return e/=4294967296,(e+=.5)*(Math.random()>.5?1:-1)}},a=0;a<e;a+=4){var r=s(4294967296*(t||Math.random()));t=987654071*r(),n.push(4294967296*r()|0)}return new i(n,e)}}]),i}(ct),mt={stringify:function(e){for(var t=e.words,i=e.sigBytes,n=[],s=0;s<i;s+=1){var a=t[s>>>2]>>>24-s%4*8&255;n.push((a>>>4).toString(16)),n.push((15&a).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,i=[],n=0;n<t;n+=2)i[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new ut(i,t/2)}},ht=function(e){for(var t=e.length,i=[],n=0;n<t;n+=1)i[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new ut(i,t)},pt=function(e){return ht(unescape(encodeURIComponent(e)))},Zt=function(e){v(i,e);var t=w(i);function i(){var e;return X(this,i),(e=t.call(this))._minBufferSize=0,e}return W(i,[{key:"reset",value:function(){this._data=new ut,this._nDataBytes=0}},{key:"_append",value:function(e){var t=e;"string"==typeof t&&(t=pt(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes}},{key:"_process",value:function(e){var t,i=this._data,n=this.blockSize,s=i.words,a=i.sigBytes,r=a/(4*n),l=(r=e?Math.ceil(r):Math.max((0|r)-this._minBufferSize,0))*n,o=Math.min(4*l,a);if(l){for(var d=0;d<l;d+=n)this._doProcessBlock(s,d);t=s.splice(0,l),i.sigBytes-=o}return new ut(t,o)}},{key:"clone",value:function(){var e=K(x(i.prototype),"clone",this).call(this);return e._data=this._data.clone(),e}}]),i}(ct),yt=function(e){v(i,e);var t=w(i);function i(e){var n;return X(this,i),(n=t.call(this)).blockSize=16,n.cfg=Object.assign(new ct,e),n.reset(),n}return W(i,[{key:"reset",value:function(){K(x(i.prototype),"reset",this).call(this),this._doReset()}},{key:"update",value:function(e){return this._append(e),this._process(),this}},{key:"finalize",value:function(e){return e&&this._append(e),this._doFinalize()}}],[{key:"_createHelper",value:function(e){return function(t,i){return new e(i).finalize(t)}}},{key:"_createHmacHelper",value:function(e){return function(t,i){return new bt(e,i).finalize(t)}}}]),i}(Zt),bt=function(e){v(i,e);var t=w(i);function i(e,n){var s;X(this,i),s=t.call(this);var a=new e;s._hasher=a;var r=n;"string"==typeof r&&(r=pt(r));var l=a.blockSize,o=4*l;r.sigBytes>o&&(r=a.finalize(n)),r.clamp();var d=r.clone();s._oKey=d;var c=r.clone();s._iKey=c;for(var u=d.words,m=c.words,h=0;h<l;h+=1)u[h]^=1549556828,m[h]^=909522486;return d.sigBytes=o,c.sigBytes=o,s.reset(),s}return W(i,[{key:"reset",value:function(){var e=this._hasher;e.reset(),e.update(this._iKey)}},{key:"update",value:function(e){return this._hasher.update(e),this}},{key:"finalize",value:function(e){var t=this._hasher,i=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(i))}}]),i}(ct),ft={stringify:function(e){var t=e.words,i=e.sigBytes,n=this._map;e.clamp();for(var s=[],a=0;a<i;a+=3)for(var r=(t[a>>>2]>>>24-a%4*8&255)<<16|(t[a+1>>>2]>>>24-(a+1)%4*8&255)<<8|t[a+2>>>2]>>>24-(a+2)%4*8&255,l=0;l<4&&a+.75*l<i;l+=1)s.push(n.charAt(r>>>6*(3-l)&63));var o=n.charAt(64);if(o)for(;s.length%4;)s.push(o);return s.join("")},parse:function(e){var t=e.length,i=this._map,n=this._reverseMap;if(!n){this._reverseMap=[],n=this._reverseMap;for(var s=0;s<i.length;s+=1)n[i.charCodeAt(s)]=s}var a=i.charAt(64);if(a){var r=e.indexOf(a);-1!==r&&(t=r)}return function(e,t,i){for(var n=[],s=0,a=0;a<t;a+=1)if(a%4){var r=i[e.charCodeAt(a-1)]<<a%4*2|i[e.charCodeAt(a)]>>>6-a%4*2;n[s>>>2]|=r<<24-s%4*8,s+=1}return ut.create(n,s)}(e,t,n)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},Xt=[],Lt=0;Lt<64;Lt+=1)Xt[Lt]=4294967296*Math.abs(Math.sin(Lt+1))|0;var Wt=function(e,t,i,n,s,a,r){var l=e+(t&i|~t&n)+s+r;return(l<<a|l>>>32-a)+t},Gt=function(e,t,i,n,s,a,r){var l=e+(t&n|i&~n)+s+r;return(l<<a|l>>>32-a)+t},vt=function(e,t,i,n,s,a,r){var l=e+(t^i^n)+s+r;return(l<<a|l>>>32-a)+t},xt=function(e,t,i,n,s,a,r){var l=e+(i^(t|~n))+s+r;return(l<<a|l>>>32-a)+t},St=function(e){v(i,e);var t=w(i);function i(){return X(this,i),t.apply(this,arguments)}return W(i,[{key:"_doReset",value:function(){this._hash=new ut([1732584193,4023233417,2562383102,271733878])}},{key:"_doProcessBlock",value:function(e,t){for(var i=e,n=0;n<16;n+=1){var s=t+n,a=e[s];i[s]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}var r=this._hash.words,l=i[t+0],o=i[t+1],d=i[t+2],c=i[t+3],u=i[t+4],m=i[t+5],h=i[t+6],p=i[t+7],Z=i[t+8],y=i[t+9],b=i[t+10],f=i[t+11],X=i[t+12],L=i[t+13],W=i[t+14],G=i[t+15],v=r[0],x=r[1],S=r[2],g=r[3];v=Wt(v,x,S,g,l,7,Xt[0]),g=Wt(g,v,x,S,o,12,Xt[1]),S=Wt(S,g,v,x,d,17,Xt[2]),x=Wt(x,S,g,v,c,22,Xt[3]),v=Wt(v,x,S,g,u,7,Xt[4]),g=Wt(g,v,x,S,m,12,Xt[5]),S=Wt(S,g,v,x,h,17,Xt[6]),x=Wt(x,S,g,v,p,22,Xt[7]),v=Wt(v,x,S,g,Z,7,Xt[8]),g=Wt(g,v,x,S,y,12,Xt[9]),S=Wt(S,g,v,x,b,17,Xt[10]),x=Wt(x,S,g,v,f,22,Xt[11]),v=Wt(v,x,S,g,X,7,Xt[12]),g=Wt(g,v,x,S,L,12,Xt[13]),S=Wt(S,g,v,x,W,17,Xt[14]),x=Wt(x,S,g,v,G,22,Xt[15]),v=Gt(v,x,S,g,o,5,Xt[16]),g=Gt(g,v,x,S,h,9,Xt[17]),S=Gt(S,g,v,x,f,14,Xt[18]),x=Gt(x,S,g,v,l,20,Xt[19]),v=Gt(v,x,S,g,m,5,Xt[20]),g=Gt(g,v,x,S,b,9,Xt[21]),S=Gt(S,g,v,x,G,14,Xt[22]),x=Gt(x,S,g,v,u,20,Xt[23]),v=Gt(v,x,S,g,y,5,Xt[24]),g=Gt(g,v,x,S,W,9,Xt[25]),S=Gt(S,g,v,x,c,14,Xt[26]),x=Gt(x,S,g,v,Z,20,Xt[27]),v=Gt(v,x,S,g,L,5,Xt[28]),g=Gt(g,v,x,S,d,9,Xt[29]),S=Gt(S,g,v,x,p,14,Xt[30]),x=Gt(x,S,g,v,X,20,Xt[31]),v=vt(v,x,S,g,m,4,Xt[32]),g=vt(g,v,x,S,Z,11,Xt[33]),S=vt(S,g,v,x,f,16,Xt[34]),x=vt(x,S,g,v,W,23,Xt[35]),v=vt(v,x,S,g,o,4,Xt[36]),g=vt(g,v,x,S,u,11,Xt[37]),S=vt(S,g,v,x,p,16,Xt[38]),x=vt(x,S,g,v,b,23,Xt[39]),v=vt(v,x,S,g,L,4,Xt[40]),g=vt(g,v,x,S,l,11,Xt[41]),S=vt(S,g,v,x,c,16,Xt[42]),x=vt(x,S,g,v,h,23,Xt[43]),v=vt(v,x,S,g,y,4,Xt[44]),g=vt(g,v,x,S,X,11,Xt[45]),S=vt(S,g,v,x,G,16,Xt[46]),x=vt(x,S,g,v,d,23,Xt[47]),v=xt(v,x,S,g,l,6,Xt[48]),g=xt(g,v,x,S,p,10,Xt[49]),S=xt(S,g,v,x,W,15,Xt[50]),x=xt(x,S,g,v,m,21,Xt[51]),v=xt(v,x,S,g,X,6,Xt[52]),g=xt(g,v,x,S,c,10,Xt[53]),S=xt(S,g,v,x,b,15,Xt[54]),x=xt(x,S,g,v,o,21,Xt[55]),v=xt(v,x,S,g,Z,6,Xt[56]),g=xt(g,v,x,S,G,10,Xt[57]),S=xt(S,g,v,x,h,15,Xt[58]),x=xt(x,S,g,v,L,21,Xt[59]),v=xt(v,x,S,g,u,6,Xt[60]),g=xt(g,v,x,S,f,10,Xt[61]),S=xt(S,g,v,x,d,15,Xt[62]),x=xt(x,S,g,v,y,21,Xt[63]),r[0]=r[0]+v|0,r[1]=r[1]+x|0,r[2]=r[2]+S|0,r[3]=r[3]+g|0}},{key:"_doFinalize",value:function(){var e=this._data,t=e.words,i=8*this._nDataBytes,n=8*e.sigBytes;t[n>>>5]|=128<<24-n%32;var s=Math.floor(i/4294967296),a=i;t[15+(n+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),t[14+(n+64>>>9<<4)]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),e.sigBytes=4*(t.length+1),this._process();for(var r=this._hash,l=r.words,o=0;o<4;o+=1){var d=l[o];l[o]=16711935&(d<<8|d>>>24)|4278255360&(d<<24|d>>>8)}return r}},{key:"clone",value:function(){var e=K(x(i.prototype),"clone",this).call(this);return e._hash=this._hash.clone(),e}}]),i}(yt);yt._createHelper(St),yt._createHmacHelper(St);var gt=function(e){v(i,e);var t=w(i);function i(e){var n;return X(this,i),(n=t.call(this)).cfg=Object.assign(new ct,{keySize:4,hasher:St,iterations:1},e),n}return W(i,[{key:"compute",value:function(e,t){for(var i,n=this.cfg,s=n.hasher.create(),a=ut.create(),r=a.words,l=n.keySize,o=n.iterations;r.length<l;){i&&s.update(i),i=s.update(e).finalize(t),s.reset();for(var d=1;d<o;d+=1)i=s.finalize(i),s.reset();a.concat(i)}return a.sigBytes=4*l,a}}]),i}(ct),Vt=function(e){v(i,e);var t=w(i);function i(e,n,s){var a;return X(this,i),(a=t.call(this)).cfg=Object.assign(new ct,s),a._xformMode=e,a._key=n,a.reset(),a}return W(i,[{key:"reset",value:function(){K(x(i.prototype),"reset",this).call(this),this._doReset()}},{key:"process",value:function(e){return this._append(e),this._process()}},{key:"finalize",value:function(e){return e&&this._append(e),this._doFinalize()}}],[{key:"createEncryptor",value:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)}},{key:"createDecryptor",value:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)}},{key:"_createHelper",value:function(e){var t=function(e){return"string"==typeof e?Ct:It};return{encrypt:function(i,n,s){return t(n).encrypt(e,i,n,s)},decrypt:function(i,n,s){return t(n).decrypt(e,i,n,s)}}}}]),i}(Zt);Vt._ENC_XFORM_MODE=1,Vt._DEC_XFORM_MODE=2,Vt.keySize=4,Vt.ivSize=4;var Yt=function(e){v(i,e);var t=w(i);function i(e,n){var s;return X(this,i),(s=t.call(this))._cipher=e,s._iv=n,s}return W(i,null,[{key:"createEncryptor",value:function(e,t){return this.Encryptor.create(e,t)}},{key:"createDecryptor",value:function(e,t){return this.Decryptor.create(e,t)}}]),i}(ct);function kt(e,t,i){var n,s=e,a=this._iv;a?(n=a,this._iv=void 0):n=this._prevBlock;for(var r=0;r<i;r+=1)s[t+r]^=n[r]}var Rt=function(e){v(i,e);var t=w(i);function i(){return X(this,i),t.apply(this,arguments)}return W(i)}(Yt);Rt.Encryptor=function(e){v(i,e);var t=w(i);function i(){return X(this,i),t.apply(this,arguments)}return W(i,[{key:"processBlock",value:function(e,t){var i=this._cipher,n=i.blockSize;kt.call(this,e,t,n),i.encryptBlock(e,t),this._prevBlock=e.slice(t,t+n)}}]),i}(Rt),Rt.Decryptor=function(e){v(i,e);var t=w(i);function i(){return X(this,i),t.apply(this,arguments)}return W(i,[{key:"processBlock",value:function(e,t){var i=this._cipher,n=i.blockSize,s=e.slice(t,t+n);i.decryptBlock(e,t),kt.call(this,e,t,n),this._prevBlock=s}}]),i}(Rt);var Tt={pad:function(e,t){for(var i=4*t,n=i-e.sigBytes%i,s=n<<24|n<<16|n<<8|n,a=[],r=0;r<n;r+=4)a.push(s);var l=ut.create(a,n);e.concat(l)},unpad:function(e){var t=e,i=255&t.words[t.sigBytes-1>>>2];t.sigBytes-=i}},wt=function(e){v(i,e);var t=w(i);function i(e,n,s){var a;return X(this,i),(a=t.call(this,e,n,Object.assign({mode:Rt,padding:Tt},s))).blockSize=4,a}return W(i,[{key:"reset",value:function(){var e;K(x(i.prototype),"reset",this).call(this);var t=this.cfg,n=t.iv,s=t.mode;this._xformMode===this.constructor._ENC_XFORM_MODE?e=s.createEncryptor:(e=s.createDecryptor,this._minBufferSize=1),this._mode=e.call(s,this,n&&n.words),this._mode.__creator=e}},{key:"_doProcessBlock",value:function(e,t){this._mode.processBlock(e,t)}},{key:"_doFinalize",value:function(){var e,t=this.cfg.padding;return this._xformMode===this.constructor._ENC_XFORM_MODE?(t.pad(this._data,this.blockSize),e=this._process(!0)):(e=this._process(!0),t.unpad(e)),e}}]),i}(Vt),Mt=function(e){v(i,e);var t=w(i);function i(e){var n;return X(this,i),(n=t.call(this)).mixIn(e),n}return W(i,[{key:"toString",value:function(e){return(e||this.formatter).stringify(this)}}]),i}(ct),Kt={stringify:function(e){var t=e.ciphertext,i=e.salt;return(i?ut.create([1398893684,1701076831]).concat(i).concat(t):t).toString(ft)},parse:function(e){var t,i=ft.parse(e),n=i.words;return 1398893684===n[0]&&1701076831===n[1]&&(t=ut.create(n.slice(2,4)),n.splice(0,4),i.sigBytes-=16),Mt.create({ciphertext:i,salt:t})}},It=function(e){v(i,e);var t=w(i);function i(){return X(this,i),t.apply(this,arguments)}return W(i,null,[{key:"encrypt",value:function(e,t,i,n){var s=Object.assign(new ct,this.cfg,n),a=e.createEncryptor(i,s),r=a.finalize(t),l=a.cfg;return Mt.create({ciphertext:r,key:i,iv:l.iv,algorithm:e,mode:l.mode,padding:l.padding,blockSize:a.blockSize,formatter:s.format})}},{key:"decrypt",value:function(e,t,i,n){var s=t,a=Object.assign(new ct,this.cfg,n);return s=this._parse(s,a.format),e.createDecryptor(i,a).finalize(s.ciphertext)}},{key:"_parse",value:function(e,t){return"string"==typeof e?t.parse(e,this):e}}]),i}(ct);It.cfg=Object.assign(new ct,{format:Kt});var Ht={execute:function(e,t,i,n){var s=n;s||(s=ut.random(8));var a=gt.create({keySize:t+i}).compute(e,s),r=ut.create(a.words.slice(t),4*i);return a.sigBytes=4*t,Mt.create({key:a,iv:r,salt:s})}},Ct=function(e){v(i,e);var t=w(i);function i(){return X(this,i),t.apply(this,arguments)}return W(i,null,[{key:"encrypt",value:function(e,t,i,n){var s=Object.assign(new ct,this.cfg,n),a=s.kdf.execute(i,e.keySize,e.ivSize);s.iv=a.iv;var r=It.encrypt.call(this,e,t,a.key,s);return r.mixIn(a),r}},{key:"decrypt",value:function(e,t,i,n){var s=t,a=Object.assign(new ct,this.cfg,n);s=this._parse(s,a.format);var r=a.kdf.execute(i,e.keySize,e.ivSize,s.salt);return a.iv=r.iv,It.decrypt.call(this,e,s,r.key,a)}}]),i}(It);Ct.cfg=Object.assign(It.cfg,{kdf:Ht});for(var Nt=[],Ft=[],zt=[],Ut=[],Jt=[],jt=[],Pt=[],Et=[],Dt=[],Bt=[],_t=[],Qt=0;Qt<256;Qt+=1)_t[Qt]=Qt<128?Qt<<1:Qt<<1^283;for(var Ot=0,At=0,qt=0;qt<256;qt+=1){var $t=At^At<<1^At<<2^At<<3^At<<4;$t=$t>>>8^255&$t^99,Nt[Ot]=$t,Ft[$t]=Ot;var ei=_t[Ot],ti=_t[ei],ii=_t[ti],ni=257*_t[$t]^16843008*$t;zt[Ot]=ni<<24|ni>>>8,Ut[Ot]=ni<<16|ni>>>16,Jt[Ot]=ni<<8|ni>>>24,jt[Ot]=ni,ni=16843009*ii^65537*ti^257*ei^16843008*Ot,Pt[$t]=ni<<24|ni>>>8,Et[$t]=ni<<16|ni>>>16,Dt[$t]=ni<<8|ni>>>24,Bt[$t]=ni,Ot?(Ot=ei^_t[_t[_t[ii^ei]]],At^=_t[_t[At]]):Ot=At=1}var si=[0,1,2,4,8,16,32,64,128,27,54],ai=function(e){v(i,e);var t=w(i);function i(){return X(this,i),t.apply(this,arguments)}return W(i,[{key:"_doReset",value:function(){var e;if(!this._nRounds||this._keyPriorReset!==this._key){this._keyPriorReset=this._key;var t=this._keyPriorReset,i=t.words,n=t.sigBytes/4;this._nRounds=n+6;var s=4*(this._nRounds+1);this._keySchedule=[];for(var a=this._keySchedule,r=0;r<s;r+=1)r<n?a[r]=i[r]:(e=a[r-1],r%n?n>6&&r%n==4&&(e=Nt[e>>>24]<<24|Nt[e>>>16&255]<<16|Nt[e>>>8&255]<<8|Nt[255&e]):(e=Nt[(e=e<<8|e>>>24)>>>24]<<24|Nt[e>>>16&255]<<16|Nt[e>>>8&255]<<8|Nt[255&e],e^=si[r/n|0]<<24),a[r]=a[r-n]^e);this._invKeySchedule=[];for(var l=this._invKeySchedule,o=0;o<s;o+=1){var d=s-o;e=o%4?a[d]:a[d-4],l[o]=o<4||d<=4?e:Pt[Nt[e>>>24]]^Et[Nt[e>>>16&255]]^Dt[Nt[e>>>8&255]]^Bt[Nt[255&e]]}}}},{key:"encryptBlock",value:function(e,t){this._doCryptBlock(e,t,this._keySchedule,zt,Ut,Jt,jt,Nt)}},{key:"decryptBlock",value:function(e,t){var i=e,n=i[t+1];i[t+1]=i[t+3],i[t+3]=n,this._doCryptBlock(i,t,this._invKeySchedule,Pt,Et,Dt,Bt,Ft),n=i[t+1],i[t+1]=i[t+3],i[t+3]=n}},{key:"_doCryptBlock",value:function(e,t,i,n,s,a,r,l){for(var o=e,d=this._nRounds,c=o[t]^i[0],u=o[t+1]^i[1],m=o[t+2]^i[2],h=o[t+3]^i[3],p=4,Z=1;Z<d;Z+=1){var y=n[c>>>24]^s[u>>>16&255]^a[m>>>8&255]^r[255&h]^i[p];p+=1;var b=n[u>>>24]^s[m>>>16&255]^a[h>>>8&255]^r[255&c]^i[p];p+=1;var f=n[m>>>24]^s[h>>>16&255]^a[c>>>8&255]^r[255&u]^i[p];p+=1;var X=n[h>>>24]^s[c>>>16&255]^a[u>>>8&255]^r[255&m]^i[p];p+=1,c=y,u=b,m=f,h=X}var L=(l[c>>>24]<<24|l[u>>>16&255]<<16|l[m>>>8&255]<<8|l[255&h])^i[p];p+=1;var W=(l[u>>>24]<<24|l[m>>>16&255]<<16|l[h>>>8&255]<<8|l[255&c])^i[p];p+=1;var G=(l[m>>>24]<<24|l[h>>>16&255]<<16|l[c>>>8&255]<<8|l[255&u])^i[p];p+=1;var v=(l[h>>>24]<<24|l[c>>>16&255]<<16|l[u>>>8&255]<<8|l[255&m])^i[p];p+=1,o[t]=L,o[t+1]=W,o[t+2]=G,o[t+3]=v}}]),i}(wt);ai.keySize=8;var ri=wt._createHelper(ai),li=function(e){v(i,e);var t=w(i);function i(){return X(this,i),t.apply(this,arguments)}return W(i)}(Yt);li.Encryptor=function(e){v(i,e);var t=w(i);function i(){return X(this,i),t.apply(this,arguments)}return W(i,[{key:"processBlock",value:function(e,t){var i=e,n=this._cipher,s=n.blockSize,a=this._iv,r=this._counter;a&&(this._counter=a.slice(0),r=this._counter,this._iv=void 0);var l=r.slice(0);n.encryptBlock(l,0),r[s-1]=r[s-1]+1|0;for(var o=0;o<s;o+=1)i[t+o]^=l[o]}}]),i}(li),li.Decryptor=li.Encryptor;var oi,di={pad:function(){},unpad:function(){}},ci={decryptWordArray:function(e,t,i){var n=mt.parse(t),s=mt.parse(Re(i)),a=ut.create(new Uint8Array(e)),r=ri.decrypt(Mt.create({ciphertext:a}),n,{iv:s,mode:li,padding:di});return ci.wordArrayToUint8Array(r)},wordArrayToUint8Array:function(e){for(var t=e.sigBytes,i=e.words,n=new Uint8Array(t),s=0,a=0;s!==t;){var r=i[a++];if(n[s++]=(4278190080&r)>>>24,s===t)break;if(n[s++]=(16711680&r)>>>16,s===t)break;if(n[s++]=(65280&r)>>>8,s===t)break;n[s++]=255&r}return n},decoderAESCTRData:function(e,t,i){if(e.videoSenc){var n=e.kidValue,s=e.videoSenc;e.samples.forEach((function(t,a){var r=s[a],l=t.data,o=[],d=[],c=r.InitializationVector;if(r.subsamples&&r.subsamples.length)r.subsamples.forEach((function(e){var t=e.BytesOfClearData+e.BytesOfProtectedData,i=l.slice(0,t);o.push(i.slice(0,e.BytesOfClearData)),d.push(i.slice(e.BytesOfClearData)),l=l.slice(t)}));else{var u=t.size;o.push(l.slice(0,0)),d.push(l.slice(0,u)),l=l.slice(u)}var m=new at;m.write.apply(m,d);var h=i?i(m.buffer,n,c):ci.decryptWordArray(m.buffer,n,c),p=new at;o.forEach((function(e,t){var i=d[t].length,n=h.slice(0,i);p.write(e),p.write(n),h=h.slice(i)})),e.samples[a].data=p.buffer}))}if(t.audioSenc){var a=t.kidValue,r=t.audioSenc;t.samples.forEach((function(e,n){var s=r[n],l=i?i(e.data,a,s.InitializationVector):ci.decryptWordArray(e.data,a,s.InitializationVector);t.samples[n].data=l}))}}},ui=function(){function e(t,i,n,s){var a=this;X(this,e),G(this,"_videoSamples",[]),G(this,"_audioSamples",[]),G(this,"_lastRemainBuffer",[]),G(this,"_lastRemainBufferStartPos",0),this.videoTrack=new oe,this.audioTrack=new de,this.metadataTrack=n||new Ze,this.log=new ot("MP4Demuxer",!s||!s.openLog||!s.openLog),t&&t.forEach((function(e){var t;(t=a._videoSamples).push.apply(t,H(e.frames))})),i&&i.forEach((function(e){var t;(t=a._audioSamples).push.apply(t,H(e.frames))}))}return W(e,[{key:"parseSamples",value:function(e){if(!e)throw new Error("moov is required");if(this.videoTrack.codec||this.audioTrack.codec||(Oe.moovToTrack(e,this.videoTrack,this.audioTrack),this.videoSenc=this.videoTrack.videoSenc,this.audioSenc=this.audioTrack.audioSenc),!this._audioSamples.length&&!this._videoSamples.length){var t=Oe.moovToSamples(e);if(!t)throw new Error("cannot parse samples from moov box");this._videoSamples=t.videoSamples||[],this._audioSamples=t.audioSamples||[]}}},{key:"demux",value:function(e,t,i,n,s){this.parseSamples(s);var a,r,l,o=this.videoTrack,d=this.audioTrack;if(o.samples=[],d.samples=[],i){for(var c,u=0,m=i[0],h=i[1];m<=h;m++){if(!(a=this._videoSamples[m]))throw new Error("cannot found video frame #".concat(m));l=a.offset-t,r=e.subarray(l,l+a.size),(c=new ce(a.pts||a.dts,a.dts)).duration=a.duration,c.gopId=a.gopId,a.keyframe&&c.setToKeyframe();for(var p=0,Z=r.length-1;p<Z;)u=Ve(r,p),p+=4,c.units.push(r.subarray(p,p+u)),p+=u;o.samples.push(c)}o.baseMediaDecodeTime=o.samples[0].dts}if(n){for(var y=n[0],b=n[1];y<=b;y++){if(!(a=this._audioSamples[y]))throw new Error("cannot found video frame #".concat(y));l=a.offset-t,r=e.subarray(l,l+a.size),d.samples.push(new ue(a.dts,r,a.duration))}d.baseMediaDecodeTime=d.samples[0].dts}return{videoTrack:o,audioTrack:d,metadataTrack:this.metadataTrack}}},{key:"demuxPart",value:function(e,t,i,n,s,a,r,l){if(this.parseSamples(s),this.videoTrack.useEME=a,this.audioTrack.useEME=a,this._lastRemainBuffer&&this._lastRemainBuffer.byteLength>0&&t>this._lastRemainBufferStartPos&&t<=this._lastRemainBufferStartPos+this._lastRemainBuffer.byteLength)for(var o=0;o<20;)try{var d=this._lastRemainBuffer.subarray(0,t-this._lastRemainBufferStartPos),c=new Uint8Array(e.byteLength+d.byteLength);c.set(d,0),c.set(new Uint8Array(e),d.byteLength),e=c,t-=d.byteLength,this._lastRemainBuffer=null,this._lastRemainBufferStartPos=0;break}catch(V){if(!(o<20))throw new Error("new Uint8Array error:,"+V.errorMessage);o++}var u,m,h,p=this.videoTrack,Z=this.audioTrack;p.samples=[],Z.samples=[],p.videoSenc=null,Z.audioSenc=null;var y=0,b=0;if(this._videoSamples.length>0&&i.length>0){for(var f,X=e.byteLength+t,L=i[0];L<=i[1];L++){if(!(u=this._videoSamples[L]))throw new Error("cannot found video frame #".concat(L));u.offset>=t&&u.offset+u.size<=X&&(y=(h=u.offset-t)+u.size,m=e.subarray(h,y),(f=new ce(u.pts||u.dts,u.dts)).duration=u.duration,f.gopId=u.gopId,f.sampleOffset=u.index,u.keyframe&&f.setToKeyframe(),f.data=m,f.size=u.size,p.samples.push(f))}p.samples.length>0&&(p.gopId=p.samples[0].gopId,p.baseMediaDecodeTime=p.samples[0].dts,p.startPts=p.samples[0].pts/p.timescale,p.endPts=p.samples[p.samples.length-1].pts/p.timescale,this.videoSenc&&(p.videoSenc=this.videoSenc.slice(p.samples[0].sampleOffset,p.samples[0].sampleOffset+p.samples.length),p.kidValue=r))}if(this._audioSamples.length>0&&n.length>0){for(var W=n[0];W<=n[1];W++){if(!(u=this._audioSamples[W]))throw new Error("cannot found video frame #".concat(W));u.offset>=t&&u.offset+u.size<=e.byteLength+t&&(b=(h=u.offset-t)+u.size,m=e.subarray(h,b),Z.samples.push(new ue(u.dts,m,u.duration,u.index)))}Z.samples.length>0&&(Z.gopId=Z.samples[0].gopId||p.gopId,Z.baseMediaDecodeTime=Z.samples[0].dts,Z.startPts=Z.samples[0].pts/Z.timescale,Z.endPts=Z.samples[Z.samples.length-1].pts/Z.timescale,this.audioSenc&&(Z.audioSenc=this.audioSenc.slice(Z.samples[0].sampleOffset,Z.samples[0].sampleOffset+Z.samples.length),Z.kidValue=r))}this.decoderData(p,Z,l);for(var G=0,v=0;v<p.samples.length;v++)for(var x=0,S=p.samples[v].data,g=S.length-1;x<g;)G=Ve(S,x),x+=4,p.samples[v].units.push(S.subarray(x,x+G)),x+=G;return this._lastRemainBuffer=e.subarray(Math.max(y,b)),this._lastRemainBuffer.byteLength>0?this._lastRemainBufferStartPos=t+e.byteLength-this._lastRemainBuffer.byteLength:this._lastRemainBufferStartPos=0,{videoTrack:p,audioTrack:Z,metadataTrack:this.metadataTrack}}},{key:"reset",value:function(){this._videoSamples=[],this._audioSamples=[],this._lastRemainBuffer=null,this._lastRemainBufferStartPos=0,this.videoTrack.reset(),this.audioTrack.reset(),this.metadataTrack.reset()}},{key:"decoderData",value:function(e,t,i){e.useEME||t.useEME||ci.decoderAESCTRData(e,t,i)}}],[{key:"probe",value:function(e){return Oe.probe(e)}}]),e}(),mi="3.0.20",hi=function(){function e(){X(this,e)}return W(e,null,[{key:"start",value:function(e){return e&&e.length?1===e.length&&e.end(0)-e.start(0)<1e-6||1===e.length&&e.start(0)<0?0:e.start(0):0}},{key:"end",value:function(e){return e&&e.length?1===e.length&&e.end(0)-e.start(0)<1e-6?0:e.end(e.length-1):0}},{key:"get",value:function(e){if(e)try{return e.buffered}catch(t){}}},{key:"buffers",value:function(e,t){if(!e||!e.length)return[];for(var i=[],n=0,s=e.length;n<s;n++){var a=i.length;if(a&&t){var r=i[a-1],l=r[1];if(e.start(n)-l<=t){var o=e.end(n);o>l&&(r[1]=o)}else i.push([e.start(n),e.end(n)])}else i.push([e.start(n),e.end(n)])}return i}},{key:"totalLength",value:function(e){return e&&e.length?e.reduce((function(e,t){return e+(t[1]-t[0])}),0):0}},{key:"info",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!t||!t.length)return{start:0,end:0,buffers:[]};for(var s=0,a=0,r=0,l=0,o=0,d=0,c=0,u=e.buffers(t,n),m=0,h=u.length;m<h;m++){var p=u[m];if(i+n>=p[0]&&i<=p[1])s=p[0],a=p[1],r=m;else{if(i+n<p[0]){l=p[0],o=p[1];break}i+n>p[1]&&(d=p[0],c=p[1])}}return{start:s,end:a,index:r,buffers:u,nextStart:l,nextEnd:o,prevStart:d,prevEnd:c,currentTime:i,behind:i-s,remaining:a?a-i:0,length:e.totalLength&&e.totalLength(u)}}},{key:"isBuffered",value:function(t,i){if(t){var n=e.get(t);if(null!=n&&n.length)for(var s=0;s<n.length;s++)if(i>=n.start(s)&&i<=n.end(s))return!0}return!1}}]),e}(),pi="undefined"!=typeof window,Zi={MANIFEST:"manifest",NETWORK:"network",NETWORK_TIMEOUT:"network_timeout",NETWORK_FORBIDDEN:"network_forbidden",NETWORK_NOTFOUND:"network_notfound",NETWROK_RANGE_NOT_SATISFIABLE:"network_range_not_satisfiable",DEMUX:"demux",REMUX:"remux",MEDIA:"media",DRM:"drm",OTHER:"other",RUNTIME:"runtime",SUB_TYPES:{FLV:"FLV",HLS:"HLS",MP4:"MP4",FMP4:"FMP4",MSE_ADD_SB:"MSE_ADD_SB",MSE_APPEND_BUFFER:"MSE_APPEND_BUFFER",MSE_OTHER:"MSE_OTHER",MSE_FULL:"MSE_FULL",MSE_CHANGE_TYPE:"MSE_CHANGE_TYPE",OPTION:"OPTION",DASH:"DASH",LICENSE:"LICENSE",CUSTOM_LICENSE:"CUSTOM_LICENSE",MSE_HIJACK:"MSE_HIJACK",EME_HIJACK:"EME_HIJACK",SIDX:"SIDX",NO_CANPLAY_ERROR:"NO_CANPLAY_ERROR",BUFFERBREAK_ERROR:"BUFFERBREAK_ERROR",WAITING_TIMEOUT_ERROR:"WAITING_TIMEOUT_ERROR",MEDIA_ERR_ABORTED:"MEDIA_ERR_ABORTED",MEDIA_ERR_NETWORK:"MEDIA_ERR_NETWORK",MEDIA_ERR_DECODE:"MEDIA_ERR_DECODE",MEDIA_ERR_SRC_NOT_SUPPORTED:"MEDIA_ERR_SRC_NOT_SUPPORTED",MEDIA_ERR_CODEC_NOT_SUPPORTED:"MEDIA_ERR_CODEC_NOT_SUPPORTED",MEDIA_ERR_URL_EMPTY:"MEDIA_ERR_URL_EMPTY"}},yi=(G(oi={},Zi.MANIFEST,{HLS:1100,DASH:1200}),G(oi,Zi.NETWORK,2100),G(oi,Zi.NETWORK_TIMEOUT,2101),G(oi,Zi.NETWORK_FORBIDDEN,2103),G(oi,Zi.NETWORK_NOTFOUND,2104),G(oi,Zi.NETWROK_RANGE_NOT_SATISFIABLE,2116),G(oi,Zi.DEMUX,{FLV:3100,HLS:3200,MP4:3300,FMP4:3400,SIDX:3410}),G(oi,Zi.REMUX,{FMP4:4100,MP4:4200}),G(oi,Zi.MEDIA,{MEDIA_ERR_ABORTED:5101,MEDIA_ERR_NETWORK:5102,MEDIA_ERR_DECODE:5103,MEDIA_ERR_SRC_NOT_SUPPORTED:5104,MEDIA_ERR_CODEC_NOT_SUPPORTED:5105,MEDIA_ERR_URL_EMPTY:5106,MSE_ADD_SB:5200,MSE_APPEND_BUFFER:5201,MSE_OTHER:5202,MSE_FULL:5203,MSE_HIJACK:5204,MSE_CHANGE_TYPE:5205,EME_HIJACK:5301}),G(oi,Zi.DRM,{LICENSE:7100,CUSTOM_LICENSE:7200}),G(oi,Zi.OTHER,8e3),G(oi,Zi.RUNTIME,{NO_CANPLAY_ERROR:9001,BUFFERBREAK_ERROR:9002,WAITING_TIMEOUT_ERROR:9003}),oi),bi=function(e){v(i,e);var t=w(i);function i(e,n,s,a,r){var l;return X(this,i),(l=t.call(this,r||(null==s?void 0:s.message))).errorType=e===Zi.NETWORK_TIMEOUT?Zi.NETWORK:e,l.originError=s,l.ext=a,l.errorCode=yi[e][n]||yi[e],l.errorMessage=l.message,l.errorCode||(l.errorType=Zi.OTHER,l.errorCode=yi[l.errorType]),l}return W(i,null,[{key:"create",value:function(e,t,n,s,a){return e instanceof i?e:(e instanceof Error&&(n=e,e=""),e||(e=Zi.OTHER),new i(e,t,n,s,a))}},{key:"network",value:function(e){var t;return new i(null!=e&&e.isTimeout?Zi.NETWORK_TIMEOUT:Zi.NETWORK,null,e instanceof Error?e:null,{url:null==e?void 0:e.url,response:null==e?void 0:e.response,httpCode:null==e||null===(t=e.response)||void 0===t?void 0:t.status})}}]),i}(Y(Error)),fi={DEBUG:1,LOG:2,WARN:3,ERROR:4},Xi=["Boolean","Number","String","Undefined","Null","Date","Object"],Li=function(){function e(t,i){X(this,e),this.name=t||"",this._prefix="[".concat(this.name,"]"),this.logCacheLevel=(null==i?void 0:i.logCacheLevel)||3,this.logMaxSize=(null==i?void 0:i.logMaxSize)||204800,this.logSize=0,this.logTextArray=[]}return W(e,[{key:"debug",value:function(){for(var t,i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];this.logCache.apply(this,[fi.DEBUG].concat(n)),e.disabled||(t=console).debug.apply(t,["[".concat(Wi(),"]"),this._prefix].concat(n))}},{key:"log",value:function(){for(var t,i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];this.logCache.apply(this,[fi.LOG].concat(n)),e.disabled||(t=console).log.apply(t,["[".concat(Wi(),"]"),this._prefix].concat(n))}},{key:"warn",value:function(){for(var t,i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];this.logCache.apply(this,[fi.WARN].concat(n)),e.disabled||(t=console).warn.apply(t,["[".concat(Wi(),"]"),this._prefix].concat(n))}},{key:"error",value:function(){for(var t,i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];this.logCache.apply(this,[fi.ERROR].concat(n)),e.disabled||(t=console).error.apply(t,["[".concat(Wi(),"]"),this._prefix].concat(n))}},{key:"logCache",value:function(e){if(!(e<this.logCacheLevel)){var t="";try{for(var i=arguments.length,n=new Array(i>1?i-1:0),s=1;s<i;s++)n[s-1]=arguments[s];var a=n.map((function(e){return vi(e)}));t="[".concat(Wi(),"]")+this._prefix+JSON.stringify(a)}catch(l){return}if(e>=this.logCacheLevel&&(this.logSize+=t.length,this.logTextArray.push(t)),this.logSize>this.logMaxSize){var r=this.logTextArray.shift();this.logSize-=r.length}}}},{key:"getLogCache",value:function(){var e=this.logTextArray.join("\n");return this.reset(),e}},{key:"reset",value:function(){this.logTextArray=[],this.logSize=0}},{key:"table",value:function(){var t;e.disabled||(console.group(this._prefix),(t=console).table.apply(t,arguments),console.groupEnd())}},{key:"setLogLevel",value:function(e){this.logCacheLevel=e}}],[{key:"enable",value:function(){e.disabled=!1}},{key:"disable",value:function(){e.disabled=!0}}]),e}();function Wi(){return(new Date).toLocaleString()}function Gi(e){if("object"!==y(e))return e;var t=Object.prototype.toString.call(e).slice(8,-1);switch(t){case"Array":case"Uint8Array":case"ArrayBuffer":return t+"["+e.length+"]";case"Object":return"{}";default:return t}}function vi(e,t,i){i||(i=1),t||(t=2);var n={};if(!e||"object"!==y(e))return e;var s=Object.prototype.toString.call(e).slice(8,-1);if(!Xi.includes(s))return s;if(!(i>t)){for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(i===t?n[a]=Gi(e[a]):"object"===y(e[a])?n[a]=vi(e[a],t,i+1):n[a]=e[a]);return n}}function xi(){var e,t,i=new Promise((function(i,n){e=i,t=n}));return i.used=!1,i.resolve=function(){return i.used=!0,e.apply(void 0,arguments)},i.reject=function(){return i.used=!0,t.apply(void 0,arguments)},i}function Si(){try{return parseInt(performance.now(),10)}catch(e){return(new Date).getTime()}}G(Li,"disabled",!0);var gi=function(e){try{return JSON.stringify(e)}catch(t){return""}};function Vi(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];try{return pi?e&&"undefined"!=typeof ManagedMediaSource?ManagedMediaSource:window.MediaSource:null}catch(t){}}function Yi(e){return/ManagedMediaSource/gi.test(Object.prototype.toString.call(e))}var ki="appendBuffer",Ri="removeBuffer",Ti="updateDuration",wi=function(){function e(t,i){var n=this;X(this,e),G(this,"media",null),G(this,"mediaSource",null),G(this,"_openPromise",xi()),G(this,"_queue",Object.create(null)),G(this,"_sourceBuffer",Object.create(null)),G(this,"_mseFullFlag",{}),G(this,"_st",0),G(this,"_opst",0),G(this,"_logger",null),G(this,"_config",null),G(this,"_url",null),G(this,"_onStartStreaming",(function(){n._logger.debug("startstreaming")})),G(this,"_onEndStreaming",(function(){n._logger.debug("endstreaming")})),G(this,"_onSBUpdateEnd",(function(e){var t=n._queue[e];if(t){var i=t[0];if((null==i?void 0:i.opName)!==Ti&&t.shift(),i){var s,a,r=Si()-n._opst;n._logger.debug("UpdateEnd(".concat(e,"/").concat(i.opName,")"),gi(function(e){var t=[];if(e instanceof TimeRanges)for(var i=0;i<e.length;i++)t.push({start:e.start(i),end:e.end(i)});return t}(null===(s=n._sourceBuffer[e])||void 0===s?void 0:s.buffered)),r,i.context),i.promise.resolve({name:i.opName,context:i.context,costtime:r});var l=null===(a=i.context)||void 0===a?void 0:a.callback;l&&"function"==typeof l&&l(i.context),n._startQueue(e)}}})),G(this,"_onSBUpdateError",(function(e,t){var i=n._queue[e];if(i){var s=i[0];s&&(n._logger.error("UpdateError",e,s.opName,s.context),s.promise.reject(new bi(Zi.MEDIA,Zi.SUB_TYPES.MSE_APPEND_BUFFER,t)))}})),this._config=Object.assign(e.getDefaultConfig(),i),t&&this.bindMedia(t),this._logger=new Li("MSE"),this._config.openLog&&Li.enable()}var t,i,n;return W(e,[{key:"isOpened",get:function(){var e;return"open"===(null===(e=this.mediaSource)||void 0===e?void 0:e.readyState)}},{key:"hasOpTasks",get:function(){var e=this,t=!1;return Object.keys(this._queue).forEach((function(i){var n=e._queue[i];Array.isArray(n)&&(t||(t=n.length>0))})),t}},{key:"url",get:function(){return this._url}},{key:"duration",get:function(){var e;return(null===(e=this.mediaSource)||void 0===e?void 0:e.duration)||-1}},{key:"isEnded",get:function(){return!!this.mediaSource&&"ended"===this.mediaSource.readyState}},{key:"streaming",get:function(){return!Yi(this.mediaSource)||this.mediaSource.streaming}},{key:"isFull",value:function(t){return t?this._mseFullFlag[t]:this._mseFullFlag[e.VIDEO]}},{key:"updateDuration",value:function(e){var t=this,i=this.mediaSource&&this.mediaSource.duration>e;if(this.mediaSource&&this.mediaSource.duration>e){var n=0;if(Object.keys(this._sourceBuffer).forEach((function(e){try{n=Math.max(t.bufferEnd(e)||0,n)}catch(i){}})),e<n)return Promise.resolve()}return this._enqueueBlockingOp((function(){t.isEnded?t._logger.debug("setDuration but ended"):t.mediaSource&&(t.mediaSource.duration=e,t._logger.debug("setDuration",e))}),Ti,{isReduceDuration:i})}},{key:"open",value:function(){var e=this;if(this._openPromise.used&&!this.isOpened&&this.mediaSource){var t=this.mediaSource;t.addEventListener("sourceopen",(function i(){var n=Si()-e._st;e._logger.debug("sourceopen",n),t.removeEventListener("sourceopen",i),e._openPromise.resolve({costtime:n})})),this._openPromise=xi()}return this._openPromise}},{key:"bindMedia",value:(n=f(Z().mark((function e(t){var i,n,s,a,r=this;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.mediaSource&&!this.media){e.next=3;break}return e.next=3,this.unbindMedia();case 3:if(i=Vi(this._config.preferMMS),t&&i){e.next=6;break}throw new Error("Param media or MediaSource does not exist");case 6:return this.media=t,n=this.mediaSource=new i,s=Yi(n),this._st=Si(),a=function e(){var i=Si()-r._st;r._logger.debug("sourceopen"),n.removeEventListener("sourceopen",e),URL.revokeObjectURL(t.src),r._openPromise.resolve({costtime:i})},n.addEventListener("sourceopen",a),s&&(n.addEventListener("startstreaming",this._onStartStreaming),n.addEventListener("endstreaming",this._onEndStreaming)),this._url=URL.createObjectURL(n),t.src=this._url,t.disableRemotePlayback=s,e.abrupt("return",this._openPromise);case 17:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"unbindMedia",value:(i=f(Z().mark((function e(){var t,i,n,s=this;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._openPromise.used||this._openPromise.resolve(),t=this.mediaSource){if(Object.keys(this._queue).forEach((function(e){var t=s._queue[e];t&&t.forEach((function(e){var t,i;return null===(t=e.promise)||void 0===t||null===(i=t.resolve)||void 0===i?void 0:i.call(t)}))})),i=!!this.media&&this.media.readyState>=1,n="open"===t.readyState,i&&n)try{t.endOfStream()}catch(a){}Object.keys(this._sourceBuffer).forEach((function(e){try{t.removeSourceBuffer(s._sourceBuffer[e])}catch(a){}})),Yi(t)&&(t.removeEventListener("startstreaming",this._onStartStreaming),t.removeEventListener("endstreaming",this._onEndStreaming))}if(this.media){this.media.disableRemotePlayback=!1,this.media.removeAttribute("src");try{this.media.load()}catch(a){}this.media=null}this.mediaSource=null,this._openPromise=xi(),this._queue=Object.create(null),this._sourceBuffer=Object.create(null);case 8:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"createSource",value:function(e,t){if(!this._sourceBuffer[e]&&this.mediaSource){var i;try{i=this._sourceBuffer[e]=this.mediaSource.addSourceBuffer(t)}catch(n){throw new bi(Zi.MEDIA,Zi.SUB_TYPES.MSE_ADD_SB,n)}i.mimeType=t,i.addEventListener("updateend",this._onSBUpdateEnd.bind(this,e)),i.addEventListener("error",this._onSBUpdateError.bind(this,e))}}},{key:"changeType",value:function(e,t){var i=this,n=this._sourceBuffer[e];return this.mediaSource&&n&&n.mimeType!==t?"function"!=typeof n.changeType?Promise.reject(new bi(Zi.MEDIA,Zi.SUB_TYPES.MSE_CHANGE_TYPE,new Error("changeType is not a function"))):this._enqueueOp(e,(function(){try{n.changeType(t)}catch(s){throw new bi(Zi.MEDIA,Zi.SUB_TYPES.MSE_CHANGE_TYPE,s)}n.mimeType=t,i._onSBUpdateEnd(e)}),"changeType",{mimeType:t}):Promise.resolve()}},{key:"createOrChangeSource",value:function(e,t){return this.createSource(e,t),this.changeType(e,t)}},{key:"append",value:function(e,t,i){var n=this;return t&&t.byteLength&&this._sourceBuffer[e]?this._enqueueOp(e,(function(){var s;n.mediaSource&&!n.media.error&&(n._logger.debug("MSE APPEND START",i),n._opst=Si(),null===(s=n._sourceBuffer[e])||void 0===s||s.appendBuffer(t))}),ki,i):Promise.resolve()}},{key:"remove",value:function(e,t,i,n){var s=this,a=!1;return this._mseFullFlag[e]&&(a=!0),this._enqueueOp(e,(function(){if(s.mediaSource&&!s.media.error){var a=s._sourceBuffer[e];t>=i||!a?s._onSBUpdateEnd(e):(s._opst=Si(),s._logger.debug("MSE REMOVE START",e,t,i,n),a.remove(t,i))}}),Ri,n,a)}},{key:"clearBuffer",value:function(e,t){var i,n=this;return Object.keys(this._sourceBuffer).forEach((function(s){i=n.remove(s,e,t)})),i||Promise.resolve()}},{key:"clearAllBuffer",value:function(){var e,t=this;return Object.keys(this._sourceBuffer).forEach((function(i){var n=t._sourceBuffer[i];e=t.remove(i,0,hi.end(hi.get(n)))})),e}},{key:"clearOpQueues",value:function(e,t){var i;this._logger.debug("MSE clearOpQueue START");var n=this._queue[e];if(t&&n)this._queue[e]=[];else if(n&&n[e]&&!(n.length<5)){var s=[];n.forEach((function(e){e.context&&e.context.isinit&&s.push(e)})),this._queue[e]=n.slice(0,2),s.length>0&&(i=this._queue[e]).push.apply(i,s)}}},{key:"endOfStream",value:function(e){var t=this;return this.mediaSource&&"open"===this.mediaSource.readyState?this._enqueueBlockingOp((function(){var i=t.mediaSource;i&&"open"===i.readyState&&(t._logger.debug("MSE endOfStream START"),e?i.endOfStream(e):i.endOfStream())}),"endOfStream"):Promise.resolve()}},{key:"setLiveSeekableRange",value:function(e,t){var i=this.mediaSource;e<0||t<e||null==i||!i.setLiveSeekableRange||"open"!==i.readyState||i.setLiveSeekableRange(e,t)}},{key:"getSourceBuffer",value:function(e){return this._sourceBuffer[e]}},{key:"buffered",value:function(e){return hi.get(this._sourceBuffer[e])}},{key:"bufferStart",value:function(e){return hi.start(this.buffered(e))}},{key:"bufferEnd",value:function(e){return hi.end(this.buffered(e))}},{key:"_enqueueOp",value:function(e,t,i,n,s){var a=this;if(!this.mediaSource)return Promise.resolve();var r=this._queue[e]=this._queue[e]||[],l={exec:t,promise:xi(),opName:i,context:n};return s?(r.splice(0,0,l),this._mseFullFlag[e]=!1,this._startQueue(e)):r.push(l),this.isOpened||this.isEnded?1===r.length&&this._startQueue(e):this._openPromise.then((function(){1===r.length&&a._startQueue(e)})),l.promise}},{key:"_enqueueBlockingOp",value:(t=f(Z().mark((function e(t,i,n){var s,a,r=this;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.mediaSource){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:if((s=Object.keys(this._sourceBuffer)).length){e.next=5;break}return e.abrupt("return",t());case 5:return a=[],s.forEach((function(e){var t=r._queue[e],s=xi();a.push(s),t.push({exec:function(){s.resolve()},promise:s,opName:i,context:n}),1===t.length&&r._startQueue(e)})),e.abrupt("return",Promise.all(a).then((function(){try{return t()}finally{s.forEach((function(e){var t=r._queue[e],i=r._sourceBuffer[e];null==t||t.shift(),i&&i.updating||r._startQueue(e)}))}})));case 8:case"end":return e.stop()}}),e,this)}))),function(e,i,n){return t.apply(this,arguments)})},{key:"_startQueue",value:function(e){var t=this._queue[e];if(t){var i=t[0];if(i&&!this._mseFullFlag[e])try{i.exec()}catch(n){n&&n.message&&n.message.indexOf("SourceBuffer is full")>=0?(this._mseFullFlag[e]=!0,i.context&&"object"===y(i.context)&&(i.context.isFull=!0),this._logger.error("[MSE error],  context,",i.context," ,name,",i.opName,",err,SourceBuffer is full"),i.promise.reject(new bi(Zi.MEDIA,Zi.SUB_TYPES.MSE_FULL,n))):(this._logger.error(n),i.promise.reject(n.constructor===bi?n:new bi(Zi.MEDIA,Zi.SUB_TYPES.MSE_OTHER,n)),t.shift(),this._startQueue(e))}}}},{key:"setTimeoffset",value:function(e,t,i){var n=this;return this._enqueueOp(e,(function(){t<0&&(t+=.001),n._sourceBuffer[e].timestampOffset=t,n._onSBUpdateEnd(e)}),"setTimeoffset",i)}},{key:"abort",value:function(e,t){var i=this;return this.isOpened?this._enqueueOp(e,(function(){i._sourceBuffer[e].abort(),i._onSBUpdateEnd(e)}),"abort",t):Promise.resolve()}}],[{key:"isSupported",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:'video/mp4; codecs="avc1.42E01E,mp4a.40.2"',t=Vi();if(!t)return!1;try{return t.isTypeSupported(e)}catch(i){return this._logger.error(e,i),!1}}},{key:"isMMSOnly",value:function(){return"undefined"!=typeof ManagedMediaSource&&"undefined"==typeof MediaSource}},{key:"getDefaultConfig",value:function(){return{openLog:!1,preferMMS:!1}}}]),e}();G(wi,"VIDEO","video"),G(wi,"AUDIO","audio");var Mi="fetch",Ki="xhr",Ii="arraybuffer",Hi="text",Ci="json",Ni=function(e){v(i,e);var t=w(i);function i(e,n,s,a){var r;return X(this,i),G(R(r=t.call(this,a)),"retryCount",0),G(R(r),"isTimeout",!1),G(R(r),"loaderType",Mi),G(R(r),"startTime",0),G(R(r),"endTime",0),G(R(r),"options",{}),r.url=e,r.request=n,r.response=s,r}return W(i)}(Y(Error)),Fi=Object.prototype.toString;function zi(e){if("[object Object]"!==Fi.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function Ui(e){if(e&&null!==e[0]&&void 0!==e[0]&&(0!==e[0]||null!==e[1]&&void 0!==e[1])){var t="bytes="+e[0]+"-";return e[1]&&(t+=e[1]),t}}function Ji(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function ji(e,t){if(e){if(!t)return e;var i,n=Object.keys(t).map((function(e){if(null!=(i=t[e]))return Array.isArray(i)?e+="[]":i=[i],i.map((function(t){var i;return i=t,"[object Date]"===Fi.call(i)?t=t.toISOString():function(e){return null!==e&&"object"===y(e)}(t)&&(t=JSON.stringify(t)),"".concat(Ji(e),"=").concat(Ji(t))})).join("&")})).filter(Boolean).join("&");if(n){var s=e.indexOf("#");-1!==s&&(e=e.slice(0,s)),e+=(-1===e.indexOf("?")?"?":"&")+n}return e}}function Pi(e,t,i,n,s,a,r,l,o,d,c){return s=null!=s?parseFloat(s):null,n=parseInt(n||"0",10),Number.isNaN(n)&&(n=0),{data:e,done:t,options:{range:o,vid:d,index:l,contentLength:n,age:s,startTime:a,firstByteTime:r,endTime:Date.now(),priOptions:c},response:i}}function Ei(e,t){return Math.round(8*e*1e3/t/1024)}var Di="real_time_speed",Bi=2097152,_i=function(e){v(n,e);var t,i=w(n);function n(){var e;return X(this,n),G(R(e=i.call(this)),"_abortController",null),G(R(e),"_timeoutTimer",null),G(R(e),"_reader",null),G(R(e),"_response",null),G(R(e),"_aborted",!1),G(R(e),"_index",-1),G(R(e),"_range",null),G(R(e),"_receivedLength",0),G(R(e),"_running",!1),G(R(e),"_logger",null),G(R(e),"_vid",""),G(R(e),"_onProcessMinLen",0),G(R(e),"_onCancel",null),G(R(e),"_priOptions",null),e}return W(n,[{key:"load",value:function(e){var t,i=this,n=e.url,s=e.vid,a=e.timeout,r=e.responseType,l=e.onProgress,o=e.index,d=e.onTimeout,c=e.onCancel,u=e.range,m=e.transformResponse,h=e.request,p=e.params,y=e.logger,b=e.method,X=e.headers,L=e.body,W=e.mode,G=e.credentials,v=e.cache,x=e.redirect,S=e.referrer,g=e.referrerPolicy,V=e.onProcessMinLen,Y=e.priOptions;this._logger=y,this._aborted=!1,this._onProcessMinLen=V,this._onCancel=c,this._abortController="undefined"!=typeof AbortController&&new AbortController,this._running=!0,this._index=o,this._range=u||[0,0],this._vid=s||n,this._priOptions=Y||{};var k={method:b,headers:X,body:L,mode:W,credentials:G,cache:v,redirect:x,referrer:S,referrerPolicy:g,signal:null===(t=this._abortController)||void 0===t?void 0:t.signal},R=!1;clearTimeout(this._timeoutTimer),n=ji(n,p);var T=Ui(u);T&&(X=h?h.headers:k.headers=k.headers||(Headers?new Headers:{}),Headers&&X instanceof Headers?X.append("Range",T):X.Range=T),a&&(this._timeoutTimer=setTimeout((function(){if(R=!0,i.cancel(),d){var e=new Ni(n,k,null,"timeout");e.isTimeout=!0,d(e,{index:i._index,range:i._range,vid:i._vid,priOptions:i._priOptions})}}),a));var w=Date.now();return this._logger.debug("[fetch load start], index,",o,",range,",u),new Promise((function(e,t){fetch(h||n,h?void 0:k).then(function(){var s=f(Z().mark((function s(a){var d,c,h,p;return Z().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(clearTimeout(i._timeoutTimer),i._response=a,!i._aborted&&i._running){s.next=4;break}return s.abrupt("return");case 4:if(m&&(a=m(a,n)||a),a.ok){s.next=7;break}throw new Ni(n,k,a,"bad network response");case 7:if(d=Date.now(),r!==Hi){s.next=15;break}return s.next=11,a.text();case 11:c=s.sent,i._running=!1,s.next=37;break;case 15:if(r!==Ci){s.next=22;break}return s.next=18,a.json();case 18:c=s.sent,i._running=!1,s.next=37;break;case 22:if(!l){s.next=29;break}return i.resolve=e,i.reject=t,i._loadChunk(a,l,w,d),s.abrupt("return");case 29:return s.next=31,a.arrayBuffer();case 31:c=s.sent,c=new Uint8Array(c),i._running=!1,h=Date.now()-w,p=Ei(c.byteLength,h),i.emit(Di,{speed:p,len:c.byteLength,time:h,vid:i._vid,index:i._index,range:i._range,priOptions:i._priOptions});case 37:i._logger.debug("[fetch load end], index,",o,",range,",u),e(Pi(c,!0,a,a.headers.get("Content-Length"),a.headers.get("age"),w,d,o,u,i._vid,i._priOptions));case 39:case"end":return s.stop()}}),s)})));return function(e){return s.apply(this,arguments)}}()).catch((function(e){var s;clearTimeout(i._timeoutTimer),i._running=!1,i._aborted&&!R||((e=e instanceof Ni?e:new Ni(n,k,null,null===(s=e)||void 0===s?void 0:s.message)).startTime=w,e.endTime=Date.now(),e.isTimeout=R,e.options={index:i._index,range:i._range,vid:i._vid,priOptions:i._priOptions},t(e))}))}))}},{key:"cancel",value:(t=f(Z().mark((function e(){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._aborted){e.next=2;break}return e.abrupt("return");case 2:if(this._aborted=!0,this._running=!1,!this._response){e.next=14;break}if(e.prev=5,!this._reader){e.next=9;break}return e.next=9,this._reader.cancel();case 9:e.next=13;break;case 11:e.prev=11,e.t0=e.catch(5);case 13:this._response=this._reader=null;case 14:if(this._abortController){try{this._abortController.abort()}catch(t){}this._abortController=null}this._onCancel&&this._onCancel({index:this._index,range:this._range,vid:this._vid,priOptions:this._priOptions});case 16:case"end":return e.stop()}}),e,this,[[5,11]])}))),function(){return t.apply(this,arguments)})},{key:"_loadChunk",value:function(e,t,i,n){var s=this;if(!e.body||!e.body.getReader){this._running=!1;var a=new Ni(e.url,"",e,"onProgress of bad response.body.getReader");return a.options={index:this._index,range:this._range,vid:this._vid,priOptions:this._priOptions},void this.reject(a)}this._onProcessMinLen>0&&(this._cache=new Uint8Array(Bi),this._writeIdx=0);var r,l,o,d=this._reader=e.body.getReader(),c=function(){var a=f(Z().mark((function a(){var u,m,h,p,y,b,f,X;return Z().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return l=Date.now(),a.prev=1,a.next=4,d.read();case 4:r=a.sent,o=Date.now(),a.next=13;break;case 8:return a.prev=8,a.t0=a.catch(1),o=Date.now(),s._aborted||(s._running=!1,a.t0.options={index:s._index,range:s._range,vid:s._vid,priOptions:s._priOptions},s.reject(a.t0)),a.abrupt("return");case 13:if(m=(null===(u=s._range)||void 0===u?void 0:u.length)>0?s._range[0]:0,h=m+s._receivedLength,!s._aborted){a.next=19;break}return s._running=!1,t(void 0,!1,{range:[h,h],vid:s._vid,index:s._index,startTime:l,endTime:o,st:i,firstByteTime:n,priOptions:s._priOptions},e),a.abrupt("return");case 19:p=r.value?r.value.byteLength:0,s._receivedLength+=p,s._logger.debug("【fetchLoader,onProgress call】,task,",s._range,", start,",h,", end,",m+s._receivedLength,", done,",r.done),s._onProcessMinLen>0?s._writeIdx+p>=s._onProcessMinLen||r.done?((y=new Uint8Array(s._writeIdx+p)).set(s._cache.slice(0,s._writeIdx),0),p>0&&y.set(r.value,s._writeIdx),s._writeIdx=0,s._logger.debug("【fetchLoader,onProgress enough】,done,",r.done,",len,",y.byteLength,", writeIdx,",s._writeIdx)):p>0&&s._writeIdx+p<Bi?(s._cache.set(r.value,s._writeIdx),s._writeIdx+=p,s._logger.debug("【fetchLoader,onProgress cache】,len,",p,", writeIdx,",s._writeIdx)):p>0&&(b=new Uint8Array(s._writeIdx+p+2048),s._logger.debug("【fetchLoader,onProgress extra start】,size,",s._writeIdx+p+2048,", datalen,",p,", writeIdx,",s._writeIdx),b.set(s._cache.slice(0,s._writeIdx),0),p>0&&b.set(r.value,s._writeIdx),s._writeIdx+=p,delete s._cache,s._cache=b,s._logger.debug("【fetchLoader,onProgress extra end】,len,",p,", writeIdx,",s._writeIdx)):y=r.value,(y&&y.byteLength>0||r.done)&&t(y,r.done,{range:[s._range[0]+s._receivedLength-(y?y.byteLength:0),s._range[0]+s._receivedLength],vid:s._vid,index:s._index,startTime:l,endTime:o,st:i,firstByteTime:n,priOptions:s._priOptions},e),r.done?(f=Date.now()-i,X=Ei(s._receivedLength,f),s.emit(Di,{speed:X,len:s._receivedLength,time:f,vid:s._vid,index:s._index,range:s._range,priOptions:s._priOptions}),s._running=!1,s._logger.debug("[fetchLoader onProgress end],task,",s._range,",done,",r.done),s.resolve(Pi(r,!0,e,e.headers.get("Content-Length"),e.headers.get("age"),i,n,s._index,s._range,s._vid,s._priOptions))):c();case 25:case"end":return a.stop()}}),a,null,[[1,8]])})));return function(){return a.apply(this,arguments)}}();c()}},{key:"receiveLen",get:function(){return this._receivedLength}},{key:"running",get:function(){return this._running},set:function(e){this._running=e}}],[{key:"isSupported",value:function(){return!("undefined"==typeof fetch)}}]),n}(j);var Qi=function(e){v(i,e);var t=w(i);function i(){var e;return X(this,i),G(R(e=t.call(this)),"_xhr",null),G(R(e),"_aborted",!1),G(R(e),"_timeoutTimer",null),G(R(e),"_range",null),G(R(e),"_receivedLength",0),G(R(e),"_url",null),G(R(e),"_onProgress",null),G(R(e),"_index",-1),G(R(e),"_headers",null),G(R(e),"_currentChunkSizeKB",384),G(R(e),"_timeout",null),G(R(e),"_xhr",null),G(R(e),"_withCredentials",null),G(R(e),"_startTime",-1),G(R(e),"_loadCompleteResolve",null),G(R(e),"_loadCompleteReject",null),G(R(e),"_runing",!1),G(R(e),"_logger",!1),G(R(e),"_vid",""),G(R(e),"_responseType",void 0),G(R(e),"_credentials",void 0),G(R(e),"_method",void 0),G(R(e),"_transformResponse",void 0),G(R(e),"_firstRtt",void 0),G(R(e),"_onCancel",null),G(R(e),"_priOptions",null),e}return W(i,[{key:"load",value:function(e){var t=this;clearTimeout(this._timeoutTimer),this._logger=e.logger,this._range=e.range,this._onProgress=e.onProgress,this._index=e.index,this._headers=e.headers,this._withCredentials="include"===e.credentials||"same-origin"===e.credentials,this._body=e.body||null,e.method&&(this._method=e.method),this._timeout=e.timeout||null,this._runing=!0,this._vid=e.vid||e.url,this._responseType=e.responseType,this._firstRtt=-1,this._onTimeout=e.onTimeout,this._onCancel=e.onCancel,this._request=e.request,this._priOptions=e.priOptions||{},this._logger.debug("【xhrLoader task】, range",this._range),this._url=ji(e.url,e.params);var i=Date.now();return new Promise((function(e,i){t._loadCompleteResolve=e,t._loadCompleteReject=i,t._startLoad()})).catch((function(e){if(clearTimeout(t._timeoutTimer),t._runing=!1,!t._aborted)throw(e=e instanceof Ni?e:new Ni(t._url,t._request)).startTime=i,e.endTime=Date.now(),e.options={index:t._index,vid:t._vid,priOptions:t._priOptions},e}))}},{key:"_startLoad",value:function(){var e=null;if(this._responseType===Ii&&this._range&&this._range.length>1)if(this._onProgress){this._firstRtt=-1;var t=1024*this._currentChunkSizeKB,i=this._range[0]+this._receivedLength,n=this._range[1];t<this._range[1]-i&&(n=i+t),e=[i,n],this._logger.debug("[xhr_loader->],tast :",this._range,", SubRange, ",e)}else e=this._range,this._logger.debug("[xhr_loader->],tast :",this._range,", allRange, ",e);this._internalOpen(e)}},{key:"_internalOpen",value:function(e){var t=this;try{this._startTime=Date.now();var i=this._xhr=new XMLHttpRequest;i.open(this._method||"GET",this._url,!0),i.responseType=this._responseType,this._timeout&&(i.timeout=this._timeout),i.withCredentials=this._withCredentials,i.onload=this._onLoad.bind(this),i.onreadystatechange=this._onReadyStatechange.bind(this),i.onerror=function(e){var i,n,s;t._running=!1;var a=new Ni(t._url,t._request,null==e||null===(i=e.currentTarget)||void 0===i?void 0:i.response,"xhr.onerror.status:"+(null==e||null===(n=e.currentTarget)||void 0===n?void 0:n.status)+",statusText,"+(null==e||null===(s=e.currentTarget)||void 0===s?void 0:s.statusText));a.options={index:t._index,range:t._range,vid:t._vid,priOptions:t._priOptions},t._loadCompleteReject(a)},i.ontimeout=function(e){t.cancel();var i=new Ni(t._url,t._request,{status:408},"timeout");t._onTimeout&&(i.isTimeout=!0,t._onTimeout(i,{index:t._index,range:t._range,vid:t._vid,priOptions:t._priOptions})),i.options={index:t._index,range:t._range,vid:t._vid,priOptions:t._priOptions},t._loadCompleteReject(i)};var n=this._headers||{},s=Ui(e);s&&(n.Range=s),n&&Object.keys(n).forEach((function(e){i.setRequestHeader(e,n[e])})),this._logger.debug("[xhr.send->] tast,",this._range,",load sub range, ",e),i.send(this._body)}catch(a){a.options={index:this._index,range:e,vid:this._vid,priOptions:this._priOptions},this._loadCompleteReject(a)}}},{key:"_onReadyStatechange",value:function(e){2===e.target.readyState&&this._firstRtt<0&&(this._firstRtt=Date.now())}},{key:"_onLoad",value:function(e){var t,i=e.target.status;if(i<200||i>299){var n=new Ni(this._url,null,p(p({},e.target.response),{},{status:i}),"bad response,status:"+i);return n.options={index:this._index,range:this._range,vid:this._vid,priOptions:this._priOptions},this._loadCompleteReject(n)}var s,a=null,r=!1,l=(null===(t=this._range)||void 0===t?void 0:t.length)>0?this._range[0]:0;if(this._responseType===Ii){var o,d=new Uint8Array(e.target.response);if(s=l+this._receivedLength,d&&d.byteLength>0){this._receivedLength+=d.byteLength;var c=Date.now()-this._startTime,u=Ei(this._receivedLength,c);this.emit(Di,{speed:u,len:this._receivedLength,time:c,vid:this._vid,index:this._index,range:[s,l+this._receivedLength],priOptions:this._priOptions})}a=d,r=!((null===(o=this._range)||void 0===o?void 0:o.length)>1&&this._range[1]&&this._receivedLength<this._range[1]-this._range[0]),this._logger.debug("[xhr load done->], tast :",this._range,", start",s,"end ",l+this._receivedLength,",dataLen,",d?d.byteLength:0,",receivedLength",this._receivedLength,",index,",this._index,", done,",r)}else r=!0,a=e.target.response;var m={ok:i>=200&&i<300,status:i,statusText:this._xhr.statusText,url:this._xhr.responseURL,headers:this._getHeaders(this._xhr),body:this._xhr.response};this._transformResponse&&(m=this._transformResponse(m,this._url)||m),this._onProgress&&this._onProgress(a,r,{index:this._index,vid:this._vid,range:[s,l+this._receivedLength],startTime:this._startTime,endTime:Date.now(),priOptions:this._priOptions},m),r?(this._runing=!1,this._loadCompleteResolve&&this._loadCompleteResolve(Pi(this._onProgress?null:a,r,m,m.headers["content-length"],m.headers.age,this._startTime,this._firstRtt,this._index,this._range,this._vid,this._priOptions))):this._startLoad()}},{key:"cancel",value:function(){if(!this._aborted)return this._aborted=!0,this._runing=!1,K(x(i.prototype),"removeAllListeners",this).call(this),this._onCancel&&this._onCancel({index:this._index,range:this._range,vid:this._vid,priOptions:this._priOptions}),this._xhr?this._xhr.abort():void 0}},{key:"receiveLen",get:function(){return this._receivedLength}},{key:"running",get:function(){return this._running},set:function(e){this._running=e}},{key:"_getHeaders",value:function(e){var t,i={},n=F(e.getAllResponseHeaders().trim().split("\r\n"));try{for(n.s();!(t=n.n()).done;){var s=t.value.split(": ");i[s[0].toLowerCase()]=s.slice(1).join(": ")}}catch(a){n.e(a)}finally{n.f()}return i}}],[{key:"isSupported",value:function(){return"undefined"!=typeof XMLHttpRequest}}]),i}(j),Oi=["retry","retryDelay","onRetryError","transformError"],Ai=function(){function e(t,i){X(this,e),this.promise=xi(),this.alive=!!i.onProgress,!i.logger&&(i.logger=new Li("Loader")),this._loaderType=t,this._loader=t===Mi&&"undefined"!=typeof fetch?new _i:new Qi,this._config=i,this._retryCount=0,this._retryTimer=null,this._canceled=!1,this._retryCheckFunc=i.retryCheckFunc,this._logger=i.logger}var t;return W(e,[{key:"exec",value:function(){var e=this,t=this._config,i=t.retry,n=t.retryDelay,s=t.onRetryError,a=t.transformError,r=k(t,Oi),l=function(){var t=f(Z().mark((function t(){var o,d,c;return Z().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e._loader.load(r);case 3:o=t.sent,e.promise.resolve(o),t.next=27;break;case 7:if(t.prev=7,t.t0=t.catch(0),e._loader.running=!1,e._logger.debug("[task request catch err]",t.t0),!e._canceled){t.next=13;break}return t.abrupt("return");case 13:if(t.t0.loaderType=e._loaderType,t.t0.retryCount=e._retryCount,d=t.t0,a&&(d=a(d)||d),s&&e._retryCount>0&&s(d,e._retryCount,{index:r.index,vid:r.vid,range:r.range,priOptions:r.priOptions}),e._retryCount++,c=!0,e._retryCheckFunc&&(c=e._retryCheckFunc(t.t0)),!(c&&e._retryCount<=i)){t.next=26;break}return clearTimeout(e._retryTimer),e._logger.debug("[task request setTimeout],retry",e._retryCount,",retry range,",r.range),e._retryTimer=setTimeout(l,n),t.abrupt("return");case 26:e.promise.reject(d);case 27:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}();return l(),this.promise}},{key:"cancel",value:(t=f(Z().mark((function e(){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return clearTimeout(this._retryTimer),this._canceled=!0,this._loader.running=!1,e.abrupt("return",this._loader.cancel());case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"running",get:function(){return this._loader&&this._loader.running}},{key:"loader",get:function(){return this._loader}}]),e}();function qi(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];if((t=t.filter(Boolean)).length<2)return t[0];var n=new Uint8Array(t.reduce((function(e,t){return e+t.byteLength}),0)),s=0;return t.forEach((function(e){n.set(e,s),s+=e.byteLength})),n}function $i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Promise((function(t){return setTimeout(t,e)}))}var en=function(e){v(n,e);var t,i=w(n);function n(e){var t;return X(this,n),G(R(t=i.call(this,e)),"type",Mi),G(R(t),"_queue",[]),G(R(t),"_alive",[]),G(R(t),"_currentTask",null),G(R(t),"_finnalUrl",""),G(R(t),"_config",void 0),t._config=function(e){return p({loaderType:Mi,retry:0,retryDelay:0,timeout:0,request:null,onTimeout:void 0,onProgress:void 0,onRetryError:void 0,transformRequest:void 0,transformResponse:void 0,transformError:void 0,responseType:Hi,range:void 0,url:"",params:void 0,method:"GET",headers:{},body:void 0,mode:void 0,credentials:void 0,cache:void 0,redirect:void 0,referrer:void 0,referrerPolicy:void 0,integrity:void 0,onProcessMinLen:0},e)}(e),t._config.loaderType!==Ki&&_i.isSupported()||(t.type=Ki),t.log=e.logger,t}return W(n,[{key:"isFetch",value:function(){return this.type===Mi}},{key:"load",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"string"!=typeof e&&e?i=e:i.url=e||i.url||this._config.url,(i=Object.assign({},this._config,i)).params&&(i.params=Object.assign({},i.params)),i.headers&&zi(i.headers)&&(i.headers=Object.assign({},i.headers)),i.body&&zi(i.body)&&(i.body=Object.assign({},i.body)),i.transformRequest&&(i=i.transformRequest(i)||i),i.logger=this.log;var n=new Ai(this.type,i);return n.loader.on(Di,(function(e){t.emit(Di,e)})),this._queue.push(n),1!==this._queue.length||this._currentTask&&this._currentTask.running||this._processTask(),n.promise}},{key:"cancel",value:(t=f(Z().mark((function e(){var t;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._queue.map((function(e){return e.cancel()})).concat(this._alive.map((function(e){return e.cancel()}))),this._currentTask&&t.push(this._currentTask.cancel()),this._queue=[],this._alive=[],e.next=6,Promise.all(t);case 6:return e.next=8,$i();case 8:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"_processTask",value:function(){var e=this;if(this._currentTask=this._queue.shift(),this._currentTask){this._currentTask.alive&&this._alive.push(this._currentTask);var t=this._currentTask.exec().catch((function(e){}));t&&"function"==typeof t.finally&&t.finally((function(){var t,i;null!==(t=e._currentTask)&&void 0!==t&&t.alive&&(null===(i=e._alive)||void 0===i?void 0:i.length)>0&&(e._alive=e._alive.filter((function(t){return t&&t!==e._currentTask}))),e._processTask()}))}}}],[{key:"isFetchSupport",value:function(){return _i.isSupported()}}]),n}(j),tn={416:yi[Zi.NETWROK_RANGE_NOT_SATISFIABLE],403:yi[Zi.NETWORK_FORBIDDEN],404:yi[Zi.NETWORK_NOTFOUND],timeout:yi[Zi.NETWORK_TIMEOUT],"4xx":"".concat(yi[Zi.NETWORK],"4XX"),"5xx":"".concat(yi[Zi.NETWORK],"5XX"),networkError:yi[Zi.NETWORK],contentError:"".concat(yi[Zi.NETWORK],"contentError"),mse:yi[Zi.MEDIA][Zi.SUB_TYPES.MSE_OTHER],mseOpen:yi[Zi.MEDIA][Zi.SUB_TYPES.MSE_ADD_SB],mseAppend:yi[Zi.MEDIA][Zi.SUB_TYPES.MSE_APPEND_BUFFER],mse_hijack:yi[Zi.MEDIA][Zi.SUB_TYPES.MSE_HIJACK],eme_hijack:yi[Zi.MEDIA][Zi.SUB_TYPES.EME_HIJACK],metaError:yi[Zi.DEMUX][Zi.SUB_TYPES.MP4],muxError:yi[Zi.REMUX][Zi.SUB_TYPES.FMP4],other:yi[Zi.OTHER],waitTimeout:yi[Zi.RUNTIME][Zi.SUB_TYPES.BUFFERBREAK_ERROR],waitTimeoutWithHidden:yi[Zi.RUNTIME][Zi.SUB_TYPES.WAITING_TIMEOUT_ERROR],drm:yi[Zi.DRM][Zi.SUB_TYPES.LICENSE]},nn=Zi;var sn=W((function e(t,i,n){X(this,e);var s=0,a=0;n&&n.range&&n.range.length>1&&(s=n.range[0],a=n.range[1]);var r=function(e){return tn[e]||e}(i);return{errorCode:r,errorType:t,errorMessage:(null==n?void 0:n.httpText)||(null==n?void 0:n.message),url:null==n?void 0:n.url,httpCode:i,version:mi,rangeStart:s,rangeEnd:a,ext:n,mediaError:{code:r,message:(null==n?void 0:n.httpText)||(null==n?void 0:n.message)}}})),an=W((function e(t,i,n){return X(this,e),{errorCode:i,errorType:t,version:mi,errorMessage:n.msg,ext:n,mediaError:{code:i,message:n.msg}}})),rn={};rn.nowTime=function(){try{return parseInt(performance.now(),10)}catch(e){return(new Date).getTime()}},rn.concatData=function(e,t){var i=[],n=0;e&&i.push(e),t&&i.push(t),i.every((function(e){return e&&(n+=e.byteLength),!0}));var s=new Uint8Array(n),a=0;return i.every((function(e){return e&&(s.set(e,a),a+=e.byteLength),!0})),s};var ln=W((function e(t,i){X(this,e),this.type="file",this.message=t,this.data=i})),on=function(){function e(){X(this,e),G(this,"_data",Object.create(null))}return W(e,[{key:"set",value:function(e,t){this._data[e]=t}},{key:"get",value:function(e){return this._data[e]}},{key:"clear",value:function(){this._data=Object.create(null)}}]),e}();function dn(e,t){var i=e.trak;if(i&&i.length){var n=i.find((function(e){var t,i;return"vide"===(null===(t=e.mdia)||void 0===t||null===(i=t.hdlr)||void 0===i?void 0:i.handlerType)})),s=i.find((function(e){var t,i;return"soun"===(null===(t=e.mdia)||void 0===t||null===(i=t.hdlr)||void 0===i?void 0:i.handlerType)}));if(n||s){var a=[],r=[];if(t){var l=[],o=0,d=t.start+t.size;t.references.forEach((function(e,i){l.push({index:i,startTime:o,endTime:o+e.subsegment_duration/t.timescale,duration:e.subsegment_duration/t.timescale,range:[d,d+e.referenced_size],frames:[]}),o+=e.subsegment_duration/t.timescale,d+=e.referenced_size})),a=l,r=l}else{var c,u,m=function(t){return t?[{index:0,startTime:0,endTime:t.duration/t.timescale,duration:t.duration/t.timescale,range:[e.start+e.size,""],frames:[]}]:[]};r=m(e.mvhd.duration?e.mvhd:null===(c=n.mdia)||void 0===c?void 0:c.mdhd),a=m(e.mvhd.duration?e.mvhd:null===(u=s.mdia)||void 0===u?void 0:u.mdhd)}return{videoSegments:r,audioSegments:a}}}}function cn(e,t){var i=e.trak;if(i&&i.length){var n=i.find((function(e){var t,i;return"vide"===(null===(t=e.mdia)||void 0===t||null===(i=t.hdlr)||void 0===i?void 0:i.handlerType)})),s=i.find((function(e){var t,i;return"soun"===(null===(t=e.mdia)||void 0===t||null===(i=t.hdlr)||void 0===i?void 0:i.handlerType)}));if(n||s){var a,r=[],l=[];if(n){var o,d,c,u=null===(o=n.mdia)||void 0===o||null===(d=o.minf)||void 0===d?void 0:d.stbl;if(!u)return;var m=null===(c=n.mdia.mdhd)||void 0===c?void 0:c.timescale,h=u.stts,p=u.stsc,Z=u.stsz,y=u.stco,b=u.stss,f=u.ctts;if(!(m&&h&&p&&Z&&y&&b))return;a=(r=un(t,m,h,p,Z,y,b,f)).map((function(e){return e.duration}))}if(s){var X,L,W,G=null===(X=s.mdia)||void 0===X||null===(L=X.minf)||void 0===L?void 0:L.stbl;if(!G)return;var v=null===(W=s.mdia.mdhd)||void 0===W?void 0:W.timescale,x=G.stts,S=G.stsc,g=G.stsz,V=G.stco;if(!(v&&x&&S&&g&&V))return;l=un(t,v,x,S,g,V,null,null,a)}return{videoSegments:r,audioSegments:l}}}}function un(e,t,i,n,s,a,r,l,o){var d,c,u,m,h,p=[],Z=[],y=[],b=n.entries,f=a.entries,X=s.entrySizes,L=null==r?void 0:r.entries,W=null==l?void 0:l.entries;W&&(c=[],W.forEach((function(e){for(var t=e.count,i=e.offset,n=0;n<t;n++)c.push(i)}))),L&&(u={},L.forEach((function(e){u[e-1]=!0})));var G=0,v=0,x=0,S=0,g=0,V=null===(d=b[0])||void 0===d?void 0:d.samplesPerChunk,Y=b[1]?b[1].firstChunk-1:1/0,k=0,R=-1;i.entries.forEach((function(e){var t=e.count,i=e.delta;h=i;for(var n=0;n<t;n++)m={dts:k,startTime:G,duration:h,size:X[v]||s.sampleSize,offset:f[x]+g,index:v},L&&(m.keyframe=u[v],m.keyframe?(R++,Z.push([m]),y.push(m.duration)):(Z[Z.length-1].push(m),y[Z.length-1]+=m.duration),m.gopId=R),c&&v<c.length&&(m.pts=k+c[v]),0===v&&(m.pts=0),p.push(m),G+=h,k+=i,++v<V?g+=m.size:(x++,g=0,x>=Y&&(S++,Y=b[S+1]?b[S+1].firstChunk-1:1/0),V+=b[S].samplesPerChunk)}));var T=p.length;if(!T||r&&!p[0].keyframe)return[];var w,M=[],K=[],I=0,C=0,N=function(e){var i;w=K[K.length-1],M.push({index:M.length,startTime:(null===(i=M[M.length-1])||void 0===i?void 0:i.endTime)||K[0].startTime/t,endTime:(w.startTime+w.duration)/t,duration:e,range:[K[0].offset,w.offset+w.size],frames:K}),I=0,K=[]};if(r)for(var F=e*t,z=0,U=Z.length;z<U;z++){var J;I+=y[z],(J=K).push.apply(J,H(Z[z])),z+1<U?(0===z||I>F)&&N(I/t):N(I/t)}else for(var j=(o=o||[])[0]||e,P=0;P<T;P++){K.push(p[P]);var E=(I+=p[P].duration)/t;(P+1>=T||E+C>=j)&&(C+=E-j,N(E),j=o[M.length]||e)}return M}function mn(e,t){var i="",n="",s=0,a=0,r=0,l=0,o=0,d=0,c=0;e.mvhd&&(o=e.mvhd.duration/e.mvhd.timescale);var u=e.trak;if(u){var m,h,p,Z,y,b,f,X,L,W,G,v,x,S,g,V,Y,k=u.find((function(e){var t,i;return"vide"===(null===(t=e.mdia)||void 0===t||null===(i=t.hdlr)||void 0===i?void 0:i.handlerType)})),R=u.find((function(e){var t,i;return"soun"===(null===(t=e.mdia)||void 0===t||null===(i=t.hdlr)||void 0===i?void 0:i.handlerType)})),T=null;if(k)if(T=null===(h=k.mdia)||void 0===h||null===(p=h.minf)||void 0===p||null===(Z=p.stbl)||void 0===Z?void 0:Z.stsd.entries[0])if(s=T.width,a=T.height,d=null===(y=k.mdia)||void 0===y||null===(b=y.mdhd)||void 0===b?void 0:b.timescale,i=null===(f=T.avcC||T.hvcC||T.av1C)||void 0===f?void 0:f.codec,"encv"===T.type)m=null===(X=T.sinf)||void 0===X||null===(L=X.schi)||void 0===L?void 0:L.tenc.default_KID;if(R)if(T=null===(W=R.mdia)||void 0===W||null===(G=W.minf)||void 0===G||null===(v=G.stbl)||void 0===v?void 0:v.stsd.entries[0])if(r=T.channelCount,l=T.sampleRate,n=null===(x=T.esds)||void 0===x?void 0:x.codec,c=null===(S=R.mdia)||void 0===S||null===(g=S.mdhd)||void 0===g?void 0:g.timescale,"enca"===T.type)m=m||(null===(V=T.sinf)||void 0===V||null===(Y=V.schi)||void 0===Y?void 0:Y.tenc.default_KID);return{kid:m?m.join(""):null,videoCodec:i,audioCodec:n,width:s,height:a,videoTimescale:d,audioChannelCount:r,audioSampleRate:l,duration:o,audioTimescale:c,moov:e,isFragmentMP4:t}}}function hn(e){return"number"==typeof e&&!Number.isNaN(e)}var pn=["vid","cache"],Zn=function(e){v(h,e);var t,i,n,s,a,r,l,o,d,c,u,m=w(h);function h(e){var t;X(this,h),G(R(t=m.call(this)),"vid",""),G(R(t),"url",""),G(R(t),"meta",{}),G(R(t),"downloadInfo",[]),G(R(t),"videoSegments",[]),G(R(t),"audioSegments",[]),G(R(t),"cache",null),G(R(t),"_currentSegmentIndex",-1),G(R(t),"_currentLoadingSegmentIndex",-1),G(R(t),"buffer",void 0),G(R(t),"_error",void 0),G(R(t),"_transformError",(function(e){return e})),t._config=p({vid:"",moovEnd:8e4,segmentDuration:2,maxDownloadInfoSize:30,responseType:"arraybuffer",cache:null},e);var i=t._config,n=i.vid,s=i.cache,a=k(i,pn);return t.cache=s||new on,t.vid=n||a.url,t.url=a.url,a.transformError=t._transformError,t.logger=new Li("MP4Loader_"+t.vid),e.openLog&&Li.enable(),a.logger=t.logger,t._loader=new en(a),t._loader.on(Di,(function(e){t.emit(Di,e)})),t}return W(h,[{key:"isMetaLoaded",get:function(){return this.videoSegments.length||this.audioSegments.length}},{key:"setCurrentSegment",value:function(e){hn(e)&&(this._currentSegmentIndex=e)}},{key:"isLastSegment",value:function(e){var t,i;return!!hn(e)&&e>=((null===(t=this.videoSegments[this.videoSegments.length-1])||void 0===t?void 0:t.index)||(null===(i=this.audioSegments[this.audioSegments.length-1])||void 0===i?void 0:i.index)||0)}},{key:"isSegmentLoading",value:function(e){return e===this._currentLoadingSegmentIndex}},{key:"changeUrl",value:(u=f(Z().mark((function e(t){var i,n,s,a=arguments;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=a.length>1&&void 0!==a[1]?a[1]:t,n=a.length>2?a[2]:void 0,s=a.length>3?a[3]:void 0,e.next=5,this.reset(s);case 5:t&&(this.url=t),i&&(this.vid=i),n&&(this._config.moovEnd=n);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"getOrLoadMeta",value:(c=f(Z().mark((function e(t){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isMetaLoaded){e.next=3;break}return e.next=3,this.loadMeta(t);case 3:return e.abrupt("return",this.meta);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"loadMetaProcess",value:(d=f(Z().mark((function e(t,i,n,s){var a,r,l,o,d=this;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=I(i,2),r=a[0],l=a[1],this._error=!1,this.logger.debug("[loadMetaProcess start], range,",[r,l]),o=function(){var e=f(Z().mark((function e(i,a,o){var c,u,m,h,p,y,b,X,L,W,G,v,x;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d.meta&&null!=o&&o.range&&o.range.length>0&&o.range[1]>=l&&(a=!0,d.logger.debug("[loadMetaProcess],data done,setstate true,[",r,l,"]")),a&&null!=o&&o.range&&o.range.length>0&&o.range[1]<l&&(a=!1,d.logger.debug("[loadMetaProcess],data not done,setstate false,[",r,l,"]")),d.logger.debug("[loadMetaProcess],task,[",r,l,"], range,",o.range,",dataLen,",i?i.byteLength:void 0,", state,",a,",err,",d._error),!d._error&&i&&i.byteLength>0&&n(i,a,o),!d.meta.moov&&!d._error){e.next=6;break}return e.abrupt("return");case 6:if(!(i&&i.byteLength>0)){e.next=51;break}if(d.buffer=qi(d.buffer,i),c=Oe.findBox(d.buffer,["moov"])[0]){e.next=23;break}if(u=Oe.findBox(d.buffer,["mdat"])[0],!a){e.next=23;break}if(u){e.next=18;break}return d._error=!0,n(null,a,o,{err:"cannot find moov or mdat box"}),e.abrupt("return");case 18:return m=u.start+u.size,e.next=21,d.loadData([m,""],t,s);case 21:(h=e.sent)&&(c=Oe.findBox(h.data,["moov"])[0]);case 23:if(!(c&&a&&c.size>c.data.length)){e.next=27;break}return d.logger.debug("[loadMetaProcess],moov not all, range,",o.range[1],",dataLen,",d.buffer.byteLength,", state,",a),e.next=27,d.loadMetaProcess(t,[o.range[1],c.start+c.size-1],n);case 27:if(!(c&&c.size<=c.data.length)||d.meta.moov){e.next=51;break}if(p=Oe.moov(c)){e.next=33;break}return d._error=!0,n(null,a,o,{err:"cannot parse moov box"}),e.abrupt("return");case 33:if(y=cn(p,d._config.segmentDuration),b=function(){var e=f(Z().mark((function e(i){var n,a;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=Oe.findBox(d.buffer,[i])[0])){e.next=11;break}if(!(n.size>n.data.length)){e.next=10;break}return e.next=5,d.loadData([n.start,n.start+n.size-1],t,s);case 5:if(!(a=e.sent)){e.next=8;break}return e.abrupt("return",Oe.findBox(a.data,[i])[0]);case 8:e.next=11;break;case 10:return e.abrupt("return",n);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),X=!1,y&&y.videoSegments.length&&y.audioSegments.length){e.next=41;break}return e.next=39,b("sidx");case 39:(L=e.sent)&&(W=Oe.sidx(L))&&(y=dn(p,W),X=!0);case 41:if(y){e.next=45;break}return d._error=!0,n(null,a,o,{err:"cannot parse segments"}),e.abrupt("return");case 45:d.meta=mn(p,X),v=(G=y).videoSegments,x=G.audioSegments,d.videoSegments=v,d.audioSegments=x,d.logger.debug("[loadMetaProcess] moov ok"),n(void 0,a,{meta:{meta:d.meta,videoSegments:v,audioSegments:x}});case 51:case"end":return e.stop()}}),e)})));return function(t,i,n){return e.apply(this,arguments)}}(),e.next=6,this.loadData([r,l||this._config.moovEnd],t,p({onProgress:o},s));case 6:case"end":return e.stop()}}),e,this)}))),function(e,t,i,n){return d.apply(this,arguments)})},{key:"loadMeta",value:(o=f(Z().mark((function e(t,i,n){var s,a,r,l,o,d,c,u,m,h,p,y,b,f;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=[],this.logger.debug("[loadMeta start]"),e.next=4,this.loadData([0,i||this._config.moovEnd],t,n);case 4:if(a=e.sent){e.next=7;break}return e.abrupt("return");case 7:if(s.push(a),r=Oe.findBox(a.data,["moov"])[0]){e.next=23;break}if(l=Oe.findBox(a.data,["mdat"])[0]){e.next=13;break}throw new ln("cannot find moov or mdat box",a.data);case 13:return o=l.start+l.size,e.next=16,this.loadData([o],t,n);case 16:if(a=e.sent){e.next=19;break}return e.abrupt("return");case 19:if(s.push(a),r=Oe.findBox(a.data,["moov"],o)[0]){e.next=23;break}throw new ln("cannot find moov box",a.data);case 23:if(!(r.size>r.data.length)){e.next=31;break}return e.next=26,this.loadData([a.data.length,r.start+r.size-1],t,n);case 26:if(a=e.sent){e.next=29;break}return e.abrupt("return");case 29:s.push(a),r.data=qi(r.data,a.data);case 31:if(d=Oe.moov(r)){e.next=34;break}throw new ln("cannot parse moov box",r.data);case 34:if(c=cn(d,this._config.segmentDuration)){e.next=37;break}throw new ln("cannot parse segments",r.data);case 37:return c.videoSegments.length&&c.audioSegments.length||(m=Oe.findBox(this.buffer,["moof"])[0],h=Oe.findBox(this.buffer,["sidx"])[0],m&&m.size<=m.data.length&&h&&(p=Oe.moof(m),u=Oe.sidx(h),p&&u&&(c=dn(d,u)))),this.meta=mn(d,u),b=(y=c).videoSegments,f=y.audioSegments,this.videoSegments=b,this.audioSegments=f,this.logger.debug("[load moov end!!!!!]"),e.abrupt("return",{meta:this.meta,videoSegments:b,audioSegments:f,responses:s});case 44:case"end":return e.stop()}}),e,this)}))),function(e,t,i){return o.apply(this,arguments)})},{key:"loadCacheMeta",value:function(e,t){var i=cn(e.moov,this._config.segmentDuration),n=i.videoSegments,s=i.audioSegments;this.videoSegments=n,this.audioSegments=s,this._currentSegmentIndex=t,this.meta=e}},{key:"getSegmentByTime",value:function(e){var t,i;return this.videoSegments.length?(t=this.videoSegments.find((function(t){return t.startTime<=e&&t.endTime>e})))&&(i=this.audioSegments[t.index]):i=this.audioSegments.find((function(t){return t.startTime<=e&&t.endTime>e})),{video:t,audio:i}}},{key:"loadSegmentByTime",value:(l=f(Z().mark((function e(t,i){var n,s,a,r,l,o=arguments;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=!(o.length>2&&void 0!==o[2])||o[2],s=o.length>3&&void 0!==o[3]?o[3]:{},this.isMetaLoaded){e.next=5;break}return e.next=5,this.loadMeta(i);case 5:return a=this.getSegmentByTime(t),r=a.video,l=a.audio,e.abrupt("return",this._loadSegment(r,l,i,n,s));case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return l.apply(this,arguments)})},{key:"loadNextSegment",value:(r=f(Z().mark((function e(t){var i,n,s,a,r=arguments;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=!(r.length>1&&void 0!==r[1])||r[1],n=r.length>2&&void 0!==r[2]?r[2]:{},this.isMetaLoaded){e.next=5;break}return e.next=5,this.loadMeta();case 5:return s=this.videoSegments[this._currentSegmentIndex+1],a=this.audioSegments[this._currentSegmentIndex+1],e.abrupt("return",this._loadSegment(s,a,t,i,n));case 8:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"preload",value:(a=f(Z().mark((function e(t){var i,n,s,a,r,l,o,d=this;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isMetaLoaded){e.next=3;break}return e.next=3,this.loadMeta(!0);case 3:if(t&&!(t<0)){e.next=5;break}return e.abrupt("return");case 5:if(i=this.getSegmentByTime(t),n=i.video,s=i.audio,a=Math.max((null==n?void 0:n.index)||0,(null==s?void 0:s.index)||0)){e.next=9;break}return e.abrupt("return");case 9:return r=this.videoSegments.slice(0,a),l=this.audioSegments.slice(0,a),o=function(){var e=f(Z().mark((function e(t){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t>a)){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,d._loadSegment(r[t],l[t],!0,!1);case 4:return e.next=6,o(t+1);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.next=14,o(0);case 14:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"cancel",value:function(){return this._loader.cancel()}},{key:"reset",value:(s=f(Z().mark((function e(){var t=arguments;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.length>0&&void 0!==t[0]&&t[0]){e.next=5;break}return this.logger.debug("[MP4loader reset func call loader.cancel]"),e.next=5,this._loader.cancel();case 5:this.vid=this.url="",this.meta={},this.downloadInfo=[],this.videoSegments=[],this.audioSegments=[],this._currentSegmentIndex=-1,this._currentLoadingSegmentIndex=-1;case 12:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"destroy",value:(n=f(Z().mark((function e(){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.reset();case 2:this.cache.clear();case 3:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"_loadSegment",value:(i=f(Z().mark((function e(t,i,n,s,a){var r,l;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t||i){e.next=2;break}return e.abrupt("return");case 2:return r=(null==t?void 0:t.index)||(null==i?void 0:i.index)||0,this._currentLoadingSegmentIndex=r,e.prev=4,e.next=7,this.loadData([Math.min((null==t?void 0:t.range[0])||1/0,(null==i?void 0:i.range[0])||1/0),Math.max((null==t?void 0:t.range[1])||0,(null==i?void 0:i.range[1])||0)],n,a);case 7:l=e.sent;case 8:return e.prev=8,this._currentLoadingSegmentIndex=-1,e.finish(8);case 11:if(l){e.next=13;break}return e.abrupt("return");case 13:return s&&(this._currentSegmentIndex=r),l.video=t,l.audio=i,e.abrupt("return",l);case 17:case"end":return e.stop()}}),e,this,[[4,,8,11]])}))),function(e,t,n,s,a){return i.apply(this,arguments)})},{key:"loadData",value:(t=f(Z().mark((function e(t,i,n){var s,a,r,l;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=this._getCacheKey(t),e.next=3,this.cache.get(s);case 3:if(a=e.sent){e.next=11;break}return l=n&&n.url?n.url:this.url,e.next=8,this._loader.load(l,p({range:t,vid:this.vid},n));case 8:r=e.sent,e.next=12;break;case 11:r={data:a,state:!0,options:{fromCache:!0,range:t,vid:this.vid}};case 12:if(r){e.next=14;break}return e.abrupt("return");case 14:return a||(r.data&&this.downloadInfo.push({startTime:r.startTime,endTime:r.endTime,size:r.data.byteLength,range:t}),this.downloadInfo&&this.downloadInfo.length>this._config.maxDownloadInfoSize&&(this.downloadInfo=this.downloadInfo.slice(-this._config.maxDownloadInfoSize))),e.abrupt("return",r);case 17:case"end":return e.stop()}}),e,this)}))),function(e,i,n){return t.apply(this,arguments)})},{key:"_getCacheKey",value:function(e){return(this.vid||this.url)+":"+e}}]),h}(j),yn=function(){try{return"undefined"!=typeof localStorage&&"setItem"in window.localStorage&&!!window.localStorage.setItem}catch(e){return!1}}()&&!function(){var e="_localstorage_support_test";try{return window.localStorage.setItem(e,!0),window.localStorage.removeItem(e),!1}catch(t){return!0}}(),bn=fn();function fn(){if(yn)try{return!!window.localStorage.getItem("playerlog")}catch(e){return!1}return!1}function Xn(e){for(var t,i=arguments.length,n=new Array(i>1?i-1:0),s=1;s<i;s++)n[s-1]=arguments[s];bn&&console.log&&(t=console).log.apply(t,["[logger]",rn.nowTime(),e].concat(n))}!function(){if(yn)try{return!!window.localStorage.getItem("playertestlog")}catch(e){return!1}}();var Ln="IWZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIGUoZSx0KXt2YXIgcj1PYmplY3Qua2V5cyhlKTtpZihPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKXt2YXIgYT1PYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGUpO3QmJihhPWEuZmlsdGVyKChmdW5jdGlvbih0KXtyZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihlLHQpLmVudW1lcmFibGV9KSkpLHIucHVzaC5hcHBseShyLGEpfXJldHVybiByfWZ1bmN0aW9uIHQodCl7Zm9yKHZhciByPTE7cjxhcmd1bWVudHMubGVuZ3RoO3IrKyl7dmFyIGE9bnVsbCE9YXJndW1lbnRzW3JdP2FyZ3VtZW50c1tyXTp7fTtyJTI/ZShPYmplY3QoYSksITApLmZvckVhY2goKGZ1bmN0aW9uKGUpe2kodCxlLGFbZV0pfSkpOk9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzP09iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHQsT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMoYSkpOmUoT2JqZWN0KGEpKS5mb3JFYWNoKChmdW5jdGlvbihlKXtPYmplY3QuZGVmaW5lUHJvcGVydHkodCxlLE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoYSxlKSl9KSl9cmV0dXJuIHR9ZnVuY3Rpb24gcihlLHQpe2lmKCEoZSBpbnN0YW5jZW9mIHQpKXRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpfWZ1bmN0aW9uIGEoZSx0KXtmb3IodmFyIHI9MDtyPHQubGVuZ3RoO3IrKyl7dmFyIGE9dFtyXTthLmVudW1lcmFibGU9YS5lbnVtZXJhYmxlfHwhMSxhLmNvbmZpZ3VyYWJsZT0hMCwidmFsdWUiaW4gYSYmKGEud3JpdGFibGU9ITApLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLGsoYS5rZXkpLGEpfX1mdW5jdGlvbiBuKGUsdCxyKXtyZXR1cm4gdCYmYShlLnByb3RvdHlwZSx0KSxyJiZhKGUsciksT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsInByb3RvdHlwZSIse3dyaXRhYmxlOiExfSksZX1mdW5jdGlvbiBpKGUsdCxyKXtyZXR1cm4odD1rKHQpKWluIGU/T2JqZWN0LmRlZmluZVByb3BlcnR5KGUsdCx7dmFsdWU6cixlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMCx3cml0YWJsZTohMH0pOmVbdF09cixlfWZ1bmN0aW9uIHMoZSx0KXtpZigiZnVuY3Rpb24iIT10eXBlb2YgdCYmbnVsbCE9PXQpdGhyb3cgbmV3IFR5cGVFcnJvcigiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24iKTtlLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKHQmJnQucHJvdG90eXBlLHtjb25zdHJ1Y3Rvcjp7dmFsdWU6ZSx3cml0YWJsZTohMCxjb25maWd1cmFibGU6ITB9fSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsInByb3RvdHlwZSIse3dyaXRhYmxlOiExfSksdCYmdShlLHQpfWZ1bmN0aW9uIG8oZSl7cmV0dXJuKG89T2JqZWN0LnNldFByb3RvdHlwZU9mP09iamVjdC5nZXRQcm90b3R5cGVPZi5iaW5kKCk6ZnVuY3Rpb24oZSl7cmV0dXJuIGUuX19wcm90b19ffHxPYmplY3QuZ2V0UHJvdG90eXBlT2YoZSl9KShlKX1mdW5jdGlvbiB1KGUsdCl7cmV0dXJuKHU9T2JqZWN0LnNldFByb3RvdHlwZU9mP09iamVjdC5zZXRQcm90b3R5cGVPZi5iaW5kKCk6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gZS5fX3Byb3RvX189dCxlfSkoZSx0KX1mdW5jdGlvbiBjKCl7aWYoInVuZGVmaW5lZCI9PXR5cGVvZiBSZWZsZWN0fHwhUmVmbGVjdC5jb25zdHJ1Y3QpcmV0dXJuITE7aWYoUmVmbGVjdC5jb25zdHJ1Y3Quc2hhbSlyZXR1cm4hMTtpZigiZnVuY3Rpb24iPT10eXBlb2YgUHJveHkpcmV0dXJuITA7dHJ5e3JldHVybiBCb29sZWFuLnByb3RvdHlwZS52YWx1ZU9mLmNhbGwoUmVmbGVjdC5jb25zdHJ1Y3QoQm9vbGVhbixbXSwoZnVuY3Rpb24oKXt9KSkpLCEwfWNhdGNoKGUpe3JldHVybiExfX1mdW5jdGlvbiBsKGUsdCxyKXtyZXR1cm4obD1jKCk/UmVmbGVjdC5jb25zdHJ1Y3QuYmluZCgpOmZ1bmN0aW9uKGUsdCxyKXt2YXIgYT1bbnVsbF07YS5wdXNoLmFwcGx5KGEsdCk7dmFyIG49bmV3KEZ1bmN0aW9uLmJpbmQuYXBwbHkoZSxhKSk7cmV0dXJuIHImJnUobixyLnByb3RvdHlwZSksbn0pLmFwcGx5KG51bGwsYXJndW1lbnRzKX1mdW5jdGlvbiBmKGUsdCl7aWYodCYmKCJvYmplY3QiPT10eXBlb2YgdHx8ImZ1bmN0aW9uIj09dHlwZW9mIHQpKXJldHVybiB0O2lmKHZvaWQgMCE9PXQpdGhyb3cgbmV3IFR5cGVFcnJvcigiRGVyaXZlZCBjb25zdHJ1Y3RvcnMgbWF5IG9ubHkgcmV0dXJuIG9iamVjdCBvciB1bmRlZmluZWQiKTtyZXR1cm4gZnVuY3Rpb24oZSl7aWYodm9pZCAwPT09ZSl0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpO3JldHVybiBlfShlKX1mdW5jdGlvbiBkKGUpe3ZhciB0PWMoKTtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgcixhPW8oZSk7aWYodCl7dmFyIG49byh0aGlzKS5jb25zdHJ1Y3RvcjtyPVJlZmxlY3QuY29uc3RydWN0KGEsYXJndW1lbnRzLG4pfWVsc2Ugcj1hLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm4gZih0aGlzLHIpfX1mdW5jdGlvbiBoKGUsdCl7Zm9yKDshT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsdCkmJm51bGwhPT0oZT1vKGUpKTspO3JldHVybiBlfWZ1bmN0aW9uIHAoKXtyZXR1cm4gcD0idW5kZWZpbmVkIiE9dHlwZW9mIFJlZmxlY3QmJlJlZmxlY3QuZ2V0P1JlZmxlY3QuZ2V0LmJpbmQoKTpmdW5jdGlvbihlLHQscil7dmFyIGE9aChlLHQpO2lmKGEpe3ZhciBuPU9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoYSx0KTtyZXR1cm4gbi5nZXQ/bi5nZXQuY2FsbChhcmd1bWVudHMubGVuZ3RoPDM/ZTpyKTpuLnZhbHVlfX0scC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9ZnVuY3Rpb24gdihlLHQpe3JldHVybiBmdW5jdGlvbihlKXtpZihBcnJheS5pc0FycmF5KGUpKXJldHVybiBlfShlKXx8ZnVuY3Rpb24oZSx0KXt2YXIgcj1udWxsPT1lP251bGw6InVuZGVmaW5lZCIhPXR5cGVvZiBTeW1ib2wmJmVbU3ltYm9sLml0ZXJhdG9yXXx8ZVsiQEBpdGVyYXRvciJdO2lmKG51bGwhPXIpe3ZhciBhLG4saSxzLG89W10sdT0hMCxjPSExO3RyeXtpZihpPShyPXIuY2FsbChlKSkubmV4dCwwPT09dCl7aWYoT2JqZWN0KHIpIT09cilyZXR1cm47dT0hMX1lbHNlIGZvcig7ISh1PShhPWkuY2FsbChyKSkuZG9uZSkmJihvLnB1c2goYS52YWx1ZSksby5sZW5ndGghPT10KTt1PSEwKTt9Y2F0Y2gobCl7Yz0hMCxuPWx9ZmluYWxseXt0cnl7aWYoIXUmJm51bGwhPXIucmV0dXJuJiYocz1yLnJldHVybigpLE9iamVjdChzKSE9PXMpKXJldHVybn1maW5hbGx5e2lmKGMpdGhyb3cgbn19cmV0dXJuIG99fShlLHQpfHxtKGUsdCl8fGZ1bmN0aW9uKCl7dGhyb3cgbmV3IFR5cGVFcnJvcigiSW52YWxpZCBhdHRlbXB0IHRvIGRlc3RydWN0dXJlIG5vbi1pdGVyYWJsZSBpbnN0YW5jZS5cbkluIG9yZGVyIHRvIGJlIGl0ZXJhYmxlLCBub24tYXJyYXkgb2JqZWN0cyBtdXN0IGhhdmUgYSBbU3ltYm9sLml0ZXJhdG9yXSgpIG1ldGhvZC4iKX0oKX1mdW5jdGlvbiB5KGUpe3JldHVybiBmdW5jdGlvbihlKXtpZihBcnJheS5pc0FycmF5KGUpKXJldHVybiBnKGUpfShlKXx8ZnVuY3Rpb24oZSl7aWYoInVuZGVmaW5lZCIhPXR5cGVvZiBTeW1ib2wmJm51bGwhPWVbU3ltYm9sLml0ZXJhdG9yXXx8bnVsbCE9ZVsiQEBpdGVyYXRvciJdKXJldHVybiBBcnJheS5mcm9tKGUpfShlKXx8bShlKXx8ZnVuY3Rpb24oKXt0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gc3ByZWFkIG5vbi1pdGVyYWJsZSBpbnN0YW5jZS5cbkluIG9yZGVyIHRvIGJlIGl0ZXJhYmxlLCBub24tYXJyYXkgb2JqZWN0cyBtdXN0IGhhdmUgYSBbU3ltYm9sLml0ZXJhdG9yXSgpIG1ldGhvZC4iKX0oKX1mdW5jdGlvbiBtKGUsdCl7aWYoZSl7aWYoInN0cmluZyI9PXR5cGVvZiBlKXJldHVybiBnKGUsdCk7dmFyIHI9T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGUpLnNsaWNlKDgsLTEpO3JldHVybiJPYmplY3QiPT09ciYmZS5jb25zdHJ1Y3RvciYmKHI9ZS5jb25zdHJ1Y3Rvci5uYW1lKSwiTWFwIj09PXJ8fCJTZXQiPT09cj9BcnJheS5mcm9tKGUpOiJBcmd1bWVudHMiPT09cnx8L14oPzpVaXxJKW50KD86OHwxNnwzMikoPzpDbGFtcGVkKT9BcnJheSQvLnRlc3Qocik/ZyhlLHQpOnZvaWQgMH19ZnVuY3Rpb24gZyhlLHQpeyhudWxsPT10fHx0PmUubGVuZ3RoKSYmKHQ9ZS5sZW5ndGgpO2Zvcih2YXIgcj0wLGE9bmV3IEFycmF5KHQpO3I8dDtyKyspYVtyXT1lW3JdO3JldHVybiBhfWZ1bmN0aW9uIGsoZSl7dmFyIHQ9ZnVuY3Rpb24oZSx0KXtpZigib2JqZWN0IiE9dHlwZW9mIGV8fG51bGw9PT1lKXJldHVybiBlO3ZhciByPWVbU3ltYm9sLnRvUHJpbWl0aXZlXTtpZih2b2lkIDAhPT1yKXt2YXIgYT1yLmNhbGwoZSx0fHwiZGVmYXVsdCIpO2lmKCJvYmplY3QiIT10eXBlb2YgYSlyZXR1cm4gYTt0aHJvdyBuZXcgVHlwZUVycm9yKCJAQHRvUHJpbWl0aXZlIG11c3QgcmV0dXJuIGEgcHJpbWl0aXZlIHZhbHVlLiIpfXJldHVybigic3RyaW5nIj09PXQ/U3RyaW5nOk51bWJlcikoZSl9KGUsInN0cmluZyIpO3JldHVybiJzeW1ib2wiPT10eXBlb2YgdD90OlN0cmluZyh0KX12YXIgYj0idmlkZW8iLF89ImF1ZGlvIix3PSJtZXRhZGF0YSIseD0iYXYxIixTPSJhdmMiLEQ9ImhldmMiLEE9ImFhYyIsVD0iZzcxMTBhIixCPSJnNzExMG0iLEU9Im9wdXMiLFU9IkxBUkdFX0FWX1NISUZUIixDPSJMQVJHRV9WSURFT19HQVAiLFA9IkxBUkdFX1ZJREVPX0dBUF9CRVRXRUVOX0NIVU5LIixJPSJMQVJHRV9BVURJT19HQVAiLE09IkFVRElPX0ZJTExFRCIsej0iQVVESU9fRFJPUFBFRCIsTz1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoKXtyKHRoaXMsZSksaSh0aGlzLCJpZCIsMSksaSh0aGlzLCJ0eXBlIixiKSxpKHRoaXMsImNvZGVjVHlwZSIsUyksaSh0aGlzLCJwaWQiLC0xKSxpKHRoaXMsImh2Y0MiLHZvaWQgMCksaSh0aGlzLCJjb2RlYyIsIiIpLGkodGhpcywidGltZXNjYWxlIiwwKSxpKHRoaXMsImZvcm1hdFRpbWVzY2FsZSIsMCksaSh0aGlzLCJzZXF1ZW5jZU51bWJlciIsMCksaSh0aGlzLCJiYXNlTWVkaWFEZWNvZGVUaW1lIiwwKSxpKHRoaXMsImJhc2VEdHMiLDApLGkodGhpcywiZHVyYXRpb24iLDApLGkodGhpcywid2FybmluZ3MiLFtdKSxpKHRoaXMsInNhbXBsZXMiLFtdKSxpKHRoaXMsInBwcyIsW10pLGkodGhpcywic3BzIixbXSksaSh0aGlzLCJ2cHMiLFtdKSxpKHRoaXMsImZwc051bSIsMCksaSh0aGlzLCJmcHNEZW4iLDApLGkodGhpcywic2FyUmF0aW8iLFtdKSxpKHRoaXMsIndpZHRoIiwwKSxpKHRoaXMsImhlaWdodCIsMCksaSh0aGlzLCJuYWxVbml0U2l6ZSIsNCksaSh0aGlzLCJwcmVzZW50IiwhMSksaSh0aGlzLCJpc1ZpZGVvRW5jcnlwdGlvbiIsITEpLGkodGhpcywiaXNBdWRpb0VuY3J5cHRpb24iLCExKSxpKHRoaXMsImlzVmlkZW8iLCEwKSxpKHRoaXMsImxhc3RLZXlGcmFtZUR0cyIsMCksaSh0aGlzLCJraWQiLG51bGwpLGkodGhpcywicHNzaCIsbnVsbCksaSh0aGlzLCJleHQiLHZvaWQgMCl9cmV0dXJuIG4oZSxbe2tleToicmVzZXQiLHZhbHVlOmZ1bmN0aW9uKCl7dGhpcy5zZXF1ZW5jZU51bWJlcj10aGlzLndpZHRoPXRoaXMuaGVpZ2h0PXRoaXMuZnBzRGVuPXRoaXMuZnBzTnVtPXRoaXMuZHVyYXRpb249dGhpcy5iYXNlTWVkaWFEZWNvZGVUaW1lPXRoaXMudGltZXNjYWxlPTAsdGhpcy5jb2RlYz0iIix0aGlzLnByZXNlbnQ9ITEsdGhpcy5waWQ9LTEsdGhpcy5wcHM9W10sdGhpcy5zcHM9W10sdGhpcy52cHM9W10sdGhpcy5zYXJSYXRpbz1bXSx0aGlzLnNhbXBsZXM9W10sdGhpcy53YXJuaW5ncz1bXSx0aGlzLmh2Y0M9bnVsbH19LHtrZXk6ImZpcnN0RHRzIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zYW1wbGVzLmxlbmd0aD90aGlzLnNhbXBsZXNbMF0uZHRzOm51bGx9fSx7a2V5OiJmaXJzdFB0cyIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2FtcGxlcy5sZW5ndGg/dGhpcy5zYW1wbGVzWzBdLnB0czpudWxsfX0se2tleToic2FtcGxlc0R1cmF0aW9uIixnZXQ6ZnVuY3Rpb24oKXtpZih0aGlzLnNhbXBsZXMubGVuZ3RoPjApe3ZhciBlPXRoaXMuc2FtcGxlc1swXSx0PXRoaXMuc2FtcGxlc1t0aGlzLnNhbXBsZXMubGVuZ3RoLTFdO3JldHVybiB0LmR0cy1lLmR0cyt0LmR1cmF0aW9ufXJldHVybiAwfX0se2tleToiZXhpc3QiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuISEvYXYwMS8udGVzdCh0aGlzLmNvZGVjKXx8ISEodGhpcy5wcHMubGVuZ3RoJiZ0aGlzLnNwcy5sZW5ndGgmJnRoaXMuY29kZWMpfX0se2tleToiaGFzU2FtcGxlIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiEhdGhpcy5zYW1wbGVzLmxlbmd0aH19LHtrZXk6ImlzRW5jcnlwdGlvbiIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaXNWaWRlb0VuY3J5cHRpb259fV0pLGV9KCksUj1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoKXtyKHRoaXMsZSksaSh0aGlzLCJpZCIsMiksaSh0aGlzLCJ0eXBlIixfKSxpKHRoaXMsImNvZGVjVHlwZSIsQSksaSh0aGlzLCJwaWQiLC0xKSxpKHRoaXMsImNvZGVjIiwiIiksaSh0aGlzLCJzZXF1ZW5jZU51bWJlciIsMCksaSh0aGlzLCJzYW1wbGVEdXJhdGlvbiIsMCksaSh0aGlzLCJ0aW1lc2NhbGUiLDApLGkodGhpcywiZm9ybWF0VGltZXNjYWxlIiwwKSxpKHRoaXMsImJhc2VNZWRpYURlY29kZVRpbWUiLDApLGkodGhpcywiZHVyYXRpb24iLDApLGkodGhpcywid2FybmluZ3MiLFtdKSxpKHRoaXMsInNhbXBsZXMiLFtdKSxpKHRoaXMsImJhc2VEdHMiLDApLGkodGhpcywic2FtcGxlU2l6ZSIsMTYpLGkodGhpcywic2FtcGxlUmF0ZSIsMCksaSh0aGlzLCJjaGFubmVsQ291bnQiLDApLGkodGhpcywib2JqZWN0VHlwZSIsMCksaSh0aGlzLCJzYW1wbGVSYXRlSW5kZXgiLDApLGkodGhpcywiY29uZmlnIixbXSksaSh0aGlzLCJwcmVzZW50IiwhMSksaSh0aGlzLCJpc1ZpZGVvRW5jcnlwdGlvbiIsITEpLGkodGhpcywiaXNBdWRpb0VuY3J5cHRpb24iLCExKSxpKHRoaXMsImtpZCIsbnVsbCksaSh0aGlzLCJleHQiLHZvaWQgMCl9cmV0dXJuIG4oZSxbe2tleToicmVzZXQiLHZhbHVlOmZ1bmN0aW9uKCl7dGhpcy5zZXF1ZW5jZU51bWJlcj0wLHRoaXMudGltZXNjYWxlPTAsdGhpcy5zYW1wbGVEdXJhdGlvbj0wLHRoaXMuc2FtcGxlUmF0ZT0wLHRoaXMuY2hhbm5lbENvdW50PTAsdGhpcy5iYXNlTWVkaWFEZWNvZGVUaW1lPTAsdGhpcy5wcmVzZW50PSExLHRoaXMucGlkPS0xLHRoaXMuY29kZWM9IiIsdGhpcy5zYW1wbGVzPVtdLHRoaXMuY29uZmlnPVtdLHRoaXMud2FybmluZ3M9W119fSx7a2V5OiJleGlzdCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4hKCEodGhpcy5zYW1wbGVSYXRlJiZ0aGlzLmNoYW5uZWxDb3VudCYmdGhpcy5jb2RlYyl8fHRoaXMuY29kZWNUeXBlIT09QSYmdGhpcy5jb2RlY1R5cGUhPT1UJiZ0aGlzLmNvZGVjVHlwZSE9PUImJnRoaXMuY29kZWNUeXBlIT09RSl9fSx7a2V5OiJoYXNTYW1wbGUiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuISF0aGlzLnNhbXBsZXMubGVuZ3RofX0se2tleToiaXNFbmNyeXB0aW9uIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pc0F1ZGlvRW5jcnlwdGlvbn19LHtrZXk6ImZpcnN0RHRzIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zYW1wbGVzLmxlbmd0aD90aGlzLnNhbXBsZXNbMF0uZHRzOm51bGx9fSx7a2V5OiJmaXJzdFB0cyIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2FtcGxlcy5sZW5ndGg/dGhpcy5zYW1wbGVzWzBdLnB0czpudWxsfX0se2tleToic2FtcGxlc0R1cmF0aW9uIixnZXQ6ZnVuY3Rpb24oKXtpZih0aGlzLnNhbXBsZXMubGVuZ3RoPjApe3ZhciBlPXRoaXMuc2FtcGxlc1swXSx0PXRoaXMuc2FtcGxlc1t0aGlzLnNhbXBsZXMubGVuZ3RoLTFdO3JldHVybiB0LmR0cy1lLmR0cyt0LmR1cmF0aW9ufXJldHVybiAwfX1dKSxlfSgpLEw9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHQsYSxuKXtyKHRoaXMsZSksaSh0aGlzLCJmbGFnIix7fSksaSh0aGlzLCJrZXlmcmFtZSIsITEpLGkodGhpcywiZ29wSWQiLDApLGkodGhpcywiZHVyYXRpb24iLDApLGkodGhpcywic2l6ZSIsMCksaSh0aGlzLCJ1bml0cyIsW10pLGkodGhpcywiY2hyb21hRm9ybWF0Iiw0MjApLHRoaXMub3JpZ2luUHRzPXRoaXMucHRzPXQsdGhpcy5vcmlnaW5EdHM9dGhpcy5kdHM9YSxuJiYodGhpcy51bml0cz1uKX1yZXR1cm4gbihlLFt7a2V5OiJjdHMiLGdldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnB0cy10aGlzLmR0c319LHtrZXk6InNldFRvS2V5ZnJhbWUiLHZhbHVlOmZ1bmN0aW9uKCl7dGhpcy5rZXlmcmFtZT0hMCx0aGlzLmZsYWcuZGVwZW5kc09uPTIsdGhpcy5mbGFnLmlzTm9uU3luY1NhbXBsZT0wfX1dKSxlfSgpLFY9bigoZnVuY3Rpb24gZSh0LGEsbixzKXtyKHRoaXMsZSksaSh0aGlzLCJkdXJhdGlvbiIsMTAyNCksaSh0aGlzLCJmbGFnIix7ZGVwZW5kc09uOjIsaXNOb25TeW5jU2FtcGxlOjB9KSxpKHRoaXMsImtleWZyYW1lIiwhMCksdGhpcy5vcmlnaW5QdHM9dGhpcy5wdHM9dGhpcy5kdHM9dCx0aGlzLmRhdGE9YSx0aGlzLnNpemU9YS5ieXRlTGVuZ3RoLHRoaXMuc2FtcGxlT2Zmc2V0PXMsbiYmKHRoaXMuZHVyYXRpb249bil9KSksRj1uKChmdW5jdGlvbiBlKHQsYSl7cih0aGlzLGUpLGkodGhpcywidGltZSIsMCksdGhpcy5kYXRhPXQsdGhpcy5vcmlnaW5QdHM9dGhpcy5wdHM9YX0pKSxOPWZ1bmN0aW9uKGUpe3MoYSxlKTt2YXIgdD1kKGEpO2Z1bmN0aW9uIGEoKXtyZXR1cm4gcih0aGlzLGEpLHQuYXBwbHkodGhpcyxhcmd1bWVudHMpfXJldHVybiBuKGEpfShGKSxqPWZ1bmN0aW9uKGUpe3MoYSxlKTt2YXIgdD1kKGEpO2Z1bmN0aW9uIGEoKXtyZXR1cm4gcih0aGlzLGEpLHQuYXBwbHkodGhpcyxhcmd1bWVudHMpfXJldHVybiBuKGEpfShGKSxHPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSgpe3IodGhpcyxlKSxpKHRoaXMsImlkIiwzKSxpKHRoaXMsInR5cGUiLHcpLGkodGhpcywidGltZXNjYWxlIiwwKSxpKHRoaXMsImZsdlNjcmlwdFNhbXBsZXMiLFtdKSxpKHRoaXMsInNlaVNhbXBsZXMiLFtdKX1yZXR1cm4gbihlLFt7a2V5OiJleGlzdCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4hKCF0aGlzLmZsdlNjcmlwdFNhbXBsZXMubGVuZ3RoJiYhdGhpcy5zZWlTYW1wbGVzLmxlbmd0aHx8IXRoaXMudGltZXNjYWxlKX19LHtrZXk6InJlc2V0Iix2YWx1ZTpmdW5jdGlvbigpe3RoaXMudGltZXNjYWxlPTAsdGhpcy5mbHZTY3JpcHRTYW1wbGVzPVtdLHRoaXMuc2VpU2FtcGxlcz1bXX19LHtrZXk6Imhhc1NhbXBsZSIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4hKCF0aGlzLmZsdlNjcmlwdFNhbXBsZXMubGVuZ3RoJiYhdGhpcy5zZWlTYW1wbGVzLmxlbmd0aCl9fV0pLGV9KCksSD1mdW5jdGlvbigpe2Z1bmN0aW9uIGUodCl7aWYocih0aGlzLGUpLGkodGhpcywiX2J5dGVzQXZhaWxhYmxlIix2b2lkIDApLGkodGhpcywiX2JpdHNBdmFpbGFibGUiLDApLGkodGhpcywiX3dvcmQiLDApLCF0KXRocm93IG5ldyBFcnJvcigiRXhwR29sb21iIGRhdGEgcGFyYW1zIGlzIHJlcXVpcmVkIik7dGhpcy5fZGF0YT10LHRoaXMuX2J5dGVzQXZhaWxhYmxlPXQuYnl0ZUxlbmd0aCx0aGlzLl9ieXRlc0F2YWlsYWJsZSYmdGhpcy5fbG9hZFdvcmQoKX1yZXR1cm4gbihlLFt7a2V5OiJiaXRzQXZhaWxhYmxlIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fYml0c0F2YWlsYWJsZX19LHtrZXk6Il9sb2FkV29yZCIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLl9kYXRhLmJ5dGVMZW5ndGgtdGhpcy5fYnl0ZXNBdmFpbGFibGUsdD1NYXRoLm1pbig0LHRoaXMuX2J5dGVzQXZhaWxhYmxlKTtpZigwPT09dCl0aHJvdyBuZXcgRXJyb3IoIk5vIGJ5dGVzIGF2YWlsYWJsZSIpO3ZhciByPW5ldyBVaW50OEFycmF5KDQpO3Iuc2V0KHRoaXMuX2RhdGEuc3ViYXJyYXkoZSxlK3QpKSx0aGlzLl93b3JkPW5ldyBEYXRhVmlldyhyLmJ1ZmZlcikuZ2V0VWludDMyKDApLHRoaXMuX2JpdHNBdmFpbGFibGU9OCp0LHRoaXMuX2J5dGVzQXZhaWxhYmxlLT10fX0se2tleToic2tpcEJpdHMiLHZhbHVlOmZ1bmN0aW9uKGUpe2lmKHRoaXMuX2JpdHNBdmFpbGFibGU+ZSl0aGlzLl93b3JkPDw9ZSx0aGlzLl9iaXRzQXZhaWxhYmxlLT1lO2Vsc2V7ZS09dGhpcy5fYml0c0F2YWlsYWJsZTt2YXIgdD1NYXRoLmZsb29yKGUvOCk7ZS09OCp0LHRoaXMuX2J5dGVzQXZhaWxhYmxlLT10LHRoaXMuX2xvYWRXb3JkKCksdGhpcy5fd29yZDw8PWUsdGhpcy5fYml0c0F2YWlsYWJsZS09ZX19fSx7a2V5OiJyZWFkQml0cyIsdmFsdWU6ZnVuY3Rpb24oZSl7aWYoZT4zMil0aHJvdyBuZXcgRXJyb3IoIkNhbm5vdCByZWFkIG1vcmUgdGhhbiAzMiBiaXRzIik7dmFyIHQ9TWF0aC5taW4odGhpcy5fYml0c0F2YWlsYWJsZSxlKSxyPXRoaXMuX3dvcmQ+Pj4zMi10O3JldHVybiB0aGlzLl9iaXRzQXZhaWxhYmxlLT10LHRoaXMuX2JpdHNBdmFpbGFibGU+MD90aGlzLl93b3JkPDw9dDp0aGlzLl9ieXRlc0F2YWlsYWJsZT4wJiZ0aGlzLl9sb2FkV29yZCgpLCh0PWUtdCk+MCYmdGhpcy5fYml0c0F2YWlsYWJsZT9yPDx0fHRoaXMucmVhZEJpdHModCk6cn19LHtrZXk6InNraXBMWiIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZTtmb3IoZT0wO2U8dGhpcy5fYml0c0F2YWlsYWJsZTsrK2UpaWYoMCE9KHRoaXMuX3dvcmQmMjE0NzQ4MzY0OD4+PmUpKXJldHVybiB0aGlzLl93b3JkPDw9ZSx0aGlzLl9iaXRzQXZhaWxhYmxlLT1lLGU7cmV0dXJuIHRoaXMuX2xvYWRXb3JkKCksZSt0aGlzLnNraXBMWigpfX0se2tleToic2tpcFVFRyIsdmFsdWU6ZnVuY3Rpb24oKXt0aGlzLnNraXBCaXRzKDErdGhpcy5za2lwTFooKSl9fSx7a2V5OiJyZWFkVUVHIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXMuc2tpcExaKCk7cmV0dXJuIHRoaXMucmVhZEJpdHMoZSsxKS0xfX0se2tleToicmVhZEVHIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXRoaXMucmVhZFVFRygpO3JldHVybiAxJmU/MStlPj4+MTotMSooZT4+PjEpfX0se2tleToicmVhZEJvb2wiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIDE9PT10aGlzLnJlYWRCaXRzKDEpfX0se2tleToicmVhZFVCeXRlIix2YWx1ZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLnJlYWRCaXRzKDgpfX0se2tleToic2tpcFNjYWxpbmdMaXN0Iix2YWx1ZTpmdW5jdGlvbihlKXtmb3IodmFyIHQ9OCxyPTgsYT0wO2E8ZTthKyspMCE9PXImJihyPSh0K3RoaXMucmVhZEVHKCkrMjU2KSUyNTYpLHQ9MD09PXI/dDpyfX1dKSxlfSgpLEs9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHQpe3IodGhpcyxlKSx0aGlzLm5hbWU9dHx8IiIsdGhpcy5fcHJlZml4PSJbIi5jb25jYXQodGhpcy5uYW1lLCJdIil9cmV0dXJuIG4oZSxbe2tleToid2FybiIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgdDtpZighZS5kaXNhYmxlZCl7Zm9yKHZhciByPWFyZ3VtZW50cy5sZW5ndGgsYT1uZXcgQXJyYXkociksbj0wO248cjtuKyspYVtuXT1hcmd1bWVudHNbbl07KHQ9Y29uc29sZSkud2Fybi5hcHBseSh0LFt0aGlzLl9wcmVmaXhdLmNvbmNhdChhKSl9fX1dLFt7a2V5OiJlbmFibGUiLHZhbHVlOmZ1bmN0aW9uKCl7ZS5kaXNhYmxlZD0hMX19LHtrZXk6ImRpc2FibGUiLHZhbHVlOmZ1bmN0aW9uKCl7ZS5kaXNhYmxlZD0hMH19XSksZX0oKTtpKEssImRpc2FibGVkIiwhMCk7dmFyIHE9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7cih0aGlzLGUpfXJldHVybiBuKGUsbnVsbCxbe2tleToiZGVjb2RlIix2YWx1ZTpmdW5jdGlvbih0KXtmb3IodmFyIHI9W10sYT10LG49MCxpPXQubGVuZ3RoO248aTspaWYoYVtuXTwxMjgpci5wdXNoKFN0cmluZy5mcm9tQ2hhckNvZGUoYVtuXSkpLCsrbjtlbHNle2lmKGFbbl08MTkyKTtlbHNlIGlmKGFbbl08MjI0KXtpZihlLl9jaGVja0NvbnRpbnVhdGlvbihhLG4sMSkpe3ZhciBzPSgzMSZhW25dKTw8Nnw2MyZhW24rMV07aWYocz49MTI4KXtyLnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZSg2NTUzNSZzKSksbis9Mjtjb250aW51ZX19fWVsc2UgaWYoYVtuXTwyNDApe2lmKGUuX2NoZWNrQ29udGludWF0aW9uKGEsbiwyKSl7dmFyIG89KDE1JmFbbl0pPDwxMnwoNjMmYVtuKzFdKTw8Nnw2MyZhW24rMl07aWYobz49MjA0OCYmNTUyOTYhPSg2MzQ4OCZvKSl7ci5wdXNoKFN0cmluZy5mcm9tQ2hhckNvZGUoNjU1MzUmbykpLG4rPTM7Y29udGludWV9fX1lbHNlIGlmKGFbbl08MjQ4JiZlLl9jaGVja0NvbnRpbnVhdGlvbihhLG4sMykpe3ZhciB1PSg3JmFbbl0pPDwxOHwoNjMmYVtuKzFdKTw8MTJ8KDYzJmFbbisyXSk8PDZ8NjMmYVtuKzNdO2lmKHU+NjU1MzYmJnU8MTExNDExMil7dS09NjU1MzYsci5wdXNoKFN0cmluZy5mcm9tQ2hhckNvZGUodT4+PjEwfDU1Mjk2KSksci5wdXNoKFN0cmluZy5mcm9tQ2hhckNvZGUoMTAyMyZ1fDU2MzIwKSksbis9NDtjb250aW51ZX19ci5wdXNoKFN0cmluZy5mcm9tQ2hhckNvZGUoNjU1MzMpKSwrK259cmV0dXJuIHIuam9pbigiIil9fSx7a2V5OiJfY2hlY2tDb250aW51YXRpb24iLHZhbHVlOmZ1bmN0aW9uKGUsdCxyKXt2YXIgYT1lO2lmKHQrcjxhLmxlbmd0aCl7Zm9yKDtyLS07KWlmKDEyOCE9KDE5MiZhWysrdF0pKXJldHVybiExO3JldHVybiEwfXJldHVybiExfX1dKSxlfSgpLFc9InVuZGVmaW5lZCIhPXR5cGVvZiB3aW5kb3csWD1XJiZuYXZpZ2F0b3IudXNlckFnZW50LnRvTG9jYWxlTG93ZXJDYXNlKCksWT1XJiYvXigoPyFjaHJvbWV8YW5kcm9pZCkuKSpzYWZhcmkvLnRlc3QoWCksWj1XJiZYLmluY2x1ZGVzKCJmaXJlZm94IiksUT1XJiZYLmluY2x1ZGVzKCJhbmRyb2lkIik7ZnVuY3Rpb24gSigpe2Zvcih2YXIgZT1hcmd1bWVudHMubGVuZ3RoLHQ9bmV3IEFycmF5KGUpLHI9MDtyPGU7cisrKXRbcl09YXJndW1lbnRzW3JdO3Q9dC5maWx0ZXIoQm9vbGVhbik7dmFyIGE9bmV3IFVpbnQ4QXJyYXkodC5yZWR1Y2UoKGZ1bmN0aW9uKGUsdCl7cmV0dXJuIGUrdC5ieXRlTGVuZ3RofSksMCkpLG49MDtyZXR1cm4gdC5mb3JFYWNoKChmdW5jdGlvbihlKXthLnNldChlLG4pLG4rPWUuYnl0ZUxlbmd0aH0pKSxhfXZhciAkPU1hdGgucG93KDIsMzIpO2Z1bmN0aW9uIGVlKGUpe3ZhciB0PWFyZ3VtZW50cy5sZW5ndGg+MSYmdm9pZCAwIT09YXJndW1lbnRzWzFdP2FyZ3VtZW50c1sxXTowO3JldHVybihlW3RdPDw4KSsoZVt0KzFdfHwwKX1mdW5jdGlvbiB0ZShlKXt2YXIgdD1hcmd1bWVudHMubGVuZ3RoPjEmJnZvaWQgMCE9PWFyZ3VtZW50c1sxXT9hcmd1bWVudHNbMV06MDtyZXR1cm4oZVt0XTw8MjQ+Pj4wKSsoZVt0KzFdPDwxNikrKGVbdCsyXTw8OCkrKGVbdCszXXx8MCl9ZnVuY3Rpb24gcmUoZSl7dmFyIHQ9YXJndW1lbnRzLmxlbmd0aD4xJiZ2b2lkIDAhPT1hcmd1bWVudHNbMV0/YXJndW1lbnRzWzFdOjA7cmV0dXJuIHRlKGUsdCkqJCt0ZShlLHQrNCl9ZnVuY3Rpb24gYWUoZSl7Zm9yKHZhciB0LHI9ImF2YzEuIixhPTA7YTwzO2ErKykodD1lW2FdLnRvU3RyaW5nKDE2KSkubGVuZ3RoPDImJih0PSIwIi5jb25jYXQodCkpLHIrPXQ7cmV0dXJuIHJ9ZnVuY3Rpb24gbmUoZSl7dmFyIHQ9IiI7aWYoZS5mb3JFYWNoKChmdW5jdGlvbihlKXt0Kz1mdW5jdGlvbihlKXtyZXR1cm4oIjAiK051bWJlcihlKS50b1N0cmluZygxNikpLnNsaWNlKC0yKS50b1VwcGVyQ2FzZSgpfShlKX0pKSx0Lmxlbmd0aDw9MzIpZm9yKHZhciByPTMyLXQubGVuZ3RoLGE9MDthPHI7YSsrKXQrPSIwIjtyZXR1cm4gdH1mdW5jdGlvbiBpZShlKXtpZighQXJyYXkuaXNBcnJheShlKSl7Zm9yKHZhciB0PVtdLHI9IiIsYT0wO2E8ZS5sZW5ndGg7YSsrKWElMiYmKHI9ZVthLTFdK2VbYV0sdC5wdXNoKHBhcnNlSW50KHIsMTYpKSxyPSIiKTtyZXR1cm4gdH1yZXR1cm4gZS5tYXAoKGZ1bmN0aW9uKGUpe3JldHVybiBwYXJzZUludChlLDE2KX0pKX1mdW5jdGlvbiBzZShlLHQpe3JldHVybiBOdW1iZXIoZSsiLiIrdCl9dmFyIG9lPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSgpe3IodGhpcyxlKX1yZXR1cm4gbihlLG51bGwsW3trZXk6ImdldFJhdGVJbmRleEJ5UmF0ZSIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIGUuRlJFUS5pbmRleE9mKHQpfX0se2tleToicGFyc2VBRFRTIix2YWx1ZTpmdW5jdGlvbih0LHIpe2Zvcih2YXIgYT10Lmxlbmd0aCxuPTA7bisyPGEmJigyNTUhPT10W25dfHwyNDAhPSgyNDYmdFtuKzFdKSk7KW4rKztpZighKG4+PWEpKXt2YXIgaT1uLHM9W10sbz0oNjAmdFtuKzJdKT4+PjIsdT1lLkZSRVFbb107aWYoIXUpdGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIHNhbXBsaW5nIGluZGV4OiAiLmNvbmNhdChvKSk7Zm9yKHZhciBjLGwsZj0xKygoMTkyJnRbbisyXSk+Pj42KSxkPSgxJnRbbisyXSk8PDJ8KDE5MiZ0W24rM10pPj4+NixoPWUuX2dldENvbmZpZyhvLGQsZikscD1oLmNvbmZpZyx2PWguY29kZWMseT0wLG09ZS5nZXRGcmFtZUR1cmF0aW9uKHUpO24rNzxhOylpZigyNTU9PT10W25dJiYyNDA9PSgyNDYmdFtuKzFdKSl7aWYoIShsPSgzJnRbbiszXSk8PDExfHRbbis0XTw8M3woMjI0JnRbbis1XSk+PjUpfHxhLW48bClicmVhaztjPTIqKDEmfnRbbisxXSkscy5wdXNoKHtwdHM6cit5Km0sZGF0YTp0LnN1YmFycmF5KG4rNytjLG4rbCl9KSx5Kyssbis9bH1lbHNlIG4rKztyZXR1cm57c2tpcDppLHJlbWFpbmluZzpuPj1hP3ZvaWQgMDp0LnN1YmFycmF5KG4pLGZyYW1lczpzLHNhbXBsaW5nRnJlcXVlbmN5SW5kZXg6byxzYW1wbGVSYXRlOnUsb2JqZWN0VHlwZTpmLGNoYW5uZWxDb3VudDpkLGNvZGVjOnYsY29uZmlnOnAsb3JpZ2luQ29kZWM6Im1wNGEuNDAuIi5jb25jYXQoZil9fX19LHtrZXk6InBhcnNlQXVkaW9TcGVjaWZpY0NvbmZpZyIsdmFsdWU6ZnVuY3Rpb24odCl7aWYodC5sZW5ndGgpe3ZhciByPXRbMF0+Pj4zLGE9KDcmdFswXSk8PDF8dFsxXT4+Pjcsbj0oMTIwJnRbMV0pPj4+MyxpPWUuRlJFUVthXTtpZihpKXt2YXIgcz1lLl9nZXRDb25maWcoYSxuLHIpO3JldHVybntzYW1wbGluZ0ZyZXF1ZW5jeUluZGV4OmEsc2FtcGxlUmF0ZTppLG9iamVjdFR5cGU6cixjaGFubmVsQ291bnQ6bixjb25maWc6cy5jb25maWcsY29kZWM6cy5jb2RlYyxvcmlnaW5Db2RlYzoibXA0YS40MC4iLmNvbmNhdChyKX19fX19LHtrZXk6ImdldEZyYW1lRHVyYXRpb24iLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PWFyZ3VtZW50cy5sZW5ndGg+MSYmdm9pZCAwIT09YXJndW1lbnRzWzFdP2FyZ3VtZW50c1sxXTo5ZTQ7cmV0dXJuIDEwMjQqdC9lfX0se2tleToiX2dldENvbmZpZyIsdmFsdWU6ZnVuY3Rpb24oZSx0LHIpe3ZhciBhLG4saT1bXTtyZXR1cm4gWj9lPj02PyhhPTUsbj1lLTMpOihhPTIsbj1lKTpRPyhhPTIsbj1lKTooYT0yPT09cnx8NT09PXI/cjo1LG49ZSxlPj02P249ZS0zOjE9PT10JiYoYT0yLG49ZSkpLGlbMF09YTw8MyxpWzBdfD0oMTQmZSk+PjEsaVsxXT0oMSZlKTw8NyxpWzFdfD10PDwzLDU9PT1hJiYoaVsxXXw9KDE0Jm4pPj4xLGlbMl09KDEmbik8PDcsaVsyXXw9OCxpWzNdPTApLHtjb25maWc6aSxjb2RlYzoibXA0YS40MC4iLmNvbmNhdChhKX19fSx7a2V5OiJnZXRTaWxlbnRGcmFtZSIsdmFsdWU6ZnVuY3Rpb24oZSx0KXtpZigibXA0YS40MC4yIj09PWUpe2lmKDE9PT10KXJldHVybiBuZXcgVWludDhBcnJheShbMCwyMDAsMCwxMjgsMzUsMTI4XSk7aWYoMj09PXQpcmV0dXJuIG5ldyBVaW50OEFycmF5KFszMywwLDczLDE0NCwyLDI1LDAsMzUsMTI4XSk7aWYoMz09PXQpcmV0dXJuIG5ldyBVaW50OEFycmF5KFswLDIwMCwwLDEyOCwzMiwxMzIsMSwzOCw2NCw4LDEwMCwwLDE0Ml0pO2lmKDQ9PT10KXJldHVybiBuZXcgVWludDhBcnJheShbMCwyMDAsMCwxMjgsMzIsMTMyLDEsMzgsNjQsOCwxMDAsMCwxMjgsNDQsMTI4LDgsMiw1Nl0pO2lmKDU9PT10KXJldHVybiBuZXcgVWludDhBcnJheShbMCwyMDAsMCwxMjgsMzIsMTMyLDEsMzgsNjQsOCwxMDAsMCwxMzAsNDgsNCwxNTMsMCwzMywxNDQsMiw1Nl0pO2lmKDY9PT10KXJldHVybiBuZXcgVWludDhBcnJheShbMCwyMDAsMCwxMjgsMzIsMTMyLDEsMzgsNjQsOCwxMDAsMCwxMzAsNDgsNCwxNTMsMCwzMywxNDQsMiwwLDE3OCwwLDMyLDgsMjI0XSl9ZWxzZXtpZigxPT09dClyZXR1cm4gbmV3IFVpbnQ4QXJyYXkoWzEsNjQsMzQsMTI4LDE2Myw3OCwyMzAsMTI4LDE4Niw4LDAsMCwwLDI4LDYsMjQxLDE5MywxMCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5MCw5NF0pO2lmKDI9PT10KXJldHVybiBuZXcgVWludDhBcnJheShbMSw2NCwzNCwxMjgsMTYzLDk0LDIzMCwxMjgsMTg2LDgsMCwwLDAsMCwxNDksMCw2LDI0MSwxNjEsMTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTAsOTRdKTtpZigzPT09dClyZXR1cm4gbmV3IFVpbnQ4QXJyYXkoWzEsNjQsMzQsMTI4LDE2Myw5NCwyMzAsMTI4LDE4Niw4LDAsMCwwLDAsMTQ5LDAsNiwyNDEsMTYxLDEwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDkwLDk0XSl9fX1dKSxlfSgpO2kob2UsIkZSRVEiLFs5NmUzLDg4MjAwLDY0ZTMsNDhlMyw0NDEwMCwzMmUzLDI0ZTMsMjIwNTAsMTZlMywxMmUzLDExMDI1LDhlMyw3MzUwXSk7dmFyIHVlPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSgpe3IodGhpcyxlKX1yZXR1cm4gbihlLG51bGwsW3trZXk6InBhcnNlQW5uZXhCIix2YWx1ZTpmdW5jdGlvbihlKXtmb3IodmFyIHQ9ZS5sZW5ndGgscj0yLGE9MDtudWxsIT09ZVtyXSYmdm9pZCAwIT09ZVtyXSYmMSE9PWVbcl07KXIrKztpZigoYT0rK3IrMik+PXQpcmV0dXJuW107Zm9yKHZhciBuPVtdO2E8dDspc3dpdGNoKGVbYV0pe2Nhc2UgMDppZigwIT09ZVthLTFdKXthKz0yO2JyZWFrfWlmKDAhPT1lW2EtMl0pe2ErKzticmVha31yIT09YS0yJiZuLnB1c2goZS5zdWJhcnJheShyLGEtMikpO2Rve2ErK313aGlsZSgxIT09ZVthXSYmYTx0KTthPShyPWErMSkrMjticmVhaztjYXNlIDE6aWYoMCE9PWVbYS0xXXx8MCE9PWVbYS0yXSl7YSs9MzticmVha31yIT09YS0yJiZuLnB1c2goZS5zdWJhcnJheShyLGEtMikpLGE9KHI9YSsxKSsyO2JyZWFrO2RlZmF1bHQ6YSs9M31yZXR1cm4gcjx0JiZuLnB1c2goZS5zdWJhcnJheShyKSksbn19LHtrZXk6InBhcnNlQXZjQyIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9YXJndW1lbnRzLmxlbmd0aD4xJiZ2b2lkIDAhPT1hcmd1bWVudHNbMV0/YXJndW1lbnRzWzFdOjQ7aWYoIShlLmxlbmd0aDw0KSl7Zm9yKHZhciByLGE9ZS5sZW5ndGgsbj1bXSxpPTA7aSt0PGE7KWlmKHI9dGUoZSxpKSwzPT09dCYmKHI+Pj49OCksaSs9dCxyKXtpZihpK3I+YSlicmVhaztuLnB1c2goZS5zdWJhcnJheShpLGkrcikpLGkrPXJ9cmV0dXJuIG59fX0se2tleToicGFyc2VTRUkiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7Zm9yKHZhciByPWUubGVuZ3RoLGE9dD8yOjEsbj0wLGk9MCxzPSIiOzI1NT09PWVbYV07KW4rPTI1NSxhKys7Zm9yKG4rPWVbYSsrXTsyNTU9PT1lW2FdOylpKz0yNTUsYSsrO2lmKGkrPWVbYSsrXSw1PT09biYmcj5hKzE2KWZvcih2YXIgbz0wO288MTY7bysrKXMrPWVbYV0udG9TdHJpbmcoMTYpLGErKztyZXR1cm57cGF5bG9hZDplLnN1YmFycmF5KGEsYStpKSx0eXBlOm4sc2l6ZTppLHV1aWQ6c319fSx7a2V5OiJyZW1vdmVFUEIiLHZhbHVlOmZ1bmN0aW9uKGUpe2Zvcih2YXIgdD1lLmJ5dGVMZW5ndGgscj1bXSxhPTE7YTx0LTI7KTA9PT1lW2FdJiYwPT09ZVthKzFdJiYzPT09ZVthKzJdPyhyLnB1c2goYSsyKSxhKz0yKTphKys7aWYoIXIubGVuZ3RoKXJldHVybiBlO3ZhciBuPXQtci5sZW5ndGgsaT1uZXcgVWludDhBcnJheShuKSxzPTA7Zm9yKGE9MDthPG47cysrLGErKylzPT09clswXSYmKHMrKyxyLnNoaWZ0KCkpLGlbYV09ZVtzXTtyZXR1cm4gaX19XSksZX0oKSxjZT1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoKXtyKHRoaXMsZSl9cmV0dXJuIG4oZSxudWxsLFt7a2V5OiJwYXJzZUFWQ0RlY29kZXJDb25maWd1cmF0aW9uUmVjb3JkIix2YWx1ZTpmdW5jdGlvbih0KXtpZighKHQubGVuZ3RoPDcpKXtmb3IodmFyIHIsYSxuPTErKDMmdFs0XSksaT1bXSxzPVtdLG89Nix1PTMxJnRbNV0sYz0wO2M8dTtjKyspaWYoYT10W29dPDw4fHRbbysxXSxvKz0yLGEpe3ZhciBsPXQuc3ViYXJyYXkobyxvK2EpO28rPWEsaS5wdXNoKGwpLHJ8fChyPWUucGFyc2VTUFModWUucmVtb3ZlRVBCKGwpKSl9dmFyIGYsZD10W29dO28rKztmb3IodmFyIGg9MDtoPGQ7aCsrKWY9dFtvXTw8OHx0W28rMV0sbys9MixmJiYocy5wdXNoKHQuc3ViYXJyYXkobyxvK2YpKSxvKz1mKTtyZXR1cm57c3BzOnIsc3BzQXJyOmkscHBzQXJyOnMsbmFsVW5pdFNpemU6bn19fX0se2tleToicGFyc2VTUFMiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PW5ldyBIKGUpO3QucmVhZFVCeXRlKCk7dmFyIHI9dC5yZWFkVUJ5dGUoKSxhPXQucmVhZFVCeXRlKCksbj10LnJlYWRVQnl0ZSgpO3Quc2tpcFVFRygpO3ZhciBpPTQyMDtpZigxMDA9PT1yfHwxMTA9PT1yfHwxMjI9PT1yfHwyNDQ9PT1yfHw0ND09PXJ8fDgzPT09cnx8ODY9PT1yfHwxMTg9PT1yfHwxMjg9PT1yfHwxMzg9PT1yfHwxNDQ9PT1yKXt2YXIgcz10LnJlYWRVRUcoKTtpZihzPD0zJiYoaT1bMCw0MjAsNDIyLDQ0NF1bc10pLDM9PT1zJiZ0LnNraXBCaXRzKDEpLHQuc2tpcFVFRygpLHQuc2tpcFVFRygpLHQuc2tpcEJpdHMoMSksdC5yZWFkQm9vbCgpKWZvcih2YXIgbz0zIT09cz84OjEyLHU9MDt1PG87dSsrKXQucmVhZEJvb2woKSYmKHU8Nj90LnNraXBTY2FsaW5nTGlzdCgxNik6dC5za2lwU2NhbGluZ0xpc3QoNjQpKX10LnNraXBVRUcoKTt2YXIgYz10LnJlYWRVRUcoKTtpZigwPT09Yyl0LnJlYWRVRUcoKTtlbHNlIGlmKDE9PT1jKXt0LnNraXBCaXRzKDEpLHQuc2tpcFVFRygpLHQuc2tpcFVFRygpO2Zvcih2YXIgbD10LnJlYWRVRUcoKSxmPTA7ZjxsO2YrKyl0LnNraXBVRUcoKX10LnNraXBVRUcoKSx0LnNraXBCaXRzKDEpO3ZhciBkPXQucmVhZFVFRygpLGg9dC5yZWFkVUVHKCkscD10LnJlYWRCaXRzKDEpOzA9PT1wJiZ0LnNraXBCaXRzKDEpLHQuc2tpcEJpdHMoMSk7dmFyIHYseSxtLGcsayxiPTAsXz0wLHc9MCx4PTA7aWYodC5yZWFkQm9vbCgpJiYoYj10LnJlYWRVRUcoKSxfPXQucmVhZFVFRygpLHc9dC5yZWFkVUVHKCkseD10LnJlYWRVRUcoKSksdC5yZWFkQm9vbCgpKXtpZih0LnJlYWRCb29sKCkpc3dpdGNoKHQucmVhZFVCeXRlKCkpe2Nhc2UgMTp2PVsxLDFdO2JyZWFrO2Nhc2UgMjp2PVsxMiwxMV07YnJlYWs7Y2FzZSAzOnY9WzEwLDExXTticmVhaztjYXNlIDQ6dj1bMTYsMTFdO2JyZWFrO2Nhc2UgNTp2PVs0MCwzM107YnJlYWs7Y2FzZSA2OnY9WzI0LDExXTticmVhaztjYXNlIDc6dj1bMjAsMTFdO2JyZWFrO2Nhc2UgODp2PVszMiwxMV07YnJlYWs7Y2FzZSA5OnY9WzgwLDMzXTticmVhaztjYXNlIDEwOnY9WzE4LDExXTticmVhaztjYXNlIDExOnY9WzE1LDExXTticmVhaztjYXNlIDEyOnY9WzY0LDMzXTticmVhaztjYXNlIDEzOnY9WzE2MCw5OV07YnJlYWs7Y2FzZSAxNDp2PVs0LDNdO2JyZWFrO2Nhc2UgMTU6dj1bMywyXTticmVhaztjYXNlIDE2OnY9WzIsMV07YnJlYWs7Y2FzZSAyNTU6dj1bdC5yZWFkVUJ5dGUoKTw8OHx0LnJlYWRVQnl0ZSgpLHQucmVhZFVCeXRlKCk8PDh8dC5yZWFkVUJ5dGUoKV19aWYodC5yZWFkQm9vbCgpJiZ0LnJlYWRCb29sKCksdC5yZWFkQm9vbCgpJiYodC5yZWFkQml0cyg0KSx0LnJlYWRCb29sKCkmJnQucmVhZEJpdHMoMjQpKSx0LnJlYWRCb29sKCkmJih0LnJlYWRVRUcoKSx0LnJlYWRVRUcoKSksdC5yZWFkQm9vbCgpKXt2YXIgUz10LnJlYWRCaXRzKDMyKSxEPXQucmVhZEJpdHMoMzIpO3k9dC5yZWFkQm9vbCgpLGs9KG09RCkvKGc9MipTKX19cmV0dXJue2NvZGVjOmFlKGUuc3ViYXJyYXkoMSw0KSkscHJvZmlsZUlkYzpyLHByb2ZpbGVDb21wYXRpYmlsaXR5OmEsbGV2ZWxJZGM6bixjaHJvbWFGb3JtYXQ6aSx3aWR0aDpNYXRoLmNlaWwoMTYqKGQrMSktMiooYitfKSksaGVpZ2h0OigyLXApKihoKzEpKjE2LShwPzI6NCkqKHcreCksc2FyUmF0aW86dixmcHNOdW06bSxmcHNEZW46ZyxmcHM6ayxmaXhlZEZyYW1lOnl9fX1dKSxlfSgpLGxlPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSgpe3IodGhpcyxlKX1yZXR1cm4gbihlLG51bGwsW3trZXk6InBhcnNlSEVWQ0RlY29kZXJDb25maWd1cmF0aW9uUmVjb3JkIix2YWx1ZTpmdW5jdGlvbih0KXt2YXIgcj1hcmd1bWVudHMubGVuZ3RoPjEmJnZvaWQgMCE9PWFyZ3VtZW50c1sxXT9hcmd1bWVudHNbMV06e307aWYoISh0Lmxlbmd0aDwyMykpe3I9cnx8e307Zm9yKHZhciBhLG4saSxzLG8sdT0xKygzJnRbMjFdKSxjPVtdLGw9W10sZj1bXSxkPTIzLGg9dFsyMl0scD0wO3A8aDtwKyspe2k9NjMmdFtkXSxzPXRbZCsxXTw8OHx0W2QrMl0sZCs9Mztmb3IodmFyIHY9MDt2PHM7disrKWlmKG89dFtkXTw8OHx0W2QrMV0sZCs9MixvKXtzd2l0Y2goaSl7Y2FzZSAzMjp2YXIgeT10LnN1YmFycmF5KGQsZCtvKTthfHwoYT1lLnBhcnNlVlBTKHVlLnJlbW92ZUVQQih5KSxyKSksZi5wdXNoKHkpO2JyZWFrO2Nhc2UgMzM6dmFyIG09dC5zdWJhcnJheShkLGQrbyk7bnx8KG49ZS5wYXJzZVNQUyh1ZS5yZW1vdmVFUEIobSkscikpLGMucHVzaChtKTticmVhaztjYXNlIDM0OmwucHVzaCh0LnN1YmFycmF5KGQsZCtvKSl9ZCs9b319cmV0dXJue2h2Y0M6cixzcHM6bixzcHNBcnI6YyxwcHNBcnI6bCx2cHNBcnI6ZixuYWxVbml0U2l6ZTp1fX19fSx7a2V5OiJwYXJzZVZQUyIsdmFsdWU6ZnVuY3Rpb24odCxyKXtyPXJ8fHt9O3ZhciBhPW5ldyBIKHQpO2EucmVhZFVCeXRlKCksYS5yZWFkVUJ5dGUoKSxhLnJlYWRCaXRzKDEyKTt2YXIgbj1hLnJlYWRCaXRzKDMpO3JldHVybiByLm51bVRlbXBvcmFsTGF5ZXJzPU1hdGgubWF4KHIubnVtVGVtcG9yYWxMYXllcnN8fDAsbisxKSxhLnJlYWRCaXRzKDE3KSxlLl9wYXJzZVByb2ZpbGVUaWVyTGV2ZWwoYSxuLHIpLHJ9fSx7a2V5OiJwYXJzZVNQUyIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIHI9YXJndW1lbnRzLmxlbmd0aD4xJiZ2b2lkIDAhPT1hcmd1bWVudHNbMV0/YXJndW1lbnRzWzFdOnt9O3I9cnx8e307dmFyIGE9bmV3IEgodCk7YS5yZWFkVUJ5dGUoKSxhLnJlYWRVQnl0ZSgpLGEucmVhZEJpdHMoNCk7dmFyIG49YS5yZWFkQml0cygzKTtyLm51bVRlbXBvcmFsTGF5ZXJzPU1hdGgubWF4KG4rMSxyLm51bVRlbXBvcmFsTGF5ZXJzfHwwKSxyLnRlbXBvcmFsSWROZXN0ZWQ9YS5yZWFkQml0cygxKSxlLl9wYXJzZVByb2ZpbGVUaWVyTGV2ZWwoYSxuLHIpLGEucmVhZFVFRygpO3ZhciBpPXIuY2hyb21hRm9ybWF0SWRjPWEucmVhZFVFRygpLHM9NDIwO2k8PTMmJihzPVswLDQyMCw0MjIsNDQ0XVtpXSk7dmFyIG89MDszPT09aSYmKG89YS5yZWFkQml0cygxKSk7dmFyIHUsYyxsLGYsZD1hLnJlYWRVRUcoKSxoPWEucmVhZFVFRygpLHA9YS5yZWFkQml0cygxKTtpZigxPT09cCYmKHU9YS5yZWFkVUVHKCksYz1hLnJlYWRVRUcoKSxsPWEucmVhZFVFRygpLGY9YS5yZWFkVUVHKCkpLHIuYml0RGVwdGhMdW1hTWludXM4PWEucmVhZFVFRygpLHIuYml0RGVwdGhDaHJvbWFNaW51czg9YS5yZWFkVUVHKCksMT09PXApe3ZhciB2PTEhPT1pJiYyIT09aXx8MCE9PW8/MToyLHk9MT09PWkmJjA9PT1vPzI6MTtkLT12KihjK3UpLGgtPXkqKGYrbCl9cmV0dXJue2NvZGVjOiJoZXYxLjEuNi5MOTMuQjAiLHdpZHRoOmQsaGVpZ2h0OmgsY2hyb21hRm9ybWF0OnMsaHZjQzpyfX19LHtrZXk6Il9wYXJzZVByb2ZpbGVUaWVyTGV2ZWwiLHZhbHVlOmZ1bmN0aW9uKGUsdCxyKXt2YXIgYT1yLmdlbmVyYWxUaWVyRmxhZ3x8MDtyLmdlbmVyYWxQcm9maWxlU3BhY2U9ZS5yZWFkQml0cygyKSxyLmdlbmVyYWxUaWVyRmxhZz1NYXRoLm1heChlLnJlYWRCaXRzKDEpLGEpLHIuZ2VuZXJhbFByb2ZpbGVJZGM9TWF0aC5tYXgoZS5yZWFkQml0cyg1KSxyLmdlbmVyYWxQcm9maWxlSWRjfHwwKSxyLmdlbmVyYWxQcm9maWxlQ29tcGF0aWJpbGl0eUZsYWdzPWUucmVhZEJpdHMoMzIpLHIuZ2VuZXJhbENvbnN0cmFpbnRJbmRpY2F0b3JGbGFncz1bZS5yZWFkQml0cyg4KSxlLnJlYWRCaXRzKDgpLGUucmVhZEJpdHMoOCksZS5yZWFkQml0cyg4KSxlLnJlYWRCaXRzKDgpLGUucmVhZEJpdHMoOCldO3ZhciBuPWUucmVhZEJpdHMoOCk7YTxyLmdlbmVyYWxUaWVyRmxhZz9yLmdlbmVyYWxMZXZlbElkYz1uOnIuZ2VuZXJhbExldmVsSWRjPU1hdGgubWF4KG4sci5nZW5lcmFsTGV2ZWxJZGN8fDApO3ZhciBpPVtdLHM9W107aWYodD5lLmJpdHNBdmFpbGFibGUpdGhyb3cgbmV3IEVycm9yKCJtYXhTdWJMYXllcnNNaW51cyBpbmF2bGlkIHNpemUgIi5jb25jYXQodCkpO2Zvcih2YXIgbz0wO288dDtvKyspaVtvXT1lLnJlYWRCaXRzKDEpLHNbb109ZS5yZWFkQml0cygxKTt0PjAmJmUucmVhZEJpdHMoMiooOC10KSk7Zm9yKHZhciB1PTA7dTx0O3UrKykwIT09aVt1XSYmKGUucmVhZEJpdHMoMiksZS5yZWFkQml0cygxKSxlLnJlYWRCaXRzKDUpLGUucmVhZEJpdHMoMTYpLGUucmVhZEJpdHMoMTYpLGUucmVhZEJpdHMoNCksZS5yZWFkQml0cygxNiksZS5yZWFkQml0cygxNiksZS5yZWFkQml0cygxMikpLDAhPT1zW3VdJiZlLnJlYWRCaXRzKDgpfX1dKSxlfSgpLGZlPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSgpe3IodGhpcyxlKX1yZXR1cm4gbihlLG51bGwsW3trZXk6ImdldEZyYW1lRHVyYXRpb24iLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiAyMH19LHtrZXk6InBhcnNlSGVhZGVyUGFja2V0cyIsdmFsdWU6ZnVuY3Rpb24oZSl7aWYoZS5sZW5ndGgpe2Zvcih2YXIgdD1uZXcgRGF0YVZpZXcoZS5idWZmZXIsZS5ieXRlT2Zmc2V0LGUuYnl0ZUxlbmd0aCkscj0iIixhPTA7YTw4O2ErKylyKz1TdHJpbmcuZnJvbUNvZGVQb2ludChlW2FdKTtpZigiT3B1c0hlYWQiIT09cil0aHJvdyBuZXcgRXJyb3IoIkludmFsaWQgT3B1cyBNYWdpY1NpZ25hdHVyZSIpO3ZhciBuPWVbOV07Y29uc29sZS5sb2coIlByZS1za2lwIixlWzEwXSxlWzExXSk7dmFyIGk9dC5nZXRVaW50MzIoMTIsITApLHM9dC5nZXRJbnQxNigxNiwhMCk7aWYoaSl7cmV0dXJue291dHB1dEdhaW46cyxzYW1wbGVSYXRlOmksY2hhbm5lbENvdW50Om4sY29uZmlnOm5ldyBVaW50OEFycmF5KGUuYnVmZmVyLGUuYnl0ZU9mZnNldCs4LGUuYnl0ZUxlbmd0aC04KSxjb2RlYzoib3B1cyIsb3JpZ2luQ29kZWM6Im9wdXMifX19fX1dKSxlfSgpLGRlPTFlMyxoZT01ZTMscGU9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHQsYSxuKXtyKHRoaXMsZSksdGhpcy52aWRlb1RyYWNrPXQsdGhpcy5hdWRpb1RyYWNrPWEsdGhpcy5tZXRhZGF0YVRyYWNrPW4sdGhpcy5fYmFzZUR0cz0tMSx0aGlzLl9iYXNlRHRzSW5pdGVkPSExLHRoaXMuX2F1ZGlvTmV4dFB0cz12b2lkIDAsdGhpcy5fdmlkZW9OZXh0RHRzPXZvaWQgMCx0aGlzLl9hdWRpb1RpbWVzdGFtcEJyZWFrPTAsdGhpcy5fdmlkZW9UaW1lc3RhbXBCcmVhaz0wLHRoaXMuX2xhc3RWaWRlb0R1cmF0aW9uPTAsdGhpcy5fa2V5RnJhbWVJbk5leHRDaHVuaz0hMSx0aGlzLl9sYXN0QXVkaW9FeGNlcHRpb25HYXBEb3Q9LTEvMCx0aGlzLl9sYXN0QXVkaW9FeGNlcHRpb25PdmVybGFwRG90PS0xLzAsdGhpcy5fbGFzdEF1ZGlvRXhjZXB0aW9uTGFyZ2VHYXBEb3Q9LTEvMCx0aGlzLl9sYXN0VmlkZW9FeGNlcHRpb25MYXJnZUdhcERvdD0tMS8wLHRoaXMuX2xhc3RWaWRlb0V4Y2VwdGlvbkNodW5rRmlyc3REdHNEb3Q9LTEvMH1yZXR1cm4gbihlLFt7a2V5OiJmaXgiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcyx0PWFyZ3VtZW50cy5sZW5ndGg+MCYmdm9pZCAwIT09YXJndW1lbnRzWzBdP2FyZ3VtZW50c1swXTowLHI9YXJndW1lbnRzLmxlbmd0aD4xJiZ2b2lkIDAhPT1hcmd1bWVudHNbMV0mJmFyZ3VtZW50c1sxXSxhPSEoYXJndW1lbnRzLmxlbmd0aD4yJiZ2b2lkIDAhPT1hcmd1bWVudHNbMl0pfHxhcmd1bWVudHNbMl07dD1NYXRoLnJvdW5kKDFlMyp0KTt2YXIgbj10aGlzLnZpZGVvVHJhY2ssaT10aGlzLmF1ZGlvVHJhY2s7IXImJmF8fCh0aGlzLl92aWRlb0xhc3RTYW1wbGU9bnVsbCx0aGlzLl9hdWRpb05leHRQdHM9dm9pZCAwLHRoaXMuX3ZpZGVvTmV4dER0cz12b2lkIDAsdGhpcy5fYXVkaW9UaW1lc3RhbXBCcmVhaz0wLHRoaXMuX3ZpZGVvVGltZXN0YW1wQnJlYWs9MCx0aGlzLl9sYXN0QXVkaW9FeGNlcHRpb25HYXBEb3Q9LTEvMCx0aGlzLl9sYXN0QXVkaW9FeGNlcHRpb25PdmVybGFwRG90PS0xLzAsdGhpcy5fbGFzdEF1ZGlvRXhjZXB0aW9uTGFyZ2VHYXBEb3Q9LTEvMCx0aGlzLl9sYXN0VmlkZW9FeGNlcHRpb25MYXJnZUdhcERvdD0tMS8wLHRoaXMuX2xhc3RWaWRlb0V4Y2VwdGlvbkNodW5rRmlyc3REdHNEb3Q9LTEvMCksciYmIWEmJih0aGlzLl9iYXNlRHRzSW5pdGVkPSExKSx0aGlzLl9iYXNlRHRzSW5pdGVkfHx0aGlzLl9jYWxjdWxhdGVCYXNlRHRzKGksbiksIWEmJnQmJih0aGlzLl9hdWRpb05leHRQdHM9dGhpcy5fdmlkZW9OZXh0RHRzPXQpO3ZhciBzPXRoaXMuX2Jhc2VEdHNJbml0ZWQmJih0aGlzLl92aWRlb1RpbWVzdGFtcEJyZWFrfHwhdGhpcy52aWRlb1RyYWNrLmV4aXN0KCkpJiYodGhpcy5fYXVkaW9UaW1lc3RhbXBCcmVha3x8IXRoaXMuYXVkaW9UcmFjay5leGlzdCgpKTtpZihzJiZ0aGlzLl9yZXNldEJhc2VEdHNXaGVuU3RyZWFtQnJlYWtlZCgpLHRoaXMuX2ZpeEF1ZGlvKGkpLHRoaXMuX2tleUZyYW1lSW5OZXh0Q2h1bms9ITEsdGhpcy5fZml4VmlkZW8obiksdGhpcy5tZXRhZGF0YVRyYWNrLmV4aXN0KCkpe3ZhciBvPXRoaXMubWV0YWRhdGFUcmFjay50aW1lc2NhbGU7dGhpcy5tZXRhZGF0YVRyYWNrLnNlaVNhbXBsZXMuZm9yRWFjaCgoZnVuY3Rpb24odCl7dC5wdHM9dC5vcmlnaW5QdHMtZS5fYmFzZUR0cyx0LnRpbWU9TWF0aC5tYXgoMCx0LnB0cykvb30pKSx0aGlzLm1ldGFkYXRhVHJhY2suZmx2U2NyaXB0U2FtcGxlcy5mb3JFYWNoKChmdW5jdGlvbih0KXt0LnB0cz10Lm9yaWdpblB0cy1lLl9iYXNlRHRzLHQudGltZT1NYXRoLm1heCgwLHQucHRzKS9vfSkpfW4uc2FtcGxlcy5sZW5ndGgmJihuLmJhc2VNZWRpYURlY29kZVRpbWU9bi5zYW1wbGVzWzBdLmR0cyksaS5zYW1wbGVzLmxlbmd0aCYmKGkuYmFzZU1lZGlhRGVjb2RlVGltZT1pLnNhbXBsZXNbMF0ucHRzKmkudGltZXNjYWxlLzFlMyl9fSx7a2V5OiJfZml4VmlkZW8iLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMscj1lLnNhbXBsZXM7aWYoci5sZW5ndGgpe3ZhciBhO2lmKHIuZm9yRWFjaCgoZnVuY3Rpb24oZSl7ZS5kdHMtPXQuX2Jhc2VEdHMsZS5wdHMtPXQuX2Jhc2VEdHMsZS5rZXlmcmFtZSYmKHQuX2tleUZyYW1lSW5OZXh0Q2h1bms9ITApfSkpLGUuZnBzTnVtJiZlLmZwc0RlbilhPWUudGltZXNjYWxlKihlLmZwc0Rlbi9lLmZwc051bSk7ZWxzZSBpZihlLmxlbmd0aD4xKXt2YXIgbj1lLnNhbXBsZXNbMF0saT1lLnNhbXBsZXNbci5sZW5ndGgtMV07YT1NYXRoLmZsb29yKChpLmR0cy1uLmR0cykvKHIubGVuZ3RoLTEpKX1lbHNlIGE9dGhpcy5fbGFzdFZpZGVvRHVyYXRpb258fDQwO3ZhciBzPXIucG9wKCk7aWYodGhpcy5fdmlkZW9MYXN0U2FtcGxlJiZyLnVuc2hpZnQodGhpcy5fdmlkZW9MYXN0U2FtcGxlKSx0aGlzLl92aWRlb0xhc3RTYW1wbGU9cyxyLmxlbmd0aCl7aWYodm9pZCAwPT09dGhpcy5fdmlkZW9OZXh0RHRzKXt2YXIgbz1yWzBdO3RoaXMuX3ZpZGVvTmV4dER0cz1vLmR0c312YXIgdT1yLmxlbmd0aCxjPTAsbD1yWzBdLGY9dGhpcy5fdmlkZW9OZXh0RHRzLWwuZHRzO2lmKE1hdGguYWJzKGYpPjIwMCl7dmFyIGQ7aWYoTWF0aC5hYnMobC5kdHMtdGhpcy5fbGFzdFZpZGVvRXhjZXB0aW9uQ2h1bmtGaXJzdER0c0RvdCk+NWUzKXRoaXMuX2xhc3RWaWRlb0V4Y2VwdGlvbkNodW5rRmlyc3REdHNEb3Q9bC5kdHMsZS53YXJuaW5ncy5wdXNoKHt0eXBlOlAsbmV4dER0czp0aGlzLl92aWRlb05leHREdHMsZmlyc3RTYW1wbGVEdHM6bC5kdHMsbmV4dFNhbXBsZUR0czpudWxsPT09KGQ9clsxXSl8fHZvaWQgMD09PWQ/dm9pZCAwOmQuZHRzLHNhbXBsZUR1cmF0aW9uOmZ9KTt0aGlzLl92aWRlb1RpbWVzdGFtcEJyZWFrPj01Pyh0aGlzLl92aWRlb05leHREdHM9bC5kdHMsdGhpcy5fdmlkZW9UaW1lc3RhbXBCcmVhaz0wKToobC5kdHMrPWYsbC5wdHMrPWYsdGhpcy5hdWRpb1RyYWNrLmV4aXN0KCl8fCh0aGlzLl92aWRlb1RpbWVzdGFtcEJyZWFrPTEpKX1mb3IodmFyIGg9MDtoPHU7aCsrKXt2YXIgcD1yW2hdLmR0cyx2PXJbaCsxXTsoKGM9aDx1LTE/di5kdHMtcDpzP3MuZHRzLXA6YSk+MWUzfHxjPDApJiYodGhpcy5fdmlkZW9UaW1lc3RhbXBCcmVhaysrLE1hdGguYWJzKHAtdGhpcy5fbGFzdFZpZGVvRXhjZXB0aW9uTGFyZ2VHYXBEb3QpPjVlMyYmKHRoaXMuX2xhc3RWaWRlb0V4Y2VwdGlvbkxhcmdlR2FwRG90PXAsZS53YXJuaW5ncy5wdXNoKHt0eXBlOkMsdGltZTpwL2UudGltZXNjYWxlLGR0czpwLG9yaWdpbkR0czpyW2hdLm9yaWdpbkR0cyxuZXh0RHRzOnRoaXMuX3ZpZGVvTmV4dER0cyxzYW1wbGVEdXJhdGlvbjpjLHJlZlNhbXBsZUR1cmF0aW9uOmF9KSksYz1hKSxyW2hdLmR1cmF0aW9uPWMsdGhpcy5fdmlkZW9OZXh0RHRzKz1jLHRoaXMuX2xhc3RWaWRlb0R1cmF0aW9uPWN9fX19fSx7a2V5OiJfZml4QXVkaW8iLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMscj1lLnNhbXBsZXM7ci5sZW5ndGgmJihyLmZvckVhY2goKGZ1bmN0aW9uKGUpe2UuZHRzPWUucHRzLT10Ll9iYXNlRHRzfSkpLHRoaXMuX2RvRml4QXVkaW9JbnRlcm5hbChlLHIsMWUzKSl9fSx7a2V5OiJfY2FsY3VsYXRlQmFzZUR0cyIsdmFsdWU6ZnVuY3Rpb24oZSx0KXt2YXIgcj1lLnNhbXBsZXMsYT10LnNhbXBsZXM7aWYoIXIubGVuZ3RoJiYhYS5sZW5ndGgpcmV0dXJuITE7dmFyIG49MS8wLGk9MS8wO3IubGVuZ3RoJiYoZS5iYXNlRHRzPW49clswXS5wdHMpLGEubGVuZ3RoJiYodC5iYXNlRHRzPWk9YVswXS5kdHMpLHRoaXMuX2Jhc2VEdHM9TWF0aC5taW4obixpKTt2YXIgcz1pLW47cmV0dXJuIE51bWJlci5pc0Zpbml0ZShzKSYmTWF0aC5hYnMocyk+NTAwJiZ0Lndhcm5pbmdzLnB1c2goe3R5cGU6VSx2aWRlb0Jhc2VEdHM6aSxhdWRpb0Jhc2VQdHM6bixiYXNlRHRzOnRoaXMuX2Jhc2VEdHMsZGVsdGE6c30pLHRoaXMuX2Jhc2VEdHNJbml0ZWQ9ITAsITB9fSx7a2V5OiJfcmVzZXRCYXNlRHRzV2hlblN0cmVhbUJyZWFrZWQiLHZhbHVlOmZ1bmN0aW9uKCl7dGhpcy5fY2FsY3VsYXRlQmFzZUR0cyh0aGlzLmF1ZGlvVHJhY2ssdGhpcy52aWRlb1RyYWNrKSYmKHRoaXMuYXVkaW9UcmFjay5leGlzdCgpP3RoaXMudmlkZW9UcmFjay5leGlzdCgpP3RoaXMuX2Jhc2VEdHMtPU1hdGgubWluKHRoaXMuX2F1ZGlvTmV4dFB0cyx0aGlzLl92aWRlb05leHREdHMpOnRoaXMuX2Jhc2VEdHMtPXRoaXMuX2F1ZGlvTmV4dFB0czp0aGlzLl9iYXNlRHRzLT10aGlzLl92aWRlb05leHREdHMsdGhpcy5fdmlkZW9UaW1lc3RhbXBCcmVhaz0wLHRoaXMuX2F1ZGlvVGltZXN0YW1wQnJlYWs9MCl9fSx7a2V5OiJfZG9GaXhBdWRpb0ludGVybmFsIix2YWx1ZTpmdW5jdGlvbihlLHQscil7aWYoIWUuc2FtcGxlRHVyYXRpb24pc3dpdGNoKGUuY29kZWNUeXBlKXtjYXNlIEE6ZS5zYW1wbGVEdXJhdGlvbj1vZS5nZXRGcmFtZUR1cmF0aW9uKGUudGltZXNjYWxlLHIpO2JyZWFrO2Nhc2UgRTplLnNhbXBsZUR1cmF0aW9uPWZlLmdldEZyYW1lRHVyYXRpb24oZS5zYW1wbGVzLHIpO2JyZWFrO2Nhc2UgVDpjYXNlIEI6ZS5zYW1wbGVEdXJhdGlvbj10aGlzLl9nZXRHNzExRHVyYXRpb24oZSk7YnJlYWs7ZGVmYXVsdDpjb25zb2xlLmVycm9yKCJjYW4ndCBmaXggYXVkaW8gY29kZWNUeXBlOiIsZS5jb2RlY1R5cGUpfXZhciBhPWUuc2FtcGxlRHVyYXRpb24sbj1lLmNvZGVjVHlwZT09PUU/MjA6ZS5jb2RlY1R5cGU9PT1BPzEwMjQ6YSplLnRpbWVzY2FsZS8xZTM7aWYodm9pZCAwPT09dGhpcy5fYXVkaW9OZXh0UHRzKXt2YXIgaT10WzBdO3RoaXMuX2F1ZGlvTmV4dFB0cz1pLnB0c31mb3IodmFyIHM9MDtzPHQubGVuZ3RoO3MrKyl7dmFyIG89dGhpcy5fYXVkaW9OZXh0UHRzLHU9dFtzXSxjPXUucHRzLW87aWYoMD09PXMmJnRoaXMuX2F1ZGlvVGltZXN0YW1wQnJlYWs+PTUmJnRoaXMuX2tleUZyYW1lSW5OZXh0Q2h1bmsmJihvPXRoaXMuX2F1ZGlvTmV4dFB0cz11LmR0cyxjPTAsdGhpcy5fYXVkaW9UaW1lc3RhbXBCcmVhaz0wKSwhdGhpcy5fYXVkaW9UaW1lc3RhbXBCcmVhayYmYz49MyphJiZjPD1kZSYmIVkpe3ZhciBsPXRoaXMuX2dldFNpbGVudEZyYW1lKGUpfHx0WzBdLmRhdGEuc3ViYXJyYXkoKSxmPU1hdGguZmxvb3IoYy9hKTtNYXRoLmFicyh1LnB0cy10aGlzLl9sYXN0QXVkaW9FeGNlcHRpb25HYXBEb3QpPmhlJiYodGhpcy5fbGFzdEF1ZGlvRXhjZXB0aW9uR2FwRG90PXUucHRzLGUud2FybmluZ3MucHVzaCh7dHlwZTpNLHB0czp1LnB0cyxvcmlnaW5QdHM6dS5vcmlnaW5QdHMsY291bnQ6ZixuZXh0UHRzOm8scmVmU2FtcGxlRHVyYXRpb246YX0pKTtmb3IodmFyIGQ9MDtkPGY7ZCsrKXt2YXIgaD1uZXcgVihNYXRoLmZsb29yKHRoaXMuX2F1ZGlvTmV4dFB0cythKS1NYXRoLmZsb29yKHRoaXMuX2F1ZGlvTmV4dFB0cyksbCxuKTtoLm9yaWdpblB0cz1NYXRoLmZsb29yKHRoaXMuX2Jhc2VEdHMrbyksdC5zcGxpY2UocywwLGgpLHRoaXMuX2F1ZGlvTmV4dFB0cys9YSxzKyt9cy0tfWVsc2UgaWYoYzw9LTMqYSYmYz49LTFlMylNYXRoLmFicyh1LnB0cy10aGlzLl9sYXN0QXVkaW9FeGNlcHRpb25PdmVybGFwRG90KT5oZSYmKHRoaXMuX2xhc3RBdWRpb0V4Y2VwdGlvbk92ZXJsYXBEb3Q9dS5wdHMsZS53YXJuaW5ncy5wdXNoKHt0eXBlOnoscHRzOnUucHRzLG9yaWdpblB0czp1Lm9yaWdpblB0cyxuZXh0UHRzOm8scmVmU2FtcGxlRHVyYXRpb246YX0pKSx0LnNwbGljZShzLDEpLHMtLTtlbHNle2lmKE1hdGguYWJzKGMpPmRlJiYodGhpcy5fYXVkaW9UaW1lc3RhbXBCcmVhaysrLE1hdGguYWJzKHUucHRzLXRoaXMuX2xhc3RBdWRpb0V4Y2VwdGlvbkxhcmdlR2FwRG90KT5oZSYmKHRoaXMuX2xhc3RBdWRpb0V4Y2VwdGlvbkxhcmdlR2FwRG90PXUucHRzLGUud2FybmluZ3MucHVzaCh7dHlwZTpJLHRpbWU6dS5wdHMvMWUzLHB0czp1LnB0cyxvcmlnaW5QdHM6dS5vcmlnaW5QdHMsbmV4dFB0czpvLHNhbXBsZUR1cmF0aW9uOmMscmVmU2FtcGxlRHVyYXRpb246YX0pKSksZS5jb2RlY1R5cGU9PT1FKXt2YXIgcD10W3QubGVuZ3RoLTFdO3AmJihwLmR1cmF0aW9uPXUucHRzLXAucHRzKX1lbHNlIHUuZHRzPXUucHRzPW8sdS5kdXJhdGlvbj1uO3RoaXMuX2F1ZGlvTmV4dFB0cys9YX19fX0se2tleToiX2dldEc3MTFEdXJhdGlvbiIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5zYW1wbGVTaXplLHI9ZS5jaGFubmVsQ291bnQsYT1lLnNhbXBsZVJhdGUsbj1lLnNhbXBsZXNbMF07aWYobilyZXR1cm4gMipuLmRhdGEuYnl0ZUxlbmd0aC9yLyh0LzgpL2EqMWUzfX0se2tleToiX2dldFNpbGVudEZyYW1lIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gZS5jb2RlY1R5cGU9PT1BP29lLmdldFNpbGVudEZyYW1lKGUuY29kZWMsZS5jaGFubmVsQ291bnQpOm5ldyBVaW50OEFycmF5KDgqZS5zYW1wbGVEdXJhdGlvbiplLmNoYW5uZWxDb3VudCl9fV0pLGV9KCksdmU9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7cih0aGlzLGUpfXJldHVybiBuKGUsbnVsbCxbe2tleToicGFyc2UiLHZhbHVlOmZ1bmN0aW9uKHQpe2lmKCEodC5sZW5ndGg8Mykpe3ZhciByPXt9LGE9ZS5fcGFyc2VWYWx1ZShuZXcgRGF0YVZpZXcodC5idWZmZXIsdC5ieXRlT2Zmc2V0LHQuYnl0ZUxlbmd0aCkpLG49ZS5fcGFyc2VWYWx1ZShuZXcgRGF0YVZpZXcodC5idWZmZXIsdC5ieXRlT2Zmc2V0K2Euc2l6ZSx0LmJ5dGVMZW5ndGgtYS5zaXplKSk7cmV0dXJuIHJbYS5kYXRhXT1uLmRhdGEscn19fSx7a2V5OiJfcGFyc2VWYWx1ZSIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIHIsYT10LmJ5dGVMZW5ndGgsbj0xLGk9ITE7c3dpdGNoKHQuZ2V0VWludDgoMCkpe2Nhc2UgMDpyPXQuZ2V0RmxvYXQ2NCgxKSxuKz04O2JyZWFrO2Nhc2UgMTpyPSEhdC5nZXRVaW50OCgxKSxuKz0xO2JyZWFrO2Nhc2UgMjp2YXIgcz1lLl9wYXJzZVN0cmluZyhuZXcgRGF0YVZpZXcodC5idWZmZXIsdC5ieXRlT2Zmc2V0K24sdC5ieXRlTGVuZ3RoLW4pKTtyPXMuZGF0YSxuKz1zLnNpemU7YnJlYWs7Y2FzZSAzOnI9e307dmFyIG89MDtmb3IoOT09KDE2Nzc3MjE1JnQuZ2V0VWludDMyKGEtNCkpJiYobz0zKTtuPGEtNDspe3ZhciB1PWUuX3BhcnNlT2JqZWN0KG5ldyBEYXRhVmlldyh0LmJ1ZmZlcix0LmJ5dGVPZmZzZXQrbix0LmJ5dGVMZW5ndGgtbi1vKSksYz11LnNpemUsbD11LmRhdGE7aWYodS5pc0VuZClicmVhaztyW2wubmFtZV09bC52YWx1ZSxuKz1jfWlmKG48PWEtMyk5PT09KDE2Nzc3MjE1JnQuZ2V0VWludDMyKG4tMSkpJiYobis9Myk7YnJlYWs7Y2FzZSA4OnI9e30sbis9NDt2YXIgZj0wO2Zvcig5PT0oMTY3NzcyMTUmdC5nZXRVaW50MzIoYS00KSkmJihmPTMpO248YS04Oyl7dmFyIGQ9ZS5fcGFyc2VPYmplY3QobmV3IERhdGFWaWV3KHQuYnVmZmVyLHQuYnl0ZU9mZnNldCtuLHQuYnl0ZUxlbmd0aC1uLWYpKSxoPWQuc2l6ZSxwPWQuZGF0YTtpZihkLmlzRW5kKWJyZWFrO3JbcC5uYW1lXT1wLnZhbHVlLG4rPWh9aWYobjw9YS0zKTk9PT0oMTY3NzcyMTUmdC5nZXRVaW50MzIobi0xKSkmJihuKz0zKTticmVhaztjYXNlIDk6cj12b2lkIDAsbj0xLGk9ITA7YnJlYWs7Y2FzZSAxMDpyPVtdO3ZhciB2PXQuZ2V0VWludDMyKDEpO24rPTQ7Zm9yKHZhciB5PTA7eTx2O3krKyl7dmFyIG09ZS5fcGFyc2VWYWx1ZShuZXcgRGF0YVZpZXcodC5idWZmZXIsdC5ieXRlT2Zmc2V0K24sdC5ieXRlTGVuZ3RoLW4pKSxnPW0uZGF0YSxrPW0uc2l6ZTtyLnB1c2goZyksbis9a31icmVhaztjYXNlIDExOnZhciBiPXQuZ2V0RmxvYXQ2NChuKSs2ZTQqdC5nZXRJbnQxNihuKzgpO3I9bmV3IERhdGUoYiksbis9MTA7YnJlYWs7Y2FzZSAxMjp2YXIgXz10LmdldFVpbnQzMigxKTtuKz00LHI9IiIsXz4wJiYocj1xLmRlY29kZShuZXcgVWludDhBcnJheSh0LmJ1ZmZlcix0LmJ5dGVPZmZzZXQrbixfKSkpLG4rPV87YnJlYWs7ZGVmYXVsdDpuPWF9cmV0dXJue2RhdGE6cixzaXplOm4saXNFbmQ6aX19fSx7a2V5OiJfcGFyc2VTdHJpbmciLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PWUuZ2V0VWludDE2KDApLHI9IiI7cmV0dXJuIHQ+MCYmKHI9cS5kZWNvZGUobmV3IFVpbnQ4QXJyYXkoZS5idWZmZXIsZS5ieXRlT2Zmc2V0KzIsdCkpKSx7ZGF0YTpyLHNpemU6Mit0fX19LHtrZXk6Il9wYXJzZU9iamVjdCIsdmFsdWU6ZnVuY3Rpb24odCl7aWYoISh0LmJ5dGVMZW5ndGg8Mykpe3ZhciByPWUuX3BhcnNlU3RyaW5nKHQpLGE9ZS5fcGFyc2VWYWx1ZShuZXcgRGF0YVZpZXcodC5idWZmZXIsdC5ieXRlT2Zmc2V0K3Iuc2l6ZSx0LmJ5dGVMZW5ndGgtci5zaXplKSk7cmV0dXJue2RhdGE6e25hbWU6ci5kYXRhLHZhbHVlOmEuZGF0YX0sc2l6ZTpyLnNpemUrYS5zaXplLGlzRW5kOmEuaXNFbmR9fX19XSksZX0oKSx5ZT03LG1lPTgsZ2U9MTAsa2U9MTMsYmU9bmV3IEsoIkZsdkRlbXV4ZXIiKSxfZT1mdW5jdGlvbigpe2Z1bmN0aW9uIGUodCxhLG4pe3IodGhpcyxlKSxpKHRoaXMsIl9oZWFkZXJQYXJzZWQiLCExKSxpKHRoaXMsIl9yZW1haW5pbmdEYXRhIixudWxsKSxpKHRoaXMsIl9nb3BJZCIsMCksaSh0aGlzLCJfbmVlZEFkZE1ldGFCZWZvcmVLZXlGcmFtZU5hbCIsITApLHRoaXMudmlkZW9UcmFjaz10fHxuZXcgTyx0aGlzLmF1ZGlvVHJhY2s9YXx8bmV3IFIsdGhpcy5tZXRhZGF0YVRyYWNrPW58fG5ldyBHLHRoaXMuX2ZpeGVyPW5ldyBwZSh0aGlzLnZpZGVvVHJhY2ssdGhpcy5hdWRpb1RyYWNrLHRoaXMubWV0YWRhdGFUcmFjayl9cmV0dXJuIG4oZSxbe2tleToiZGVtdXgiLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciByLGE9YXJndW1lbnRzLmxlbmd0aD4xJiZ2b2lkIDAhPT1hcmd1bWVudHNbMV0mJmFyZ3VtZW50c1sxXSxuPSEoYXJndW1lbnRzLmxlbmd0aD4yJiZ2b2lkIDAhPT1hcmd1bWVudHNbMl0pfHxhcmd1bWVudHNbMl0saT1hcmd1bWVudHMubGVuZ3RoPjM/YXJndW1lbnRzWzNdOnZvaWQgMCxzPXRoaXMuYXVkaW9UcmFjayxvPXRoaXMudmlkZW9UcmFjayx1PXRoaXMubWV0YWRhdGFUcmFjaztpZighYSYmbnx8KHRoaXMuX3JlbWFpbmluZ0RhdGE9bnVsbCksYSYmKHRoaXMuX2hlYWRlclBhcnNlZD0hMSksYT8oby5yZXNldCgpLHMucmVzZXQoKSx1LnJlc2V0KCkpOihvLnNhbXBsZXM9W10scy5zYW1wbGVzPVtdLHUuc2VpU2FtcGxlcz1bXSx1LmZsdlNjcmlwdFNhbXBsZXM9W10sby53YXJuaW5ncz1bXSxzLndhcm5pbmdzPVtdLHRoaXMuX3JlbWFpbmluZ0RhdGEmJih0PUoodGhpcy5fcmVtYWluaW5nRGF0YSx0KSx0aGlzLl9yZW1haW5pbmdEYXRhPW51bGwpKSwhdC5sZW5ndGgpcmV0dXJue3ZpZGVvVHJhY2s6byxhdWRpb1RyYWNrOnMsbWV0YWRhdGFUcmFjazp1fTt2YXIgYz0wO2lmKCF0aGlzLl9oZWFkZXJQYXJzZWQpe2lmKCFlLnByb2JlKHQpKXRocm93IG5ldyBFcnJvcigiSW52YWxpZCBmbHYgZmlsZSIpO3MucHJlc2VudD0oNCZ0WzRdKT4+PjIhPTAsby5wcmVzZW50PTAhPSgxJnRbNF0pLHRoaXMuX2hlYWRlclBhcnNlZD0hMCxjPXRlKHQsNSkrNH1mb3IodmFyIGwsZixkLGgscCx2PXQubGVuZ3RoO2MrMTU8diYmKGw9dFtjXSwhKGMrMTUrKGY9dFtjKzFdPDwxNnx0W2MrMl08PDh8dFtjKzNdKT52KSk7KWQ9KHRbYys3XTw8MjQ+Pj4wKSsodFtjKzRdPDwxNikrKHRbYys1XTw8OCkrdFtjKzZdLGMrPTExLGg9dC5zdWJhcnJheShjLGMrZiksOD09PWw/dGhpcy5fcGFyc2VBdWRpbyhoLGQpOjk9PT1sPyhpJiYodGhpcy5zZWFtbGVzc0xvYWRpbmdTd2l0Y2hpbmc9ITApLHRoaXMuX3BhcnNlVmlkZW8oaCxkKSk6MTg9PT1sP3RoaXMuX3BhcnNlU2NyaXB0KGgsZCk6YmUud2FybigiSW52YWxpZCB0YWcgdHlwZTogIi5jb25jYXQobCkpLChwPXRlKHQsYys9ZikpIT09MTErZiYmYmUud2FybigiSW52YWxpZCBQcmV2VGFnU2l6ZSAiLmNvbmNhdChwLCIgKCIpLmNvbmNhdCgxMStmLCIpIikpLGMrPTQ7Yzx2JiYodGhpcy5fcmVtYWluaW5nRGF0YT10LnN1YmFycmF5KGMpKSxzLmZvcm1hdFRpbWVzY2FsZT1vLmZvcm1hdFRpbWVzY2FsZT1vLnRpbWVzY2FsZT11LnRpbWVzY2FsZT0xZTMscy50aW1lc2NhbGU9cy5jb2RlY1R5cGU9PT1FPzFlMzpzLnNhbXBsZVJhdGV8fDAsIXMuZXhpc3QoKSYmcy5oYXNTYW1wbGUoKSYmcy5yZXNldCgpLCFvLmV4aXN0KCkmJm8uaGFzU2FtcGxlKCkmJm8ucmVzZXQoKTt2YXIgeT11LmZsdlNjcmlwdFNhbXBsZXNbdS5mbHZTY3JpcHRTYW1wbGVzLmxlbmd0aC0xXSxtPW51bGw9PXl8fG51bGw9PT0ocj15LmRhdGEpfHx2b2lkIDA9PT1yP3ZvaWQgMDpyLm9uTWV0YURhdGE7cmV0dXJuIG0mJihudWxsIT1vJiZvLmV4aXN0KCkmJihtLmhhc093blByb3BlcnR5KCJkdXJhdGlvbiIpJiYoby5kdXJhdGlvbj0xZTMqbS5kdXJhdGlvbiksbS5oYXNPd25Qcm9wZXJ0eSgid2lkdGgiKSYmbS5oYXNPd25Qcm9wZXJ0eSgiaGVpZ2h0IikmJihvLndpZHRoPW0ud2lkdGgsby5oZWlnaHQ9bS5oZWlnaHQpKSxudWxsIT1zJiZzLmV4aXN0KCkmJm0uaGFzT3duUHJvcGVydHkoImR1cmF0aW9uIikmJihzLmR1cmF0aW9uPTFlMyptLmR1cmF0aW9uKSkse3ZpZGVvVHJhY2s6byxhdWRpb1RyYWNrOnMsbWV0YWRhdGFUcmFjazp1fX19LHtrZXk6ImZpeCIsdmFsdWU6ZnVuY3Rpb24oZSx0LHIpe3JldHVybiB0aGlzLl9maXhlci5maXgoZSx0LHIpLHt2aWRlb1RyYWNrOnRoaXMudmlkZW9UcmFjayxhdWRpb1RyYWNrOnRoaXMuYXVkaW9UcmFjayxtZXRhZGF0YVRyYWNrOnRoaXMubWV0YWRhdGFUcmFja319fSx7a2V5OiJkZW11eEFuZEZpeCIsdmFsdWU6ZnVuY3Rpb24oZSx0LHIsYSxuKXtyZXR1cm4gdGhpcy5kZW11eChlLHQscixuKSx0aGlzLmZpeChhLHQscil9fSx7a2V5OiJfcGFyc2VBdWRpbyIsdmFsdWU6ZnVuY3Rpb24odCxyKXtpZih0Lmxlbmd0aCl7dmFyIGE9KDI0MCZ0WzBdKT4+PjQsbj10aGlzLmF1ZGlvVHJhY2s7aWYoYSE9PWdlJiZhIT09eWUmJmEhPT1tZSYmYSE9PWtlKXJldHVybiBiZS53YXJuKCJVbnN1cHBvcnRlZCBzb3VuZCBmb3JtYXQ6ICIuY29uY2F0KGEpKSx2b2lkIG4ucmVzZXQoKTtpZihhIT09Z2UmJmEhPT1rZSl7dmFyIGk9KDEyJnRbMF0pPj4yLHM9KDImdFswXSk+PjEsbz0xJnRbMF07bi5zYW1wbGVSYXRlPWUuQVVESU9fUkFURVtpXSxuLnNhbXBsZVNpemU9cz8xNjo4LG4uY2hhbm5lbENvdW50PW8rMX1zd2l0Y2goYSl7Y2FzZSB5ZTpjYXNlIG1lOnRoaXMuX3BhcnNlRzcxMSh0LHIsYSk7YnJlYWs7Y2FzZSBnZTp0aGlzLl9wYXJzZUFhYyh0LHIpO2JyZWFrO2Nhc2Uga2U6dGhpcy5fcGFyc2VPcHVzKHQscil9fX19LHtrZXk6Il9wYXJzZU9wdXMiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7dmFyIHI9dGhpcy5hdWRpb1RyYWNrLGE9ZVsxXTtzd2l0Y2goci5jb2RlY1R5cGU9RSxhKXtjYXNlIDA6dmFyIG49ZmUucGFyc2VIZWFkZXJQYWNrZXRzKGUuc3ViYXJyYXkoMikpO24/KHIuY29kZWM9bi5jb2RlYyxyLmNoYW5uZWxDb3VudD1uLmNoYW5uZWxDb3VudCxyLnNhbXBsZVJhdGU9bi5zYW1wbGVSYXRlLHIuY29uZmlnPW4uY29uZmlnLHIuc2FtcGxlRHVyYXRpb249ZmUuZ2V0RnJhbWVEdXJhdGlvbihbXSxyLnRpbWVzY2FsZSkpOihyLnJlc2V0KCksYmUud2FybigiQ2Fubm90IHBhcnNlIEF1ZGlvU3BlY2lmaWNDb25maWciLGUpKTticmVhaztjYXNlIDE6aWYobnVsbD09dClyZXR1cm47dmFyIGk9bmV3IFYodCxlLnN1YmFycmF5KDIpLHIuc2FtcGxlRHVyYXRpb24pO3Iuc2FtcGxlcy5wdXNoKGkpO2JyZWFrO2RlZmF1bHQ6YmUud2FybigiVW5rbm93biBPcHVzUGFja2V0VHlwZTogIi5jb25jYXQoYSkpfX19LHtrZXk6Il9wYXJzZUc3MTEiLHZhbHVlOmZ1bmN0aW9uKGUsdCxyKXt2YXIgYT10aGlzLmF1ZGlvVHJhY2s7YS5jb2RlY1R5cGU9Nz09PXI/VDpCLGEuc2FtcGxlUmF0ZT04ZTMsYS5jb2RlYz1hLmNvZGVjVHlwZSxhLnNhbXBsZXMucHVzaChuZXcgVih0LGUuc3ViYXJyYXkoMSkpKX19LHtrZXk6Il9wYXJzZUFhYyIsdmFsdWU6ZnVuY3Rpb24oZSx0KXt2YXIgcj10aGlzLmF1ZGlvVHJhY2s7aWYoci5jb2RlY1R5cGU9QSwwPT09ZVsxXSl7dmFyIGE9b2UucGFyc2VBdWRpb1NwZWNpZmljQ29uZmlnKGUuc3ViYXJyYXkoMikpO2E/KHIuY29kZWM9YS5jb2RlYyxyLmNoYW5uZWxDb3VudD1hLmNoYW5uZWxDb3VudCxyLnNhbXBsZVJhdGU9YS5zYW1wbGVSYXRlLHIuY29uZmlnPWEuY29uZmlnLHIub2JqZWN0VHlwZT1hLm9iamVjdFR5cGUsci5zYW1wbGVSYXRlSW5kZXg9YS5zYW1wbGluZ0ZyZXF1ZW5jeUluZGV4KTooci5yZXNldCgpLGJlLndhcm4oIkNhbm5vdCBwYXJzZSBBdWRpb1NwZWNpZmljQ29uZmlnIixlKSl9ZWxzZSBpZigxPT09ZVsxXSl7aWYobnVsbD09dClyZXR1cm47ci5zYW1wbGVzLnB1c2gobmV3IFYodCxlLnN1YmFycmF5KDIpKSl9ZWxzZSBiZS53YXJuKCJVbmtub3duIEFBQ1BhY2tldFR5cGU6ICIuY29uY2F0KGVbMV0pKX19LHtrZXk6Il9wYXJzZVZpZGVvIix2YWx1ZTpmdW5jdGlvbihlLHQpe3ZhciByPXRoaXM7aWYoIShlLmxlbmd0aDw2KSl7dmFyIGE9KDI0MCZlWzBdKT4+PjQsbj0xNSZlWzBdLGk9dGhpcy52aWRlb1RyYWNrO2lmKDchPT1uJiYxMiE9PW4pcmV0dXJuIGkucmVzZXQoKSx2b2lkIGJlLndhcm4oIlVuc3VwcG9ydGVkIGNvZGVjSWQ6ICIuY29uY2F0KG4pKTt2YXIgcz0xMj09PW47aS5jb2RlY1R5cGU9cz9EOlM7dmFyIG89ZVsxXSx1PShlWzJdPDwxNnxlWzNdPDw4fGVbNF0pPDw4Pj44O2lmKDA9PT1vKXt2YXIgYz1lLnN1YmFycmF5KDUpLGw9cz9sZS5wYXJzZUhFVkNEZWNvZGVyQ29uZmlndXJhdGlvblJlY29yZChjKTpjZS5wYXJzZUFWQ0RlY29kZXJDb25maWd1cmF0aW9uUmVjb3JkKGMpO2lmKGwpe3ZhciBmPWwuaHZjQyxkPWwuc3BzLGg9bC5wcHNBcnIscD1sLnNwc0Fycix2PWwudnBzQXJyLHk9bC5uYWxVbml0U2l6ZTtmJiYoaS5odmNDPWkuaHZjQ3x8ZiksZCYmKGkuY29kZWM9ZC5jb2RlYyxpLndpZHRoPWQud2lkdGgsaS5oZWlnaHQ9ZC5oZWlnaHQsaS5zYXJSYXRpbz1kLnNhclJhdGlvLGkuZnBzTnVtPWQuZnBzTnVtLGkuZnBzRGVuPWQuZnBzRGVuKSxwLmxlbmd0aCYmKGkuc3BzPXApLGgubGVuZ3RoJiYoaS5wcHM9aCksdiYmdi5sZW5ndGgmJihpLnZwcz12KSx5JiYoaS5uYWxVbml0U2l6ZT15KX1lbHNlIGJlLndhcm4oIkNhbm5vdCBwYXJzZSAiLmNvbmNhdChzPyJIRVZDIjoiQVZDIiwiRGVjb2RlckNvbmZpZ3VyYXRpb25SZWNvcmQiKSxlKX1lbHNlIGlmKDE9PT1vKXt2YXIgbT11ZS5wYXJzZUF2Y0MoZS5zdWJhcnJheSg1KSxpLm5hbFVuaXRTaXplKTtpZigobT10aGlzLl9jaGVja0FkZE1ldGFOYWxUb1VuaXRzKHMsbSxpKSkmJm0ubGVuZ3RoKXt2YXIgZz1uZXcgTCh0K3UsdCxtKTtpZih0aGlzLnNlYW1sZXNzTG9hZGluZ1N3aXRjaGluZyYmdDxpLmxhc3RLZXlGcmFtZUR0cylyZXR1cm47dGhpcy5zZWFtbGVzc0xvYWRpbmdTd2l0Y2hpbmc9ITEsMT09PWEmJihnLnNldFRvS2V5ZnJhbWUoKSxpLmxhc3RLZXlGcmFtZUR0cz10KSxpLnNhbXBsZXMucHVzaChnKSxtLmZvckVhY2goKGZ1bmN0aW9uKGUpe3ZhciBhPXM/ZVswXT4+PjEmNjM6MzEmZVswXTtzd2l0Y2goYSl7Y2FzZSA1OmNhc2UgMTY6Y2FzZSAxNzpjYXNlIDE4OmNhc2UgMTk6Y2FzZSAyMDpjYXNlIDIxOmNhc2UgMjI6Y2FzZSAyMzppZighcyYmNSE9PWF8fHMmJjU9PT1hKWJyZWFrO2cuc2V0VG9LZXlmcmFtZSgpO2JyZWFrO2Nhc2UgNjpjYXNlIDM5OmNhc2UgNDA6aWYoIXMmJjYhPT1hfHxzJiY2PT09YSlicmVhaztyLm1ldGFkYXRhVHJhY2suc2VpU2FtcGxlcy5wdXNoKG5ldyBqKHVlLnBhcnNlU0VJKHVlLnJlbW92ZUVQQihlKSxzKSx0K3UpKX19KSksZy5rZXlmcmFtZSYmdGhpcy5fZ29wSWQrKyxnLmdvcElkPXRoaXMuX2dvcElkfWVsc2UgYmUud2FybigiQ2Fubm90IHBhcnNlIE5BTFVzIixlKX1lbHNlIDI9PT1vfHxiZS53YXJuKCJVbmtub3duIEFWQ1BhY2tldFR5cGU6ICIuY29uY2F0KG8pKX19fSx7a2V5OiJfY2hlY2tBZGRNZXRhTmFsVG9Vbml0cyIsdmFsdWU6ZnVuY3Rpb24oZSx0LHIpe3JldHVybiBlJiZ0aGlzLl9uZWVkQWRkTWV0YUJlZm9yZUtleUZyYW1lTmFsP3QubWFwKChmdW5jdGlvbihlKXtyZXR1cm4gZVswXT4+PjEmNjN9KSkuaW5jbHVkZXMoMzIpPyh0aGlzLl9uZWVkQWRkTWV0YUJlZm9yZUtleUZyYW1lTmFsPSExLHQpOih0LnVuc2hpZnQoci5wcHNbMF0pLHQudW5zaGlmdChyLnNwc1swXSksdC51bnNoaWZ0KHIudnBzWzBdKSx0LmZpbHRlcihCb29sZWFuKSk6KHRoaXMuX25lZWRBZGRNZXRhQmVmb3JlS2V5RnJhbWVOYWw9ITEsdCl9fSx7a2V5OiJfcGFyc2VTY3JpcHQiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7dGhpcy5tZXRhZGF0YVRyYWNrLmZsdlNjcmlwdFNhbXBsZXMucHVzaChuZXcgTih2ZS5wYXJzZShlKSx0KSl9fV0sW3trZXk6InByb2JlIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gNzA9PT1lWzBdJiY3Nj09PWVbMV0mJjg2PT09ZVsyXSYmMT09PWVbM10mJnRlKGUsNSk+PTl9fV0pLGV9KCk7aShfZSwiQVVESU9fUkFURSIsWzU1MDAsMTFlMywyMmUzLDQ0ZTNdKSxuZXcgSygiVHNEZW11eGVyIik7dmFyIHdlPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0LGEsbil7cih0aGlzLGUpLHRoaXMuZHY9bmV3IERhdGFWaWV3KHQpLHRoaXMuc3RhcnQ9dGhpcy5vZmZzZXQ9YXx8dGhpcy5kdi5ieXRlT2Zmc2V0LHRoaXMuZW5kPW4/dGhpcy5zdGFydCtuOnRoaXMuc3RhcnQrdGhpcy5kdi5ieXRlTGVuZ3RofXJldHVybiBuKGUsW3trZXk6ImJ1ZmZlciIsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZHYuYnVmZmVyfX0se2tleToidW5yZWFkTGVuZ3RoIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gTWF0aC5tYXgodGhpcy5lbmQtdGhpcy5vZmZzZXQsMCl9fSx7a2V5OiJzaXplIixnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lbmQtdGhpcy5zdGFydH19LHtrZXk6InJlYWRGbG9hdCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9MDtzd2l0Y2goZSl7Y2FzZSA0OnQ9dGhpcy5kdi5nZXRGbG9hdDMyKHRoaXMub2Zmc2V0KTticmVhaztjYXNlIDg6dD10aGlzLmR2LmdldEZsb2F0NjQodGhpcy5vZmZzZXQpO2JyZWFrO2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKCJyZWFkICIuY29uY2F0KGUsIi1ieXRlIGZsb2F0IGlzIG5vdCBzdXBwb3J0ZWQiKSl9cmV0dXJuIHRoaXMub2Zmc2V0Kz1lLHR9fSx7a2V5OiJiYWNrIix2YWx1ZTpmdW5jdGlvbihlKXt0aGlzLm9mZnNldC09ZX19LHtrZXk6InNraXAiLHZhbHVlOmZ1bmN0aW9uKGUpe3RoaXMub2Zmc2V0Kz1lfX0se2tleToicmVhZEludCIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5vZmZzZXQ7c3dpdGNoKHRoaXMub2Zmc2V0Kz1lLGUpe2Nhc2UgMTpyZXR1cm4gdGhpcy5kdi5nZXRJbnQ4KHQpO2Nhc2UgMjpyZXR1cm4gdGhpcy5kdi5nZXRJbnQxNih0KTtjYXNlIDQ6cmV0dXJuIHRoaXMuZHYuZ2V0SW50MzIodCk7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoInJlYWQgIi5jb25jYXQoZSwiLWJ5dGUgaW50ZWdlcnMgaXMgbm90IHN1cHBvcnRlZCIpKX19fSx7a2V5OiJyZWFkIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLm9mZnNldDtzd2l0Y2godGhpcy5vZmZzZXQrPWUsZSl7Y2FzZSAxOnJldHVybiB0aGlzLmR2LmdldFVpbnQ4KHQpO2Nhc2UgMjpyZXR1cm4gdGhpcy5kdi5nZXRVaW50MTYodCk7Y2FzZSAzOnJldHVybih0aGlzLmR2LmdldFVpbnQxNih0KTw8OCkrdGhpcy5kdi5nZXRVaW50OCh0KzIpO2Nhc2UgNDpyZXR1cm4gdGhpcy5kdi5nZXRVaW50MzIodCk7ZGVmYXVsdDpyZXR1cm4gdGhpcy5iYWNrKGUtNCksdGhpcy5yZWFkKGUtNCkrdGhpcy5kdi5nZXRVaW50MzIodCkqTWF0aC5wb3coMjU2LGUtNCl9fX0se2tleToid3JpdGUiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7dmFyIHI9dGhpcy5vZmZzZXQ7c3dpdGNoKHRoaXMub2Zmc2V0Kz1lLGUpe2Nhc2UgMTpyZXR1cm4gdGhpcy5kdi5zZXRVaW50OChyLHQpO2Nhc2UgMjpyZXR1cm4gdGhpcy5kdi5zZXRVaW50MTYocix0KTtjYXNlIDM6cmV0dXJuIHRoaXMuZHYuc2V0VWludDgocix0Pj4+MTYpLHRoaXMuZHYuc2V0VWludDE2KHIrMSw2NTUzNSZ0KTtjYXNlIDQ6cmV0dXJuIHRoaXMuZHYuc2V0VWludDMyKHIsdCk7ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoIndyaXRlICIuY29uY2F0KGUsIi1ieXRlIGludGVnZXJzIGlzIG5vdCBzdXBwb3J0ZWQiKSl9fX0se2tleToicmVhZFRvQnVmZmVyIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdDtyZXR1cm4gdD10aGlzLm9mZnNldHx8ZT90aGlzLmR2LmJ1ZmZlci5zbGljZSh0aGlzLm9mZnNldCxlP3RoaXMub2Zmc2V0K2U6dGhpcy5lbmQpOnRoaXMuZHYuYnVmZmVyLHRoaXMub2Zmc2V0Kz10LmJ5dGVMZW5ndGgsdH19LHtrZXk6InJlYWRUb1VpbnQ4Iix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1uZXcgVWludDhBcnJheSh0aGlzLmR2LmJ1ZmZlcix0aGlzLm9mZnNldCxlfHx0aGlzLnVucmVhZExlbmd0aCk7cmV0dXJuIHRoaXMub2Zmc2V0Kz10LmJ5dGVMZW5ndGgsdH19LHtrZXk6InJlYWRTdHJpbmciLHZhbHVlOmZ1bmN0aW9uKGUpe2Zvcih2YXIgdD0wLHI9IiI7dDxlO3QrKylyKz1TdHJpbmcuZnJvbUNoYXJDb2RlKHRoaXMuZHYuZ2V0VWludDgodGhpcy5vZmZzZXQpKSx0aGlzLm9mZnNldCsrO3JldHVybiByfX1dLFt7a2V5OiJmcm9tVWludDgiLHZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiBuZXcgZSh0LmJ1ZmZlcix0LmJ5dGVPZmZzZXQsdC5ieXRlTGVuZ3RoKX19LHtrZXk6ImNvbmNhdFVpbnQ4cyIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9bmV3IFVpbnQ4QXJyYXkoZS5yZWR1Y2UoKGZ1bmN0aW9uKGUsdCl7cmV0dXJuIGUrdC5ieXRlTGVuZ3RofSksMCkpLHI9MDtyZXR1cm4gZS5mb3JFYWNoKChmdW5jdGlvbihlKXt0LnNldChlLHIpLHIrPWUuYnl0ZUxlbmd0aH0pKSx0fX0se2tleToiY29uY2F0VWludDgiLHZhbHVlOmZ1bmN0aW9uKCl7Zm9yKHZhciBlPWFyZ3VtZW50cy5sZW5ndGgsdD1uZXcgQXJyYXkoZSkscj0wO3I8ZTtyKyspdFtyXT1hcmd1bWVudHNbcl07cmV0dXJuIHRoaXMuY29uY2F0VWludDhzKHQpfX1dKSxlfSgpLHhlPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0LGEpe3IodGhpcyxlKSx0aGlzLm9mZnNldD0wLHRoaXMudmFsPXQsdGhpcy5zaXplPWF9cmV0dXJuIG4oZSxbe2tleToic2tpcCIsdmFsdWU6ZnVuY3Rpb24oZSl7dGhpcy5vZmZzZXQrPWV9fSx7a2V5OiJyZWFkIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLnNpemUtdGhpcy5vZmZzZXQtZTtpZih0Pj0wKXt2YXIgcj0wLGE9MDtpZih0aGlzLm9mZnNldCs9ZSx0aGlzLnNpemU+MzEpe2Zvcig7YTxlO2ErKylyKz1NYXRoLnBvdygyLGEpO3JldHVybiB0aGlzLnZhbC9NYXRoLnBvdygyLHQpJnJ9Zm9yKDthPGU7YSsrKXIrPTE8PGE7cmV0dXJuIHRoaXMudmFsPj4+dCZyfXRocm93IG5ldyBFcnJvcigidGhlIG51bWJlciBvZiB0aGUgcmVhZCBvcGVyYXRpb24gZXhjZWVkcyB0aGUgdG90YWwgbGVuZ3RoIGxpbWl0IG9mIGJpdHMiKX19XSxbe2tleToiZnJvbUJ5dGUiLHZhbHVlOmZ1bmN0aW9uKHQscil7cmV0dXJuIG5ldyBlKHQucmVhZChyKSxyPDwzKX19XSksZX0oKSxTZT1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoKXtyKHRoaXMsZSl9cmV0dXJuIG4oZSxudWxsLFt7a2V5OiJmaW5kQm94Iix2YWx1ZTpmdW5jdGlvbih0LHIpe3ZhciBhPWFyZ3VtZW50cy5sZW5ndGg+MiYmdm9pZCAwIT09YXJndW1lbnRzWzJdP2FyZ3VtZW50c1syXTowLG49W107aWYoIXQpcmV0dXJuIG47Zm9yKHZhciBpPTAscz0iIixvPTA7dC5sZW5ndGg+Nzspe2lmKGk9dGUodCkscz1TdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsdC5zdWJhcnJheSg0LDgpKSxvPTgsMT09PWk/KGk9cmUodCw4KSxvKz04KTppfHwoaT10Lmxlbmd0aCksIXJbMF18fHM9PT1yWzBdKXt2YXIgdT10LnN1YmFycmF5KDAsaSk7aWYoIShyLmxlbmd0aDwyKSlyZXR1cm4gZS5maW5kQm94KHUuc3ViYXJyYXkobyksci5zbGljZSgxKSxhK28pO24ucHVzaCh7c3RhcnQ6YSxzaXplOmksaGVhZGVyU2l6ZTpvLHR5cGU6cyxkYXRhOnV9KX1hKz1pLHQ9dC5zdWJhcnJheShpKX1yZXR1cm4gbn19LHtrZXk6InRmaGQiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiBCZShlLCEwLChmdW5jdGlvbihlLHQpe2UudHJhY2tJZD10ZSh0KTt2YXIgcj00LGE9MSZlLmZsYWdzLG49MiZlLmZsYWdzLGk9OCZlLmZsYWdzLHM9MTYmZS5mbGFncyxvPTMyJmUuZmxhZ3M7YSYmKHIrPTQsZS5iYXNlRGF0YU9mZnNldD10ZSh0LHIpLHIrPTQpLG4mJihlLnNhbXBsZURlc2NyaXB0aW9uSW5kZXg9dGUodCxyKSxyKz00KSxpJiYoZS5kZWZhdWx0U2FtcGxlRHVyYXRpb249dGUodCxyKSxyKz00KSxzJiYoZS5kZWZhdWx0U2FtcGxlU2l6ZT10ZSh0LHIpLHIrPTQpLG8mJihlLmRlZmF1bHRTYW1wbGVGbGFncz10ZSh0LHIpKX0pKX19LHtrZXk6InNpZHgiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiBCZShlLCEwLChmdW5jdGlvbihlLHQpe3ZhciByPTA7ZS5yZWZlcmVuY2VfSUQ9dGUodCxyKSxyKz00LGUudGltZXNjYWxlPXRlKHQscikscis9NCwwPT09ZS52ZXJzaW9uPyhlLmVhcmxpZXN0X3ByZXNlbnRhdGlvbl90aW1lPXRlKHQscikscis9NCxlLmZpcnN0X29mZnNldD10ZSh0LHIpLHIrPTQpOihlLmVhcmxpZXN0X3ByZXNlbnRhdGlvbl90aW1lPXJlKHQscikscis9OCxlLmZpcnN0X29mZnNldD1yZSh0LHIpLHIrPTgpLHIrPTIsZS5yZWZlcmVuY2VzPVtdO3ZhciBhPWVlKHQscik7cis9Mjtmb3IodmFyIG49MDtuPGE7bisrKXt2YXIgaT17fTtlLnJlZmVyZW5jZXMucHVzaChpKTt2YXIgcz10ZSh0LHIpO3IrPTQsaS5yZWZlcmVuY2VfdHlwZT1zPj4zMSYxLGkucmVmZXJlbmNlZF9zaXplPTIxNDc0ODM2NDcmcyxpLnN1YnNlZ21lbnRfZHVyYXRpb249dGUodCxyKSxzPXRlKHQscis9NCkscis9NCxpLnN0YXJ0c193aXRoX1NBUD1zPj4zMSYxLGkuU0FQX3R5cGU9cz4+MjgmNyxpLlNBUF9kZWx0YV90aW1lPTI2ODQzNTQ1NSZzfX0pKX19LHtrZXk6Im1vb3YiLHZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiBCZSh0LCExLChmdW5jdGlvbih0LHIsYSl7dC5tdmhkPWUubXZoZChlLmZpbmRCb3gocixbIm12aGQiXSxhKVswXSksdC50cmFrPWUuZmluZEJveChyLFsidHJhayJdLGEpLm1hcCgoZnVuY3Rpb24odCl7cmV0dXJuIGUudHJhayh0KX0pKSx0LnBzc2g9ZS5wc3NoKGUuZmluZEJveChyLFsicHNzaCJdLGEpWzBdKX0pKX19LHtrZXk6Im12aGQiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiBCZShlLCEwLChmdW5jdGlvbihlLHQpe3ZhciByPTA7MT09PWUudmVyc2lvbj8oZS50aW1lc2NhbGU9dGUodCwxNiksZS5kdXJhdGlvbj1yZSh0LDIwKSxyKz0yOCk6KGUudGltZXNjYWxlPXRlKHQsOCksZS5kdXJhdGlvbj10ZSh0LDEyKSxyKz0xNiksZS5uZXh0VHJhY2tJZD10ZSh0LHIrNzYpfSkpfX0se2tleToidHJhayIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIEJlKHQsITEsKGZ1bmN0aW9uKHQscixhKXt0LnRraGQ9ZS50a2hkKGUuZmluZEJveChyLFsidGtoZCJdLGEpWzBdKSx0Lm1kaWE9ZS5tZGlhKGUuZmluZEJveChyLFsibWRpYSJdLGEpWzBdKX0pKX19LHtrZXk6InRraGQiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiBCZShlLCEwLChmdW5jdGlvbihlLHQpe3ZhciByPXdlLmZyb21VaW50OCh0KTsxPT09ZS52ZXJzaW9uPyhyLnJlYWQoOCksci5yZWFkKDgpLGUudHJhY2tJZD1yLnJlYWQoNCksci5yZWFkKDQpLGUuZHVyYXRpb249ci5yZWFkKDgpKTooci5yZWFkKDQpLHIucmVhZCg0KSxlLnRyYWNrSWQ9ci5yZWFkKDQpLHIucmVhZCg0KSxlLmR1cmF0aW9uPXIucmVhZCg0KSksci5za2lwKDE2KSxlLm1hdHJpeD1bXTtmb3IodmFyIGE9MDthPDM2O2ErKyllLm1hdHJpeC5wdXNoKHIucmVhZCgxKSk7ci5iYWNrKDM2KTtmb3IodmFyIG4saT1bXSxzPTA7czwzO3MrKylpLnB1c2goc2Uoci5yZWFkSW50KDIpLHIucmVhZEludCgyKSkpLGkucHVzaChzZShyLnJlYWRJbnQoMiksci5yZWFkSW50KDIpKSksbj1yLnJlYWRJbnQoNCksaS5wdXNoKHNlKG4+PjMwLDEwNzM3NDE4MjMmbikpO2Uucm90YXRpb249ZnVuY3Rpb24oZSl7aWYoZS5sZW5ndGg8NSlyZXR1cm4gMDt2YXIgdD1NYXRoLmh5cG90KGVbMF0sZVszXSkscj1NYXRoLmh5cG90KGVbMV0sZVs0XSk7cmV0dXJuIDA9PT10fHwwPT09cj8wOjE4MCpNYXRoLmF0YW4yKGVbMV0vcixlWzBdL3QpL01hdGguUEl9KGkpLGUud2lkdGg9ci5yZWFkKDQpLGUuaGVpZ2h0PXIucmVhZCg0KX0pKX19LHtrZXk6Im1kaWEiLHZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiBCZSh0LCExLChmdW5jdGlvbih0LHIsYSl7dC5tZGhkPWUubWRoZChlLmZpbmRCb3gocixbIm1kaGQiXSxhKVswXSksdC5oZGxyPWUuaGRscihlLmZpbmRCb3gocixbImhkbHIiXSxhKVswXSksdC5taW5mPWUubWluZihlLmZpbmRCb3gocixbIm1pbmYiXSxhKVswXSl9KSl9fSx7a2V5OiJtZGhkIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gQmUoZSwhMCwoZnVuY3Rpb24oZSx0KXt2YXIgcj0wOzE9PT1lLnZlcnNpb24/KGUudGltZXNjYWxlPXRlKHQsMTYpLGUuZHVyYXRpb249cmUodCwyMCkscis9MjgpOihlLnRpbWVzY2FsZT10ZSh0LDgpLGUuZHVyYXRpb249dGUodCwxMikscis9MTYpO3ZhciBhPWVlKHQscik7ZS5sYW5ndWFnZT1TdHJpbmcuZnJvbUNoYXJDb2RlKDk2KyhhPj4xMCYzMSksOTYrKGE+PjUmMzEpLDk2KygzMSZhKSl9KSl9fSx7a2V5OiJoZGxyIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gQmUoZSwhMCwoZnVuY3Rpb24oZSx0KXswPT09ZS52ZXJzaW9uJiYoZS5oYW5kbGVyVHlwZT1TdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsdC5zdWJhcnJheSg0LDgpKSl9KSl9fSx7a2V5OiJtaW5mIix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gQmUodCwhMSwoZnVuY3Rpb24odCxyLGEpe3Qudm1oZD1lLnZtaGQoZS5maW5kQm94KHIsWyJ2bWhkIl0sYSlbMF0pLHQuc21oZD1lLnNtaGQoZS5maW5kQm94KHIsWyJzbWhkIl0sYSlbMF0pLHQuc3RibD1lLnN0YmwoZS5maW5kQm94KHIsWyJzdGJsIl0sYSlbMF0pfSkpfX0se2tleToidm1oZCIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIEJlKGUsITAsKGZ1bmN0aW9uKGUsdCl7ZS5ncmFwaGljc21vZGU9ZWUodCksZS5vcGNvbG9yPVtlZSh0LDIpLGVlKHQsNCksZWUodCw2KV19KSl9fSx7a2V5OiJzbWhkIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gQmUoZSwhMCwoZnVuY3Rpb24oZSx0KXtlLmJhbGFuY2U9ZWUodCl9KSl9fSx7a2V5OiJzdGJsIix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gQmUodCwhMSwoZnVuY3Rpb24odCxyLGEpe3ZhciBuLGksczt0LnN0c2Q9ZS5zdHNkKGUuZmluZEJveChyLFsic3RzZCJdLGEpWzBdKSx0LnN0dHM9ZS5zdHRzKGUuZmluZEJveChyLFsic3R0cyJdLGEpWzBdKSx0LmN0dHM9ZS5jdHRzKGUuZmluZEJveChyLFsiY3R0cyJdLGEpWzBdKSx0LnN0c2M9ZS5zdHNjKGUuZmluZEJveChyLFsic3RzYyJdLGEpWzBdKSx0LnN0c3o9ZS5zdHN6KGUuZmluZEJveChyLFsic3RzeiJdLGEpWzBdKSx0LnN0Y289ZS5zdGNvKGUuZmluZEJveChyLFsic3RjbyJdLGEpWzBdKSx0LnN0Y298fCh0LmNvNjQ9ZS5jbzY0KGUuZmluZEJveChyLFsiY282NCJdLGEpWzBdKSx0LnN0Y289dC5jbzY0KTt2YXIgbz1udWxsPT09KG49dC5zdHNkLmVudHJpZXNbMF0pfHx2b2lkIDA9PT1ufHxudWxsPT09KGk9bi5zaW5mKXx8dm9pZCAwPT09aXx8bnVsbD09PShzPWkuc2NoaSl8fHZvaWQgMD09PXM/dm9pZCAwOnMudGVuYy5kZWZhdWx0X0lWX3NpemU7dC5zdHNzPWUuc3RzcyhlLmZpbmRCb3gocixbInN0c3MiXSxhKVswXSksdC5zZW5jPWUuc2VuYyhlLmZpbmRCb3gocixbInNlbmMiXSxhKVswXSxvKX0pKX19LHtrZXk6InNlbmMiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PWFyZ3VtZW50cy5sZW5ndGg+MSYmdm9pZCAwIT09YXJndW1lbnRzWzFdP2FyZ3VtZW50c1sxXTo4O3JldHVybiBCZShlLCEwLChmdW5jdGlvbihlLHIpe3ZhciBhPTAsbj10ZShyLGEpO2ErPTQsZS5zYW1wbGVzPVtdO2Zvcih2YXIgaT0wO2k8bjtpKyspe2Zvcih2YXIgcz17SW5pdGlhbGl6YXRpb25WZWN0b3I6W119LG89MDtvPHQ7bysrKXMuSW5pdGlhbGl6YXRpb25WZWN0b3Jbb109clthK29dO2lmKGErPXQsMiZlLmZsYWdzKXtzLnN1YnNhbXBsZXM9W107dmFyIHU9ZWUocixhKTthKz0yO2Zvcih2YXIgYz0wO2M8dTtjKyspe3ZhciBsPXt9O2wuQnl0ZXNPZkNsZWFyRGF0YT1lZShyLGEpLGErPTIsbC5CeXRlc09mUHJvdGVjdGVkRGF0YT10ZShyLGEpLGErPTQscy5zdWJzYW1wbGVzLnB1c2gobCl9fWUuc2FtcGxlcy5wdXNoKHMpfX0pKX19LHtrZXk6InBzc2giLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiBCZShlLCEwLChmdW5jdGlvbihlLHQpe2Zvcih2YXIgcj1bXSxhPVtdLG49MCxpPTA7aTwxNjtpKyspYS5wdXNoKFVlKHRbbitpXSkpO2lmKG4rPTE2LGUudmVyc2lvbj4wKXt2YXIgcz10ZSh0LG4pO24rPTQ7Zm9yKHZhciBvPTA7bzwoIiIrcykubGVuZ3RoO28rKylmb3IodmFyIHU9MDt1PDE2O3UrKyl7dmFyIGM9dFtuXTtuKz0xLHIucHVzaChVZShjKSl9fXZhciBsPXRlKHQsbik7ZS5kYXRhX3NpemU9bCxuKz00LGUua2lkPXIsZS5zeXN0ZW1faWQ9YSxlLmJ1ZmZlcj10fSkpfX0se2tleToic3RzZCIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIEJlKHQsITAsKGZ1bmN0aW9uKHQscixhKXt0LmVudHJ5Q291bnQ9dGUociksdC5lbnRyaWVzPWUuZmluZEJveChyLnN1YmFycmF5KDQpLFtdLGErNCkubWFwKChmdW5jdGlvbih0KXtzd2l0Y2godC50eXBlKXtjYXNlImF2MDEiOnJldHVybiBlLmF2MDEodCk7Y2FzZSJhdmMxIjpjYXNlImF2YzIiOmNhc2UiYXZjMyI6Y2FzZSJhdmM0IjpyZXR1cm4gZS5hdmMxKHQpO2Nhc2UiaHZjMSI6Y2FzZSJoZXYxIjpyZXR1cm4gZS5odmMxKHQpO2Nhc2UibXA0YSI6cmV0dXJuIGUubXA0YSh0KTtjYXNlImFsYXciOmNhc2UidWxhdyI6cmV0dXJuIGUuYWxhdyh0KTtjYXNlImVuY2EiOnJldHVybiBCZSh0LCExLChmdW5jdGlvbih0LHIsYSl7dC5jaGFubmVsQ291bnQ9ZWUociwxNiksdC5zYW1wbGVzaXplPWVlKHIsMTgpLHQuc2FtcGxlUmF0ZT10ZShyLDI0KS82NTUzNixyPXIuc3ViYXJyYXkoMjgpLHQuc2luZj1lLnNpbmYoZS5maW5kQm94KHIsWyJzaW5mIl0sYSlbMF0pLHQuZXNkcz1lLmVzZHMoZS5maW5kQm94KHIsWyJlc2RzIl0sYSlbMF0pfSkpO2Nhc2UiZW5jdiI6cmV0dXJuIEJlKHQsITEsKGZ1bmN0aW9uKHQscixhKXt0LndpZHRoPWVlKHIsMjQpLHQuaGVpZ2h0PWVlKHIsMjYpLHQuaG9yaXpyZXNvbHV0aW9uPXRlKHIsMjgpLHQudmVydHJlc29sdXRpb249dGUociwzMikscj1yLnN1YmFycmF5KDc4KSx0LnNpbmY9ZS5zaW5mKGUuZmluZEJveChyLFsic2luZiJdLGEpWzBdKSx0LmF2Y0M9ZS5hdmNDKGUuZmluZEJveChyLFsiYXZjQyJdLGEpWzBdKSx0Lmh2Y0M9ZS5odmNDKGUuZmluZEJveChyLFsiaHZjQyJdLGEpWzBdKSx0LnBhc3A9ZS5wYXNwKGUuZmluZEJveChyLFsicGFzcCJdLGEpWzBdKX0pKX19KSkuZmlsdGVyKEJvb2xlYW4pfSkpfX0se2tleToidGVuYyIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIEJlKGUsITEsKGZ1bmN0aW9uKGUsdCl7dmFyIHI9NjtlLmRlZmF1bHRfSXNFbmNyeXB0ZWQ9dFtyXSxyKz0xLGUuZGVmYXVsdF9JVl9zaXplPXRbcl0scis9MSxlLmRlZmF1bHRfS0lEPVtdO2Zvcih2YXIgYT0wO2E8MTY7YSsrKWUuZGVmYXVsdF9LSUQucHVzaChVZSh0W3JdKSkscis9MX0pKX19LHtrZXk6InNjaGkiLHZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiBCZSh0LCExLChmdW5jdGlvbih0LHIsYSl7dC50ZW5jPWUudGVuYyhlLmZpbmRCb3gocixbInRlbmMiXSxhKVswXSl9KSl9fSx7a2V5OiJzaW5mIix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gQmUodCwhMSwoZnVuY3Rpb24odCxyLGEpe3Quc2NoaT1lLnNjaGkoZS5maW5kQm94KHIsWyJzY2hpIl0sYSlbMF0pLHQuZnJtYT1lLmZybWEoZS5maW5kQm94KHIsWyJmcm1hIl0sYSlbMF0pfSkpfX0se2tleToiZnJtYSIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIEJlKGUsITEsKGZ1bmN0aW9uKGUsdCl7ZS5kYXRhX2Zvcm1hdD0iIjtmb3IodmFyIHI9MDtyPDQ7cisrKWUuZGF0YV9mb3JtYXQrPVN0cmluZy5mcm9tQ2hhckNvZGUodFtyXSl9KSl9fSx7a2V5OiJjb2xyIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gQmUoZSwhMSwoZnVuY3Rpb24odCxyKXt2YXIgYT13ZS5mcm9tVWludDgocik7dC5kYXRhPWUuZGF0YSx0LmNvbG9yVHlwZT1hLnJlYWRTdHJpbmcoNCksIm5jbHgiPT09dC5jb2xvclR5cGU/KHQuY29sb3JQcmltYXJpZXM9YS5yZWFkKDIpLHQudHJhbnNmZXJDaGFyYWN0ZXJpc3RpY3M9YS5yZWFkKDIpLHQubWF0cml4Q29lZmZpY2llbnRzPWEucmVhZCgyKSx0LmZ1bGxSYW5nZUZsYWc9YS5yZWFkKDEpPj43KToicklDQyIhPT10LmNvbG9yVHlwZSYmInByb2YiIT09dC5jb2xvclR5cGV8fCh0LmljY1Byb2ZpbGU9ci5yZWFkVG9VaW50OCgpKX0pKX19LHtrZXk6ImF2MDEiLHZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiBCZSh0LCExLChmdW5jdGlvbih0LHIsYSl7dmFyIG49QWUodCxyKSxpPXIuc3ViYXJyYXkobik7YSs9bix0LmF2MUM9ZS5hdjFDKGUuZmluZEJveChpLFsiYXYxQyJdLGEpWzBdKSx0LmNvbHI9ZS5jb2xyKGUuZmluZEJveChpLFsiY29sciJdLGEpWzBdKX0pKX19LHtrZXk6ImF2MUMiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiBCZShlLCExLChmdW5jdGlvbih0LHIpe3QuZGF0YT1lLmRhdGE7dmFyIGEsbj13ZS5mcm9tVWludDgociksaT14ZS5mcm9tQnl0ZShuLDQpO3QubWFya2VyPWkucmVhZCgxKSx0LnZlcnNpb249aS5yZWFkKDcpLHQuc2VxUHJvZmlsZT1pLnJlYWQoMyksdC5zZXFMZXZlbElkeDA9aS5yZWFkKDUpLHQuc2VxVGllcjA9aS5yZWFkKDEpLHQuaGlnaEJpdGRlcHRoPWkucmVhZCgxKSx0LnR3ZWx2ZUJpdD1pLnJlYWQoMSksdC5tb25vY2hyb21lPWkucmVhZCgxKSx0LmNocm9tYVN1YnNhbXBsaW5nWD1pLnJlYWQoMSksdC5jaHJvbWFTdWJzYW1wbGluZ1k9aS5yZWFkKDEpLHQuY2hyb21hU2FtcGxlUG9zaXRpb249aS5yZWFkKDIpLHQucmVzZXJ2ZWQ9aS5yZWFkKDMpLHQuaW5pdGlhbFByZXNlbnRhdGlvbkRlbGF5UHJlc2VudD1pLnJlYWQoMSksdC5pbml0aWFsUHJlc2VudGF0aW9uRGVsYXlQcmVzZW50P3QuaW5pdGlhbFByZXNlbnRhdGlvbkRlbGF5TWludXNPbmU9aS5yZWFkKDQpOnQuaW5pdGlhbFByZXNlbnRhdGlvbkRlbGF5TWludXNPbmU9MCx0LmNvbmZpZ09CVXM9bi5yZWFkVG9VaW50OCgpLDI9PT10LnNlcUxldmVsSWR4MCYmMT09PXQuaGlnaEJpdGRlcHRoP2E9MT09PXQudHdlbHZlQml0PyIxMiI6IjEwIjp0LnNlcVByb2ZpbGU8PTImJihhPTE9PT10LmhpZ2hCaXRkZXB0aD8iMTAiOiIwOCIpLHQuY29kZWM9WyJhdjAxIix0LnNlcVByb2ZpbGUsKHQuc2VxTGV2ZWxJZHgwPDEwPyIwIit0LnNlcUxldmVsSWR4MDp0LnNlcUxldmVsSWR4MCkrKHQuc2VxVGllcjA/IkgiOiJNIiksYV0uam9pbigiLiIpfSkpfX0se2tleToiYXZjMSIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIEJlKHQsITEsKGZ1bmN0aW9uKHQscixhKXt2YXIgbj1BZSh0LHIpLGk9ci5zdWJhcnJheShuKTthKz1uLHQuYXZjQz1lLmF2Y0MoZS5maW5kQm94KGksWyJhdmNDIl0sYSlbMF0pLHQucGFzcD1lLnBhc3AoZS5maW5kQm94KGksWyJwYXNwIl0sYSlbMF0pfSkpfX0se2tleToiYXZjQyIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIEJlKGUsITEsKGZ1bmN0aW9uKHQscil7dC5kYXRhPWUuZGF0YSx0LmNvbmZpZ3VyYXRpb25WZXJzaW9uPXJbMF0sdC5BVkNQcm9maWxlSW5kaWNhdGlvbj1yWzFdLHQucHJvZmlsZUNvbXBhdGliaWxpdHk9clsyXSx0LkFWQ0xldmVsSW5kaWNhdGlvbj1yWzNdLHQuY29kZWM9YWUoW3JbMV0sclsyXSxyWzNdXSksdC5sZW5ndGhTaXplTWludXNPbmU9MyZyWzRdLHQuc3BzTGVuZ3RoPTMxJnJbNV0sdC5zcHM9W107Zm9yKHZhciBhPTYsbj0wO248dC5zcHNMZW5ndGg7bisrKXt2YXIgaT1lZShyLGEpO2ErPTIsdC5zcHMucHVzaChyLnN1YmFycmF5KGEsYStpKSksYSs9aX10LnBwc0xlbmd0aD1yW2FdLGErPTEsdC5wcHM9W107Zm9yKHZhciBzPTA7czx0LnBwc0xlbmd0aDtzKyspe3ZhciBvPWVlKHIsYSk7YSs9Mix0LnBwcy5wdXNoKHIuc3ViYXJyYXkoYSxhKz1vKSksYSs9b319KSl9fSx7a2V5OiJodmMxIix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gQmUodCwhMSwoZnVuY3Rpb24odCxyLGEpe3ZhciBuPUFlKHQsciksaT1yLnN1YmFycmF5KG4pO2ErPW4sdC5odmNDPWUuaHZjQyhlLmZpbmRCb3goaSxbImh2Y0MiXSxhKVswXSksdC5wYXNwPWUucGFzcChlLmZpbmRCb3goaSxbInBhc3AiXSxhKVswXSl9KSl9fSx7a2V5OiJodmNDIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gQmUoZSwhMSwoZnVuY3Rpb24odCxyKXt0LmRhdGE9ZS5kYXRhLHQuY29kZWM9ImhldjEuMS42Lkw5My5CMCIsdC5jb25maWd1cmF0aW9uVmVyc2lvbj1yWzBdO3ZhciBhPXJbMV07dC5nZW5lcmFsUHJvZmlsZVNwYWNlPWE+PjYsdC5nZW5lcmFsVGllckZsYWc9KDMyJmEpPj41LHQuZ2VuZXJhbFByb2ZpbGVJZGM9MzEmYSx0LmdlbmVyYWxQcm9maWxlQ29tcGF0aWJpbGl0eT10ZShyLDIpLHQuZ2VuZXJhbENvbnN0cmFpbnRJbmRpY2F0b3JGbGFncz1yLnN1YmFycmF5KDYsMTIpLHQuZ2VuZXJhbExldmVsSWRjPXJbMTJdLHQuYXZnRnJhbWVSYXRlPWVlKHIsMTkpLHQubnVtT2ZBcnJheXM9clsyMl0sdC52cHM9W10sdC5zcHM9W10sdC5wcHM9W107Zm9yKHZhciBuPTIzLGk9MCxzPTAsbz0wLHU9MDt1PHQubnVtT2ZBcnJheXM7dSsrKXtpPTYzJnJbbl0scz1lZShyLG4rMSksbis9Mztmb3IodmFyIGMsbD1bXSxmPTA7ZjxzO2YrKylvPWVlKHIsbiksbis9MixsLnB1c2goci5zdWJhcnJheShuLG4rbykpLG4rPW87aWYoMzI9PT1pKShjPXQudnBzKS5wdXNoLmFwcGx5KGMsbCk7ZWxzZSBpZigzMz09PWkpe3ZhciBkOyhkPXQuc3BzKS5wdXNoLmFwcGx5KGQsbCl9ZWxzZSBpZigzND09PWkpe3ZhciBoOyhoPXQucHBzKS5wdXNoLmFwcGx5KGgsbCl9fX0pKX19LHtrZXk6InBhc3AiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiBCZShlLCExLChmdW5jdGlvbihlLHQpe2UuaFNwYWNpbmc9dGUodCksZS52U3BhY2luZz10ZSh0LDQpfSkpfX0se2tleToibXA0YSIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIEJlKHQsITEsKGZ1bmN0aW9uKHQscixhKXt2YXIgbj1UZSh0LHIpO3QuZXNkcz1lLmVzZHMoZS5maW5kQm94KHIuc3ViYXJyYXkobiksWyJlc2RzIl0sYStuKVswXSl9KSl9fSx7a2V5OiJlc2RzIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gQmUoZSwhMCwoZnVuY3Rpb24oZSx0KXtlLmNvZGVjPSJtcDRhLiI7Zm9yKHZhciByPTAsYT0wLG49MCxpPTA7dC5sZW5ndGg7KXtmb3IoaT10W3I9MF0sYT10W3IrMV0scis9MjsxMjgmYTspbj0oMTI3JmEpPDw3LGE9dFtyXSxyKz0xO2lmKG4rPTEyNyZhLDM9PT1pKXQ9dC5zdWJhcnJheShyKzMpO2Vsc2V7aWYoNCE9PWkpe2lmKDU9PT1pKXt2YXIgcz1lLmNvbmZpZz10LnN1YmFycmF5KHIscituKSxvPSgyNDgmc1swXSk+PjM7cmV0dXJuIDMxPT09byYmcy5sZW5ndGg+PTImJihvPTMyKygoNyZzWzBdKTw8MykrKCgyMjQmc1sxXSk+PjUpKSxlLm9iamVjdFR5cGU9byxlLmNvZGVjKz1vLnRvU3RyaW5nKDE2KSx2b2lkKCIuIj09PWUuY29kZWNbZS5jb2RlYy5sZW5ndGgtMV0mJihlLmNvZGVjPWUuY29kZWMuc3Vic3RyaW5nKDAsZS5jb2RlYy5sZW5ndGgtMSkpKX1yZXR1cm4gdm9pZCgiLiI9PT1lLmNvZGVjW2UuY29kZWMubGVuZ3RoLTFdJiYoZS5jb2RlYz1lLmNvZGVjLnN1YnN0cmluZygwLGUuY29kZWMubGVuZ3RoLTEpKSl9ZS5jb2RlYys9KHRbcl0udG9TdHJpbmcoMTYpKyIuIikucGFkU3RhcnQoMywiMCIpLHQ9dC5zdWJhcnJheShyKzEzKX19fSkpfX0se2tleToiYWxhdyIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIEJlKGUsITEsKGZ1bmN0aW9uKGUsdCl7VGUoZSx0KX0pKX19LHtrZXk6InN0dHMiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiBCZShlLCEwLChmdW5jdGlvbihlLHQpe2Zvcih2YXIgcj10ZSh0KSxhPVtdLG49NCxpPTA7aTxyO2krKylhLnB1c2goe2NvdW50OnRlKHQsbiksZGVsdGE6dGUodCxuKzQpfSksbis9ODtlLmVudHJ5Q291bnQ9cixlLmVudHJpZXM9YX0pKX19LHtrZXk6ImN0dHMiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiBCZShlLCEwLChmdW5jdGlvbihlLHQpe3ZhciByPXRlKHQpLGE9W10sbj00O2lmKDE9PT1lLnZlcnNpb24pZm9yKHZhciBpPTA7aTxyO2krKylhLnB1c2goe2NvdW50OnRlKHQsbiksb2Zmc2V0OnRlKHQsbis0KX0pLG4rPTg7ZWxzZSBmb3IodmFyIHM9MDtzPHI7cysrKWEucHVzaCh7Y291bnQ6dGUodCxuKSxvZmZzZXQ6LSgxK350ZSh0LG4rNCkpfSksbis9ODtlLmVudHJ5Q291bnQ9cixlLmVudHJpZXM9YX0pKX19LHtrZXk6InN0c2MiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiBCZShlLCEwLChmdW5jdGlvbihlLHQpe2Zvcih2YXIgcj10ZSh0KSxhPVtdLG49NCxpPTA7aTxyO2krKylhLnB1c2goe2ZpcnN0Q2h1bms6dGUodCxuKSxzYW1wbGVzUGVyQ2h1bms6dGUodCxuKzQpLHNhbXBsZURlc2NyaXB0aW9uSW5kZXg6dGUodCxuKzgpfSksbis9MTI7ZS5lbnRyeUNvdW50PXIsZS5lbnRyaWVzPWF9KSl9fSx7a2V5OiJzdHN6Iix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gQmUoZSwhMCwoZnVuY3Rpb24oZSx0KXt2YXIgcj10ZSh0KSxhPXRlKHQsNCksbj1bXTtpZighcilmb3IodmFyIGk9OCxzPTA7czxhO3MrKyluLnB1c2godGUodCxpKSksaSs9NDtlLnNhbXBsZVNpemU9cixlLnNhbXBsZUNvdW50PWEsZS5lbnRyeVNpemVzPW59KSl9fSx7a2V5OiJzdGNvIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gQmUoZSwhMCwoZnVuY3Rpb24oZSx0KXtmb3IodmFyIHI9dGUodCksYT1bXSxuPTQsaT0wO2k8cjtpKyspYS5wdXNoKHRlKHQsbikpLG4rPTQ7ZS5lbnRyeUNvdW50PXIsZS5lbnRyaWVzPWF9KSl9fSx7a2V5OiJjbzY0Iix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gQmUoZSwhMCwoZnVuY3Rpb24oZSx0KXtmb3IodmFyIHI9dGUodCksYT1bXSxuPTQsaT0wO2k8cjtpKyspYS5wdXNoKHJlKHQsbikpLG4rPTg7ZS5lbnRyeUNvdW50PXIsZS5lbnRyaWVzPWF9KSl9fSx7a2V5OiJzdHNzIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gQmUoZSwhMCwoZnVuY3Rpb24oZSx0KXtmb3IodmFyIHI9dGUodCksYT1bXSxuPTQsaT0wO2k8cjtpKyspYS5wdXNoKHRlKHQsbikpLG4rPTQ7ZS5lbnRyeUNvdW50PXIsZS5lbnRyaWVzPWF9KSl9fSx7a2V5OiJtb29mIix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gQmUodCwhMSwoZnVuY3Rpb24odCxyLGEpe3QubWZoZD1lLm1maGQoZS5maW5kQm94KHIsWyJtZmhkIl0sYSlbMF0pLHQudHJhZj1lLmZpbmRCb3gocixbInRyYWYiXSxhKS5tYXAoKGZ1bmN0aW9uKHQpe3JldHVybiBlLnRyYWYodCl9KSl9KSl9fSx7a2V5OiJtZmhkIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gQmUoZSwhMCwoZnVuY3Rpb24oZSx0KXtlLnNlcXVlbmNlTnVtYmVyPXRlKHQpfSkpfX0se2tleToidHJhZiIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIEJlKHQsITEsKGZ1bmN0aW9uKHQscixhKXt0LnRmaGQ9ZS50ZmhkKGUuZmluZEJveChyLFsidGZoZCJdLGEpWzBdKSx0LnRmZHQ9ZS50ZmR0KGUuZmluZEJveChyLFsidGZkdCJdLGEpWzBdKSx0LnRydW49ZS50cnVuKGUuZmluZEJveChyLFsidHJ1biJdLGEpWzBdKX0pKX19LHtrZXk6InRydW4iLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiBCZShlLCEwLChmdW5jdGlvbihlLHQpe3ZhciByPWUudmVyc2lvbixhPWUuZmxhZ3Msbj10Lmxlbmd0aCxpPWUuc2FtcGxlQ291bnQ9dGUodCkscz00O2lmKG4+cyYmMSZhJiYoZS5kYXRhT2Zmc2V0PS0oMSt+dGUodCxzKSkscys9NCksbj5zJiY0JmEmJihlLmZpcnN0U2FtcGxlRmxhZ3M9dGUodCxzKSxzKz00KSxlLnNhbXBsZXM9W10sbj5zKWZvcih2YXIgbyx1PTA7dTxpO3UrKylvPXt9LDI1NiZhJiYoby5kdXJhdGlvbj10ZSh0LHMpLHMrPTQpLDUxMiZhJiYoby5zaXplPXRlKHQscykscys9NCksMTAyNCZhJiYoby5mbGFncz10ZSh0LHMpLHMrPTQpLDIwNDgmYSYmKG8uY3RzPXI/LSgxK350ZSh0LHMrNCkpOnRlKHQscykscys9NCksZS5zYW1wbGVzLnB1c2gobyl9KSl9fSx7a2V5OiJ0ZmR0Iix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gQmUoZSwhMCwoZnVuY3Rpb24oZSx0KXsxPT09ZS52ZXJzaW9uP2UuYmFzZU1lZGlhRGVjb2RlVGltZT1yZSh0KTplLmJhc2VNZWRpYURlY29kZVRpbWU9dGUodCl9KSl9fSx7a2V5OiJwcm9iZSIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuISFlLmZpbmRCb3godCxbImZ0eXAiXSl9fSx7a2V5OiJwYXJzZVNhbXBsZUZsYWdzIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm57aXNMZWFkaW5nOigxMiZlWzBdKT4+PjIsZGVwZW5kc09uOjMmZVswXSxpc0RlcGVuZGVkT246KDE5MiZlWzFdKT4+PjYsaGFzUmVkdW5kYW5jeTooNDgmZVsxXSk+Pj40LHBhZGRpbmdWYWx1ZTooMTQmZVsxXSk+Pj4xLGlzTm9uU3luY1NhbXBsZToxJmVbMV0sZGVncmFkYXRpb25Qcmlvcml0eTplWzJdPDw4fGVbM119fX0se2tleToibW9vdlRvVHJhY2siLHZhbHVlOmZ1bmN0aW9uKGUsdCxyKXt2YXIgYSxuLGk9ZS50cmFrO2lmKGkmJmkubGVuZ3RoKXt2YXIgcz1pLmZpbmQoKGZ1bmN0aW9uKGUpe3ZhciB0LHI7cmV0dXJuInZpZGUiPT09KG51bGw9PT0odD1lLm1kaWEpfHx2b2lkIDA9PT10fHxudWxsPT09KHI9dC5oZGxyKXx8dm9pZCAwPT09cj92b2lkIDA6ci5oYW5kbGVyVHlwZSl9KSksbz1pLmZpbmQoKGZ1bmN0aW9uKGUpe3ZhciB0LHI7cmV0dXJuInNvdW4iPT09KG51bGw9PT0odD1lLm1kaWEpfHx2b2lkIDA9PT10fHxudWxsPT09KHI9dC5oZGxyKXx8dm9pZCAwPT09cj92b2lkIDA6ci5oYW5kbGVyVHlwZSl9KSk7aWYocyYmdCl7dmFyIHUsYyxsLGYsZCxoLHAsdj10LHk9bnVsbD09PSh1PXMudGtoZCl8fHZvaWQgMD09PXU/dm9pZCAwOnUudHJhY2tJZDtudWxsIT15JiYodi5pZD1zLnRraGQudHJhY2tJZCksdi50a2hkRHVyYXRpb249cy50a2hkLmR1cmF0aW9uLHYubXZoZER1cnRpb249ZS5tdmhkLmR1cmF0aW9uLHYubXZoZFRpbWVjYWxlPWUubXZoZC50aW1lc2NhbGUsdi50aW1lc2NhbGU9di5mb3JtYXRUaW1lc2NhbGU9cy5tZGlhLm1kaGQudGltZXNjYWxlLHYuZHVyYXRpb249cy5tZGlhLm1kaGQuZHVyYXRpb258fHYubXZoZER1cnRpb24vdi5tdmhkVGltZWNhbGUqdi50aW1lc2NhbGUsdi5yb3RhdGlvbj1zLnRraGQucm90YXRpb24sdi5tYXRyaXg9cy50a2hkLm1hdHJpeDt2YXIgbSxnLGssYixfLHcsUyxBLEU9cy5tZGlhLm1pbmYuc3RibC5zdHNkLmVudHJpZXNbMF07aWYodi53aWR0aD1FLndpZHRoLHYuaGVpZ2h0PUUuaGVpZ2h0LEUucGFzcCYmKHYuc2FyUmF0aW89W0UucGFzcC5oU3BhY2luZyxFLnBhc3AudlNwYWNpbmddKSxFLmF2MUMpdi5jb2RlY1R5cGU9eCx2LmNvZGVjPUUuYXYxQy5jb2RlYyx2LmF2MUM9RS5hdjFDLmRhdGEsdi5jb2xyPUUuY29sci5kYXRhO2Vsc2UgaWYoRS5odmNDKXYuY29kZWNUeXBlPUQsdi5jb2RlYz1FLmh2Y0MuY29kZWMsdi52cHM9RS5odmNDLnZwcyx2LnNwcz1FLmh2Y0Muc3BzLHYucHBzPUUuaHZjQy5wcHMsdi5odmNDPUUuaHZjQy5kYXRhO2Vsc2V7aWYoIUUuYXZjQyl0aHJvdyBuZXcgRXJyb3IoInVua25vd24gdmlkZW8gc3RzZCBlbnRyeSIpO3YuY29kZWM9RS5hdmNDLmNvZGVjLHYuc3BzPUUuYXZjQy5zcHMsdi5wcHM9RS5hdmNDLnBwc31pZih2LnByZXNlbnQ9ITAsdi5leHQ9e30sdi5leHQuc3Rzcz1udWxsPT09KGM9cy5tZGlhKXx8dm9pZCAwPT09Y3x8bnVsbD09PShsPWMubWluZil8fHZvaWQgMD09PWx8fG51bGw9PT0oZj1sLnN0YmwpfHx2b2lkIDA9PT1mP3ZvaWQgMDpmLnN0c3Msdi5leHQuY3R0cz1udWxsPT09KGQ9cy5tZGlhKXx8dm9pZCAwPT09ZHx8bnVsbD09PShoPWQubWluZil8fHZvaWQgMD09PWh8fG51bGw9PT0ocD1oLnN0YmwpfHx2b2lkIDA9PT1wP3ZvaWQgMDpwLmN0dHMsRSYmImVuY3YiPT09RS50eXBlKXYuaXNWaWRlb0VuY3J5cHRpb249ITAsRS5kZWZhdWx0X0tJRD1udWxsPT09KG09RS5zaW5mKXx8dm9pZCAwPT09bXx8bnVsbD09PShnPW0uc2NoaSl8fHZvaWQgMD09PWc/dm9pZCAwOmcudGVuYy5kZWZhdWx0X0tJRCxFLmRlZmF1bHRfSXNFbmNyeXB0ZWQ9bnVsbD09PShrPUUuc2luZil8fHZvaWQgMD09PWt8fG51bGw9PT0oYj1rLnNjaGkpfHx2b2lkIDA9PT1iP3ZvaWQgMDpiLnRlbmMuZGVmYXVsdF9Jc0VuY3J5cHRlZCxFLmRlZmF1bHRfSVZfc2l6ZT1udWxsPT09KF89RS5zaW5mKXx8dm9pZCAwPT09X3x8bnVsbD09PSh3PV8uc2NoaSl8fHZvaWQgMD09PXc/dm9pZCAwOncudGVuYy5kZWZhdWx0X0lWX3NpemUsdi52aWRlb1NlbmM9cy5tZGlhLm1pbmYuc3RibC5zZW5jJiZzLm1kaWEubWluZi5zdGJsLnNlbmMuc2FtcGxlcyxFLmRhdGFfZm9ybWF0PW51bGw9PT0oUz1FLnNpbmYpfHx2b2lkIDA9PT1TfHxudWxsPT09KEE9Uy5mcm1hKXx8dm9pZCAwPT09QT92b2lkIDA6QS5kYXRhX2Zvcm1hdCx2LnVzZUVNRT1lLnVzZUVNRSx2LmtpZFZhbHVlPWUua2lkVmFsdWUsdi5wc3NoPWUucHNzaCx2LmVuY3Y9RX1pZihvJiZyKXt2YXIgVSxDLFAsSSxNLHosTyxSLEwsVj1yLEY9bnVsbD09PShVPW8udGtoZCl8fHZvaWQgMD09PVU/dm9pZCAwOlUudHJhY2tJZDtudWxsIT1GJiYoVi5pZD1vLnRraGQudHJhY2tJZCksVi50a2hkRHVyYXRpb249by50a2hkLmR1cmF0aW9uLFYubXZoZER1cnRpb249ZS5tdmhkLmR1cmF0aW9uLFYubXZoZFRpbWVjYWxlPWUubXZoZC50aW1lc2NhbGUsVi50aW1lc2NhbGU9Vi5mb3JtYXRUaW1lc2NhbGU9by5tZGlhLm1kaGQudGltZXNjYWxlLFYuZHVyYXRpb249by5tZGlhLm1kaGQuZHVyYXRpb258fFYubXZoZER1cnRpb24vVi5tdmhkVGltZWNhbGUqVi50aW1lc2NhbGU7dmFyIE4saixHLEgsSyxxLFcsWCxZPW8ubWRpYS5taW5mLnN0Ymwuc3RzZC5lbnRyaWVzWzBdO3N3aXRjaChWLnNhbXBsZVNpemU9WS5zYW1wbGVTaXplLFYuc2FtcGxlUmF0ZT1ZLnNhbXBsZVJhdGUsVi5jaGFubmVsQ291bnQ9WS5jaGFubmVsQ291bnQsVi5wcmVzZW50PSEwLFkudHlwZSl7Y2FzZSJhbGF3IjpWLmNvZGVjVHlwZT1WLmNvZGVjPVQsVi5zYW1wbGVSYXRlPThlMzticmVhaztjYXNlInVsYXciOlYuY29kZWNUeXBlPVYuY29kZWM9QixWLnNhbXBsZVJhdGU9OGUzO2JyZWFrO2RlZmF1bHQ6Vi5zYW1wbGVEdXJhdGlvbj1vZS5nZXRGcmFtZUR1cmF0aW9uKFYuc2FtcGxlUmF0ZSxWLnRpbWVzY2FsZSksVi5zYW1wbGVSYXRlSW5kZXg9b2UuZ2V0UmF0ZUluZGV4QnlSYXRlKFYuc2FtcGxlUmF0ZSksVi5vYmplY3RUeXBlPShudWxsPT09KGE9WS5lc2RzKXx8dm9pZCAwPT09YT92b2lkIDA6YS5vYmplY3RUeXBlKXx8MixZLmVzZHMmJihWLmNvbmZpZz1BcnJheS5mcm9tKFkuZXNkcy5jb25maWcpKSxWLmNvZGVjPShudWxsPT09KG49WS5lc2RzKXx8dm9pZCAwPT09bj92b2lkIDA6bi5jb2RlYyl8fCJtcDRhLjQwLjIifWlmKFYuc2FtcGxlRHVyYXRpb249b2UuZ2V0RnJhbWVEdXJhdGlvbihWLnNhbXBsZVJhdGUsVi50aW1lc2NhbGUpLFYub2JqZWN0VHlwZT0obnVsbD09PShDPVkuZXNkcyl8fHZvaWQgMD09PUM/dm9pZCAwOkMub2JqZWN0VHlwZSl8fDIsWS5lc2RzJiYoWS5lc2RzLmNvbmZpZz9WLmNvbmZpZz1BcnJheS5mcm9tKFkuZXNkcy5jb25maWcpOmNvbnNvbGUud2FybigiZXNkcyBjb25maWcgaXMgbnVsbCIpKSxWLmNvZGVjPShudWxsPT09KFA9WS5lc2RzKXx8dm9pZCAwPT09UD92b2lkIDA6UC5jb2RlYyl8fCJtcDRhLjQwLjIiLFYuc2FtcGxlUmF0ZUluZGV4PW9lLmdldFJhdGVJbmRleEJ5UmF0ZShWLnNhbXBsZVJhdGUpLFYuZXh0PXt9LFYuZXh0LnN0c3M9bnVsbD09PShJPW8ubWRpYSl8fHZvaWQgMD09PUl8fG51bGw9PT0oTT1JLm1pbmYpfHx2b2lkIDA9PT1NfHxudWxsPT09KHo9TS5zdGJsKXx8dm9pZCAwPT09ej92b2lkIDA6ei5zdHNzLFYuZXh0LmN0dHM9bnVsbD09PShPPW8ubWRpYSl8fHZvaWQgMD09PU98fG51bGw9PT0oUj1PLm1pbmYpfHx2b2lkIDA9PT1SfHxudWxsPT09KEw9Ui5zdGJsKXx8dm9pZCAwPT09TD92b2lkIDA6TC5jdHRzLFYucHJlc2VudD0hMCxZJiYiZW5jYSI9PT1ZLnR5cGUpVi5pc0F1ZGlvRW5jcnlwdGlvbj0hMCxZLmRhdGFfZm9ybWF0PW51bGw9PT0oTj1ZLnNpbmYpfHx2b2lkIDA9PT1OfHxudWxsPT09KGo9Ti5mcm1hKXx8dm9pZCAwPT09aj92b2lkIDA6ai5kYXRhX2Zvcm1hdCxZLmRlZmF1bHRfS0lEPW51bGw9PT0oRz1ZLnNpbmYpfHx2b2lkIDA9PT1HfHxudWxsPT09KEg9Ry5zY2hpKXx8dm9pZCAwPT09SD92b2lkIDA6SC50ZW5jLmRlZmF1bHRfS0lELFkuZGVmYXVsdF9Jc0VuY3J5cHRlZD1udWxsPT09KEs9WS5zaW5mKXx8dm9pZCAwPT09S3x8bnVsbD09PShxPUsuc2NoaSl8fHZvaWQgMD09PXE/dm9pZCAwOnEudGVuYy5kZWZhdWx0X0lzRW5jcnlwdGVkLFkuZGVmYXVsdF9JVl9zaXplPW51bGw9PT0oVz1ZLnNpbmYpfHx2b2lkIDA9PT1XfHxudWxsPT09KFg9Vy5zY2hpKXx8dm9pZCAwPT09WD92b2lkIDA6WC50ZW5jLmRlZmF1bHRfSVZfc2l6ZSxWLmF1ZGlvU2VuYz1vLm1kaWEubWluZi5zdGJsLnNlbmMmJm8ubWRpYS5taW5mLnN0Ymwuc2VuYy5zYW1wbGVzLFYudXNlRU1FPWUudXNlRU1FLFYua2lkVmFsdWU9ZS5raWRWYWx1ZSxWLmVuY2E9WX1pZihyJiYoci5pc1ZpZGVvRW5jcnlwdGlvbj0hIXQmJnQuaXNWaWRlb0VuY3J5cHRpb24pLHQmJih0LmlzQXVkaW9FbmNyeXB0aW9uPSEhciYmci5pc0F1ZGlvRW5jcnlwdGlvbiksbnVsbCE9dCYmdC5lbmN2fHxudWxsIT1yJiZyLmVuY2Epe3ZhciBaLFEsSj1udWxsPT10fHxudWxsPT09KFo9dC5lbmN2KXx8dm9pZCAwPT09Wj92b2lkIDA6Wi5kZWZhdWx0X0tJRCwkPW51bGw9PXJ8fG51bGw9PT0oUT1yLmVuY2EpfHx2b2lkIDA9PT1RP3ZvaWQgMDpRLmRlZmF1bHRfS0lELGVlPUp8fCQ/KEp8fCQpLmpvaW4oIiIpOm51bGw7dCYmKHQua2lkPWVlKSxyJiYoci5raWQ9ZWUpfXJldHVybiB0JiYodC5mbGFncz0zODQxKSxyJiYoci5mbGFncz0xNzkzKSx7dmlkZW9UcmFjazp0LGF1ZGlvVHJhY2s6cn19fX0se2tleToiZXZhbHVhdGVEZWZhdWx0RHVyYXRpb24iLHZhbHVlOmZ1bmN0aW9uKGUsdCxyKXt2YXIgYSxuPW51bGw9PXR8fG51bGw9PT0oYT10LnNhbXBsZXMpfHx2b2lkIDA9PT1hP3ZvaWQgMDphLmxlbmd0aDtyZXR1cm4gbj8xMDI0Km4vdC50aW1lc2NhbGUqZS50aW1lc2NhbGUvcjoxMDI0fX0se2tleToibW9vZlRvU2FtcGxlcyIsdmFsdWU6ZnVuY3Rpb24odCxyLGEpe3ZhciBuPXt9O3JldHVybiB0Lm1maGQmJihyJiYoci5zZXF1ZW5jZU51bWJlcj10Lm1maGQuc2VxdWVuY2VOdW1iZXIpLGEmJihhLnNlcXVlbmNlTnVtYmVyPXQubWZoZC5zZXF1ZW5jZU51bWJlcikpLHQudHJhZi5mb3JFYWNoKChmdW5jdGlvbih0KXt2YXIgaT10LnRmaGQscz10LnRmZHQsbz10LnRydW47aWYoaSYmbyl7cyYmKHImJnIuaWQ9PT1pLnRyYWNrSWQmJihyLmJhc2VNZWRpYURlY29kZVRpbWU9cy5iYXNlTWVkaWFEZWNvZGVUaW1lKSxhJiZhLmlkPT09aS50cmFja0lkJiYoYS5iYXNlTWVkaWFEZWNvZGVUaW1lPXMuYmFzZU1lZGlhRGVjb2RlVGltZSkpO3ZhciB1PWkuZGVmYXVsdFNhbXBsZVNpemV8fDAsYz1pLmRlZmF1bHRTYW1wbGVEdXJhdGlvbnx8ZS5ldmFsdWF0ZURlZmF1bHREdXJhdGlvbihyLGEsby5zYW1wbGVzLmxlbmd0aHx8by5zYW1wbGVDb3VudCksbD1vLmRhdGFPZmZzZXR8fDAsZj0wLGQ9LTE7aWYoIW8uc2FtcGxlcy5sZW5ndGgmJm8uc2FtcGxlQ291bnQpe25baS50cmFja0lkXT1bXTtmb3IodmFyIGg9MDtoPG8uc2FtcGxlQ291bnQ7aCsrKW5baS50cmFja0lkXS5wdXNoKHtvZmZzZXQ6bCxkdHM6ZixkdXJhdGlvbjpjLHNpemU6dX0pLGYrPWMsbCs9dX1lbHNlIG5baS50cmFja0lkXT1vLnNhbXBsZXMubWFwKChmdW5jdGlvbihlLHQpe3JldHVybihlPXtvZmZzZXQ6bCxkdHM6ZixwdHM6ZisoZS5jdHN8fDApLGR1cmF0aW9uOmUuZHVyYXRpb258fGMsc2l6ZTplLnNpemV8fHUsZ29wSWQ6ZCxrZXlmcmFtZTowPT09dHx8bnVsbCE9PWUuZmxhZ3MmJnZvaWQgMCE9PWUuZmxhZ3MmJig2NTUzNiZlLmZsYWdzKT4+PjAhPTY1NTM2fSkua2V5ZnJhbWUmJihkKyssZS5nb3BJZD1kKSxmKz1lLmR1cmF0aW9uLGwrPWUuc2l6ZSxlfSkpfX0pKSxufX0se2tleToibW9vdlRvU2FtcGxlcyIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS50cmFrO2lmKHQmJnQubGVuZ3RoKXt2YXIgcj10LmZpbmQoKGZ1bmN0aW9uKGUpe3ZhciB0LHI7cmV0dXJuInZpZGUiPT09KG51bGw9PT0odD1lLm1kaWEpfHx2b2lkIDA9PT10fHxudWxsPT09KHI9dC5oZGxyKXx8dm9pZCAwPT09cj92b2lkIDA6ci5oYW5kbGVyVHlwZSl9KSksYT10LmZpbmQoKGZ1bmN0aW9uKGUpe3ZhciB0LHI7cmV0dXJuInNvdW4iPT09KG51bGw9PT0odD1lLm1kaWEpfHx2b2lkIDA9PT10fHxudWxsPT09KHI9dC5oZGxyKXx8dm9pZCAwPT09cj92b2lkIDA6ci5oYW5kbGVyVHlwZSl9KSk7aWYocnx8YSl7dmFyIG4saTtpZihyKXt2YXIgcyxvLHU9bnVsbD09PShzPXIubWRpYSl8fHZvaWQgMD09PXN8fG51bGw9PT0obz1zLm1pbmYpfHx2b2lkIDA9PT1vP3ZvaWQgMDpvLnN0Ymw7aWYoIXUpcmV0dXJuO3ZhciBjPXUuc3R0cyxsPXUuc3RzYyxmPXUuc3RzeixkPXUuc3RjbyxoPXUuc3RzcyxwPXUuY3R0cztpZighKGMmJmwmJmYmJmQmJmgpKXJldHVybjtuPURlKGMsbCxmLGQscCxoKX1pZihhKXt2YXIgdix5LG0sZz1udWxsPT09KHY9YS5tZGlhKXx8dm9pZCAwPT09dnx8bnVsbD09PSh5PXYubWluZil8fHZvaWQgMD09PXk/dm9pZCAwOnkuc3RibDtpZighZylyZXR1cm47dmFyIGs9bnVsbD09PShtPWEubWRpYS5tZGhkKXx8dm9pZCAwPT09bT92b2lkIDA6bS50aW1lc2NhbGUsYj1nLnN0dHMsXz1nLnN0c2Msdz1nLnN0c3oseD1nLnN0Y287aWYoIShrJiZiJiZfJiZ3JiZ4KSlyZXR1cm47aT1EZShiLF8sdyx4KX1yZXR1cm57dmlkZW9TYW1wbGVzOm4sYXVkaW9TYW1wbGVzOml9fX19fV0pLGV9KCk7ZnVuY3Rpb24gRGUoZSx0LHIsYSxuLGkpe3ZhciBzLG8sdSxjPVtdLGw9bnVsbD09bj92b2lkIDA6bi5lbnRyaWVzLGY9dC5lbnRyaWVzLGQ9YS5lbnRyaWVzLGg9ci5lbnRyeVNpemVzLHA9bnVsbD09aT92b2lkIDA6aS5lbnRyaWVzO3AmJihzPXt9LHAuZm9yRWFjaCgoZnVuY3Rpb24oZSl7c1tlLTFdPSEwfSkpKSxsJiYobz1bXSxsLmZvckVhY2goKGZ1bmN0aW9uKGUpe2Zvcih2YXIgdD1lLmNvdW50LHI9ZS5vZmZzZXQsYT0wO2E8dDthKyspby5wdXNoKHIpfSkpKTt2YXIgdj0tMSx5PTAsbT0wLGc9MCxrPTAsYj0wLF89ZlswXS5zYW1wbGVzUGVyQ2h1bmssdz1mWzFdP2ZbMV0uZmlyc3RDaHVuay0xOjEvMDtyZXR1cm4gZS5lbnRyaWVzLmZvckVhY2goKGZ1bmN0aW9uKGUpe2Zvcih2YXIgdD1lLmNvdW50LGE9ZS5kZWx0YSxuPTA7bjx0O24rKyl1PXtkdHM6eSxkdXJhdGlvbjphLHNpemU6aFttXXx8ci5zYW1wbGVTaXplLG9mZnNldDpkW2ddK2IsaW5kZXg6bX0scCYmKHUua2V5ZnJhbWU9c1ttXSx1LmtleWZyYW1lJiZ2KyssdS5nb3BJZD12KSxvJiZtPG8ubGVuZ3RoJiYodS5wdHM9dS5kdHMrb1ttXSksYy5wdXNoKHUpLHkrPWEsKyttPF8/Yis9dS5zaXplOihnKyssYj0wLGc+PXcmJihrKyssdz1mW2srMV0/ZltrKzFdLmZpcnN0Q2h1bmstMToxLzApLF8rPWZba10uc2FtcGxlc1BlckNodW5rKX0pKSxjfWZ1bmN0aW9uIEFlKGUsdCl7cmV0dXJuIGUuZGF0YVJlZmVyZW5jZUluZGV4PWVlKHQsNiksZS53aWR0aD1lZSh0LDI0KSxlLmhlaWdodD1lZSh0LDI2KSxlLmhvcml6cmVzb2x1dGlvbj10ZSh0LDI4KSxlLnZlcnRyZXNvbHV0aW9uPXRlKHQsMzIpLGUuZnJhbWVDb3VudD1lZSh0LDQwKSxlLmRlcHRoPWVlKHQsNzQpLDc4fWZ1bmN0aW9uIFRlKGUsdCl7cmV0dXJuIGUuZGF0YVJlZmVyZW5jZUluZGV4PWVlKHQsNiksZS5jaGFubmVsQ291bnQ9ZWUodCwxNiksZS5zYW1wbGVTaXplPWVlKHQsMTgpLGUuc2FtcGxlUmF0ZT10ZSh0LDI0KS82NTUzNiwyOH1mdW5jdGlvbiBCZShlLHQscil7aWYoZSl7aWYoZS5zaXplIT09ZS5kYXRhLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoImJveCAiLmNvbmNhdChlLnR5cGUsIiBzaXplICE9PSBkYXRhLmxlbmd0aCIpKTt2YXIgYT17c3RhcnQ6ZS5zdGFydCxzaXplOmUuc2l6ZSxoZWFkZXJTaXplOmUuaGVhZGVyU2l6ZSx0eXBlOmUudHlwZX07cmV0dXJuIHQmJihhLnZlcnNpb249ZS5kYXRhW2UuaGVhZGVyU2l6ZV0sYS5mbGFncz1mdW5jdGlvbihlKXt2YXIgdD1hcmd1bWVudHMubGVuZ3RoPjEmJnZvaWQgMCE9PWFyZ3VtZW50c1sxXT9hcmd1bWVudHNbMV06MDtyZXR1cm4oZVt0XTw8MTYpKyhlW3QrMV08PDgpKyhlW3QrMl18fDApfShlLmRhdGEsZS5oZWFkZXJTaXplKzEpLGEuaGVhZGVyU2l6ZSs9NCkscihhLGUuZGF0YS5zdWJhcnJheShhLmhlYWRlclNpemUpLGEuc3RhcnQrYS5oZWFkZXJTaXplKSxhfX12YXIgRWU9ZnVuY3Rpb24oZSx0LHIpe2Zvcih2YXIgYT1TdHJpbmcociksbj10Pj4wLGk9TWF0aC5jZWlsKG4vYS5sZW5ndGgpLHM9W10sbz1TdHJpbmcoZSk7aS0tOylzLnB1c2goYSk7cmV0dXJuIHMuam9pbigiIikuc3Vic3RyaW5nKDAsbi1vLmxlbmd0aCkrb30sVWU9ZnVuY3Rpb24oKXtmb3IodmFyIGU9W10sdD1hcmd1bWVudHMubGVuZ3RoLHI9bmV3IEFycmF5KHQpLGE9MDthPHQ7YSsrKXJbYV09YXJndW1lbnRzW2FdO3JldHVybiByLmZvckVhY2goKGZ1bmN0aW9uKHQpe2UucHVzaChFZShOdW1iZXIodCkudG9TdHJpbmcoMTYpLDIsMCkpfSkpLGVbMF19O2Z1bmN0aW9uIENlKGUpe2Zvcih2YXIgdD0wLHI9YXJndW1lbnRzLmxlbmd0aCxhPW5ldyBBcnJheShyPjE/ci0xOjApLG49MTtuPHI7bisrKWFbbi0xXT1hcmd1bWVudHNbbl07YS5mb3JFYWNoKChmdW5jdGlvbihlKXt0Kz1lLmxlbmd0aH0pKTt2YXIgaT1uZXcgZSh0KSxzPTA7cmV0dXJuIGEuZm9yRWFjaCgoZnVuY3Rpb24oZSl7aS5zZXQoZSxzKSxzKz1lLmxlbmd0aH0pKSxpfXZhciBQZT1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoKXtyKHRoaXMsZSksdGhpcy5idWZmZXI9bmV3IFVpbnQ4QXJyYXkoMCl9cmV0dXJuIG4oZSxbe2tleToid3JpdGUiLHZhbHVlOmZ1bmN0aW9uKCl7Zm9yKHZhciBlPXRoaXMsdD1hcmd1bWVudHMubGVuZ3RoLHI9bmV3IEFycmF5KHQpLGE9MDthPHQ7YSsrKXJbYV09YXJndW1lbnRzW2FdO3IuZm9yRWFjaCgoZnVuY3Rpb24odCl7dD9lLmJ1ZmZlcj1DZShVaW50OEFycmF5LGUuYnVmZmVyLHQpOndpbmRvdy5jb25zb2xlLndhcm4odCl9KSl9fV0sW3trZXk6IndyaXRlVWludDE2Iix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gbmV3IFVpbnQ4QXJyYXkoW2U+PjgmMjU1LDI1NSZlXSl9fSx7a2V5OiJ3cml0ZVVpbnQzMiIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIG5ldyBVaW50OEFycmF5KFtlPj4yNCxlPj4xNiYyNTUsZT4+OCYyNTUsMjU1JmVdKX19XSksZX0oKSxJZT1NYXRoLnBvdygyLDMyKS0xLE1lPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSgpe3IodGhpcyxlKX1yZXR1cm4gbihlLG51bGwsW3trZXk6ImJveCIsdmFsdWU6ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PWFyZ3VtZW50cy5sZW5ndGgscj1uZXcgQXJyYXkodD4xP3QtMTowKSxhPTE7YTx0O2ErKylyW2EtMV09YXJndW1lbnRzW2FdO3ZhciBuPTgrKHI9ci5maWx0ZXIoQm9vbGVhbikpLnJlZHVjZSgoZnVuY3Rpb24oZSx0KXtyZXR1cm4gZSt0LmJ5dGVMZW5ndGh9KSwwKSxpPW5ldyBVaW50OEFycmF5KG4pO2lbMF09bj4+MjQmMjU1LGlbMV09bj4+MTYmMjU1LGlbMl09bj4+OCYyNTUsaVszXT0yNTUmbixpLnNldChlLDQpO3ZhciBzPTg7cmV0dXJuIHIuZm9yRWFjaCgoZnVuY3Rpb24oZSl7aS5zZXQoZSxzKSxzKz1lLmJ5dGVMZW5ndGh9KSksaX19LHtrZXk6ImZ0eXAiLHZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiB0LmZpbmQoKGZ1bmN0aW9uKGUpe3JldHVybiBlLnR5cGU9PT1iJiZlLmNvZGVjVHlwZT09PUR9KSk/ZS5GVFlQSEVWMTplLkZUWVBBVkMxfX0se2tleToiaW5pdFNlZ21lbnQiLHZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiBKKGUuZnR5cCh0KSxlLm1vb3YodCkpfX0se2tleToicHNzaCIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIHI9bmV3IFVpbnQ4QXJyYXkoWzEsMCwwLDBdLmNvbmNhdChbMTYsMTE5LDIzOSwyMzYsMTkyLDE3OCw3NywyLDE3MiwyMjcsNjAsMzAsODIsMjI2LDI1MSw3NV0sWzAsMCwwLDFdLGllKHQua2lkKSxbMCwwLDAsMF0pKTtyZXR1cm4gZS5ib3goZS50eXBlcy5wc3NoLHIpfX0se2tleToibW9vdiIsdmFsdWU6ZnVuY3Rpb24odCl7aWYodFswXS51c2VFTUUmJih0WzBdLmVuY3Z8fHRbMF0uZW5jYSkpe3RbMF0ucHNzaHx8KHRbMF0ucHNzaD17a2lkOnRbMF0ua2lkfSk7dmFyIHI9dGhpcy5wc3NoKHRbMF0ucHNzaCk7cmV0dXJuIGUuYm94LmFwcGx5KGUsW2UudHlwZXMubW9vdixlLm12aGQodFswXS5tdmhkRHVydGlvbnx8dFswXS5kdXJhdGlvbix0WzBdLm12aGRUaW1lY2FsZXx8dFswXS50aW1lc2NhbGUpLGUubXZleCh0KV0uY29uY2F0KHkodC5tYXAoKGZ1bmN0aW9uKHQpe3JldHVybiBlLnRyYWsodCl9KSkpLFtyXSkpfXJldHVybiBlLmJveC5hcHBseShlLFtlLnR5cGVzLm1vb3YsZS5tdmhkKHRbMF0ubXZoZER1cnRpb258fHRbMF0uZHVyYXRpb24sdFswXS5tdmhkVGltZWNhbGV8fHRbMF0udGltZXNjYWxlKV0uY29uY2F0KHkodC5tYXAoKGZ1bmN0aW9uKHQpe3JldHVybiBlLnRyYWsodCl9KSkpLFtlLm12ZXgodCldKSl9fSx7a2V5OiJtdmhkIix2YWx1ZTpmdW5jdGlvbih0KXt2YXIgcj1hcmd1bWVudHMubGVuZ3RoPjEmJnZvaWQgMCE9PWFyZ3VtZW50c1sxXT9hcmd1bWVudHNbMV06OWU0LGE9ZS5ib3goZS50eXBlcy5tdmhkLG5ldyBVaW50OEFycmF5KFswLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCxyPj4yNCYyNTUscj4+MTYmMjU1LHI+PjgmMjU1LDI1NSZyLHQ+PjI0JjI1NSx0Pj4xNiYyNTUsdD4+OCYyNTUsMjU1JnQsMCwxLDAsMCwxLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDEsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMSwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsNjQsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMjU1LDI1NSwyNTUsMjU1XSkpO3JldHVybiBhfX0se2tleToidHJhayIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIGUuYm94KGUudHlwZXMudHJhayxlLnRraGQodC5pZCx0LnRraGREdXJhdGlvbnx8MCx0LndpZHRoLHQuaGVpZ2h0KSxlLm1kaWEodCkpfX0se2tleToidGtoZCIsdmFsdWU6ZnVuY3Rpb24odCxyKXt2YXIgYT1hcmd1bWVudHMubGVuZ3RoPjImJnZvaWQgMCE9PWFyZ3VtZW50c1syXT9hcmd1bWVudHNbMl06MCxuPWFyZ3VtZW50cy5sZW5ndGg+MyYmdm9pZCAwIT09YXJndW1lbnRzWzNdP2FyZ3VtZW50c1szXTowLGk9ZS5ib3goZS50eXBlcy50a2hkLG5ldyBVaW50OEFycmF5KFswLDAsMCw3LDAsMCwwLDAsMCwwLDAsMCx0Pj4yNCYyNTUsdD4+MTYmMjU1LHQ+PjgmMjU1LDI1NSZ0LDAsMCwwLDAscj4+MjQmMjU1LHI+PjE2JjI1NSxyPj44JjI1NSwyNTUmciwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwxLDAsMCwwLDAsMSwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwxLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCw2NCwwLDAsMCxhPj44JjI1NSwyNTUmYSwwLDAsbj4+OCYyNTUsMjU1Jm4sMCwwXSkpO3JldHVybiBpfX0se2tleToibWRpYSIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIGUuYm94KGUudHlwZXMubWRpYSxlLm1kaGQodC5kdXJhdGlvbix0LnRpbWVzY2FsZSksZS5oZGxyKHQudHlwZSksZS5taW5mKHQpKX19LHtrZXk6Im1kaGQiLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciByPWFyZ3VtZW50cy5sZW5ndGg+MSYmdm9pZCAwIT09YXJndW1lbnRzWzFdP2FyZ3VtZW50c1sxXTo5ZTQsYT1lLmJveChlLnR5cGVzLm1kaGQsbmV3IFVpbnQ4QXJyYXkoWzAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLHI+PjI0JjI1NSxyPj4xNiYyNTUscj4+OCYyNTUsMjU1JnIsdD4+MjQmMjU1LHQ+PjE2JjI1NSx0Pj44JjI1NSwyNTUmdCw4NSwxOTYsMCwwXSkpO3JldHVybiBhfX0se2tleToiaGRsciIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIGUuYm94KGUudHlwZXMuaGRscixlLkhETFJfVFlQRVNbdF0pfX0se2tleToibWluZiIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIGUuYm94KGUudHlwZXMubWluZix0LnR5cGU9PT1iP2UuVk1IRDplLlNNSEQsZS5ESU5GLGUuc3RibCh0KSl9fSx7a2V5OiJzdGJsIix2YWx1ZTpmdW5jdGlvbih0KXt2YXIgcj1bXTtyZXR1cm4gdCYmdC5leHQmJnQuZXh0LnN0c3MmJnIucHVzaChlLnN0c3ModC5leHQuc3Rzcy5lbnRyaWVzKSksZS5ib3goZS50eXBlcy5zdGJsLGUuc3RzZCh0KSxlLlNUVFMsclswXSxlLlNUU0MsZS5TVFNaLGUuU1RDTyl9fSx7a2V5OiJzdHNkIix2YWx1ZTpmdW5jdGlvbih0KXt2YXIgcjtyZXR1cm4gcj0iYXVkaW8iPT09dC50eXBlP3QudXNlRU1FJiZ0LmVuY2E/ZS5lbmNhKHQpOnQuY29kZWNUeXBlPT09RT9lLm9wdXModCk6ZS5tcDRhKHQpOnQudXNlRU1FJiZ0LmVuY3Y/ZS5lbmN2KHQpOnQuYXYxQz9lLmF2MDEodCk6ZS5hdmMxaGV2MSh0KSxlLmJveChlLnR5cGVzLnN0c2QsbmV3IFVpbnQ4QXJyYXkoWzAsMCwwLDAsMCwwLDAsMV0pLHIpfX0se2tleToiZW5jYSIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIHI9dC5lbmNhLmNoYW5uZWxDb3VudCxhPXQuZW5jYS5zYW1wbGVSYXRlLG49bmV3IFVpbnQ4QXJyYXkoWzAsMCwwLDAsMCwwLDAsMSwwLDAsMCwwLDAsMCwwLDAsMCxyLDAsMTYsMCwwLDAsMCxhPj44JjI1NSwyNTUmYSwwLDBdKSxpPWUuZXNkcyh0LmNvbmZpZykscz1lLnNpbmYodC5lbmNhKTtyZXR1cm4gZS5ib3goZS50eXBlcy5lbmNhLG4saSxzKX19LHtrZXk6ImVuY3YiLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciByLGEsbj10LnNwcy5sZW5ndGg+MD90LnNwc1swXTpbXSxpPXQucHBzLmxlbmd0aD4wP3QucHBzWzBdOltdLHM9dC53aWR0aCxvPXQuaGVpZ2h0LHU9dC5zYXJSYXRpb1swXSxjPXQuc2FyUmF0aW9bMV0sbD1uZXcgVWludDhBcnJheShbMCwwLDAsMCwwLDAsMCwxLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAscz4+OCYyNTUsMjU1JnMsbz4+OCYyNTUsMjU1Jm8sMCw3MiwwLDAsMCw3MiwwLDAsMCwwLDAsMCwwLDEsMTgsMTAwLDk3LDEwNSwxMDgsMTIxLDEwOSwxMTEsMTE2LDEwNSwxMTEsMTEwLDQ3LDEwNCwxMDgsMTE1LDQ2LDEwNiwxMTUsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDI0LDE3LDE3XSksZj1uZXcgVWludDhBcnJheSgocj0oYT1bMSxuWzFdLG5bMl0sblszXSwyNTUsMjI1LG4ubGVuZ3RoPj4+OCYyNTUsMjU1Jm4ubGVuZ3RoXSkuY29uY2F0LmFwcGx5KGEseShuKSkuY29uY2F0KFsxLGkubGVuZ3RoPj4+OCYyNTUsMjU1JmkubGVuZ3RoXSkpLmNvbmNhdC5hcHBseShyLHkoaSkpKSxkPW5ldyBVaW50OEFycmF5KFswLDAsODgsNTcsMCwxNSwyMDAsMTkyLDAsNCw4Niw3Ml0pLGg9ZS5zaW5mKHQuZW5jdikscD1uZXcgVWludDhBcnJheShbdT4+MjQsdT4+MTYmMjU1LHU+PjgmMjU1LDI1NSZ1LGM+PjI0LGM+PjE2JjI1NSxjPj44JjI1NSwyNTUmY10pO3JldHVybiBlLmJveChlLnR5cGVzLmVuY3YsbCxlLmJveChlLnR5cGVzLmF2Y0MsZiksZS5ib3goZS50eXBlcy5idHJ0LGQpLGgsZS5ib3goZS50eXBlcy5wYXNwLHApKX19LHtrZXk6InNjaGkiLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciByPW5ldyBVaW50OEFycmF5KFtdKSxhPWUudGVuYyh0KTtyZXR1cm4gZS5ib3goZS50eXBlcy5zY2hpLHIsYSl9fSx7a2V5OiJ0ZW5jIix2YWx1ZTpmdW5jdGlvbih0KXt2YXIgcj1uZXcgVWludDhBcnJheShbMCwwLDAsMCwwLDAsMjU1JnQuZGVmYXVsdF9Jc0VuY3J5cHRlZCwyNTUmdC5kZWZhdWx0X0lWX3NpemVdLmNvbmNhdChpZSh0LmRlZmF1bHRfS0lEKSkpO3JldHVybiBlLmJveChlLnR5cGVzLnRlbmMscil9fSx7a2V5OiJzaW5mIix2YWx1ZTpmdW5jdGlvbih0KXt2YXIgcj1uZXcgVWludDhBcnJheShbXSksYT1uZXcgVWludDhBcnJheShbdC5kYXRhX2Zvcm1hdC5jaGFyQ29kZUF0KDApLHQuZGF0YV9mb3JtYXQuY2hhckNvZGVBdCgxKSx0LmRhdGFfZm9ybWF0LmNoYXJDb2RlQXQoMiksdC5kYXRhX2Zvcm1hdC5jaGFyQ29kZUF0KDMpXSksbj1uZXcgVWludDhBcnJheShbMCwwLDAsMCw5OSwxMDEsMTEwLDk5LDAsMSwwLDBdKSxpPWUuc2NoaSh0KTtyZXR1cm4gZS5ib3goZS50eXBlcy5zaW5mLHIsZS5ib3goZS50eXBlcy5mcm1hLGEpLGUuYm94KGUudHlwZXMuc2NobSxuKSxpKX19LHtrZXk6ImF2MDEiLHZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiBlLmJveChlLnR5cGVzLmF2MDEsbmV3IFVpbnQ4QXJyYXkoWzAsMCwwLDAsMCwwLDAsMSwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLHQud2lkdGg+PjgmMjU1LDI1NSZ0LndpZHRoLHQuaGVpZ2h0Pj44JjI1NSwyNTUmdC5oZWlnaHQsMCw3MiwwLDAsMCw3MiwwLDAsMCwwLDAsMCwwLDEsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMjQsMTcsMTddKSx0LmF2MUMsdC5jb2xyKX19LHtrZXk6ImF2YzFoZXYxIix2YWx1ZTpmdW5jdGlvbih0KXt2YXIgcj10LmNvZGVjVHlwZT09PUQsYT1yP2UudHlwZXMuaHZjMTplLnR5cGVzLmF2YzEsbj1yP2UuaHZjQyh0KTplLmF2Y0ModCksaT1bbmV3IFVpbnQ4QXJyYXkoWzAsMCwwLDAsMCwwLDAsMSwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLHQud2lkdGg+PjgmMjU1LDI1NSZ0LndpZHRoLHQuaGVpZ2h0Pj44JjI1NSwyNTUmdC5oZWlnaHQsMCw3MiwwLDAsMCw3MiwwLDAsMCwwLDAsMCwwLDEsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMjQsMTcsMTddKSxuXTtyZXR1cm4gcj9pLnB1c2goZS5ib3goZS50eXBlcy5maWVsLG5ldyBVaW50OEFycmF5KFsxLDBdKSkpOnQuc2FyUmF0aW8mJnQuc2FyUmF0aW8ubGVuZ3RoPjEmJmkucHVzaChlLnBhc3AodC5zYXJSYXRpbykpLGUuYm94LmFwcGx5KGUsW2FdLmNvbmNhdChpKSl9fSx7a2V5OiJhdmNDIix2YWx1ZTpmdW5jdGlvbih0KXt2YXIgcixhLG4saT1bXSxzPVtdO3JldHVybiB0LnNwcy5mb3JFYWNoKChmdW5jdGlvbihlKXtuPWUuYnl0ZUxlbmd0aCxpLnB1c2gobj4+PjgmMjU1KSxpLnB1c2goMjU1Jm4pLGkucHVzaC5hcHBseShpLHkoZSkpfSkpLHQucHBzLmZvckVhY2goKGZ1bmN0aW9uKGUpe249ZS5ieXRlTGVuZ3RoLHMucHVzaChuPj4+OCYyNTUpLHMucHVzaCgyNTUmbikscy5wdXNoLmFwcGx5KHMseShlKSl9KSksZS5ib3goZS50eXBlcy5hdmNDLG5ldyBVaW50OEFycmF5KChyPShhPVsxLGlbM10saVs0XSxpWzVdLDI1NSwyMjR8dC5zcHMubGVuZ3RoXSkuY29uY2F0LmFwcGx5KGEsaSkuY29uY2F0KFt0LnBwcy5sZW5ndGhdKSkuY29uY2F0LmFwcGx5KHIscykpKX19LHtrZXk6Imh2Y0MiLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciByPXQuaHZjQztpZihyIGluc3RhbmNlb2YgQXJyYXlCdWZmZXJ8fHIgaW5zdGFuY2VvZiBVaW50OEFycmF5KXJldHVybiByO3ZhciBhLG49dC52cHMsaT10LnNwcyxzPXQucHBzO2lmKHIpe3ZhciBvPXIuZ2VuZXJhbFByb2ZpbGVDb21wYXRpYmlsaXR5RmxhZ3MsdT1yLmdlbmVyYWxDb25zdHJhaW50SW5kaWNhdG9yRmxhZ3MsYz0obi5sZW5ndGgmJjEpKyhpLmxlbmd0aCYmMSkrKHMubGVuZ3RoJiYxKTthPVsxLHIuZ2VuZXJhbFByb2ZpbGVTcGFjZTw8NnxyLmdlbmVyYWxUaWVyRmxhZzw8NXxyLmdlbmVyYWxQcm9maWxlSWRjLG8+Pj4yNCxvPj4+MTYsbz4+Pjgsbyx1WzBdLHVbMV0sdVsyXSx1WzNdLHVbNF0sdVs1XSxyLmdlbmVyYWxMZXZlbElkYywyNDAsMCwyNTIsMjUyfHIuY2hyb21hRm9ybWF0SWRjLDI0OHxyLmJpdERlcHRoTHVtYU1pbnVzOCwyNDh8ci5iaXREZXB0aENocm9tYU1pbnVzOCwwLDAsci5udW1UZW1wb3JhbExheWVyczw8M3xyLnRlbXBvcmFsSWROZXN0ZWQ8PDJ8MyxjXTt2YXIgbD1mdW5jdGlvbihlKXt2YXIgdDthLnB1c2goZS5sZW5ndGg+PjgsZS5sZW5ndGgpLCh0PWEpLnB1c2guYXBwbHkodCx5KGUpKX07bi5sZW5ndGgmJihhLnB1c2goMTYwLDAsbi5sZW5ndGgpLG4uZm9yRWFjaChsKSksaS5sZW5ndGgmJihhLnB1c2goMTYxLDAsaS5sZW5ndGgpLGkuZm9yRWFjaChsKSkscy5sZW5ndGgmJihhLnB1c2goMTYyLDAscy5sZW5ndGgpLHMuZm9yRWFjaChsKSl9ZWxzZSBhPVsxLDEsOTYsMCwwLDAsMTQ0LDAsMCwwLDAsMCw5MywyNDAsMCwyNTIsMjUzLDI0OCwyNDgsMCwwLDE1LDMsMTYwLDAsMSwwLDI0LDY0LDEsMTIsMSwyNTUsMjU1LDEsOTYsMCwwLDMsMCwxNDQsMCwwLDMsMCwwLDMsMCw5MywxNTMsMTUyLDksMTYxLDAsMSwwLDQ1LDY2LDEsMSwxLDk2LDAsMCwzLDAsMTQ0LDAsMCwzLDAsMCwzLDAsOTMsMTYwLDIsMTI4LDEyOCw0NSwyMiw4OSwxNTMsMTY0LDE0Nyw0MywxNTQsMTI4LDEyOCwxMjgsMTMwLDAsMCwzLDAsMiwwLDAsMywwLDUwLDE2LDE2MiwwLDEsMCw3LDY4LDEsMTkzLDExNCwxODAsOTgsNjRdO3JldHVybiBlLmJveChlLnR5cGVzLmh2Y0MsbmV3IFVpbnQ4QXJyYXkoYSkpfX0se2tleToicGFzcCIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIHI9dih0LDIpLGE9clswXSxuPXJbMV07cmV0dXJuIGUuYm94KGUudHlwZXMucGFzcCxuZXcgVWludDhBcnJheShbYT4+MjQsYT4+MTYmMjU1LGE+PjgmMjU1LDI1NSZhLG4+PjI0LG4+PjE2JjI1NSxuPj44JjI1NSwyNTUmbl0pKX19LHtrZXk6Im1wNGEiLHZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiBlLmJveChlLnR5cGVzLm1wNGEsbmV3IFVpbnQ4QXJyYXkoWzAsMCwwLDAsMCwwLDAsMSwwLDAsMCwwLDAsMCwwLDAsMCx0LmNoYW5uZWxDb3VudCwwLDE2LDAsMCwwLDAsdC5zYW1wbGVSYXRlPj44JjI1NSwyNTUmdC5zYW1wbGVSYXRlLDAsMF0pLHQuY29uZmlnLmxlbmd0aD9lLmVzZHModC5jb25maWcpOnZvaWQgMCl9fSx7a2V5OiJlc2RzIix2YWx1ZTpmdW5jdGlvbih0KXt2YXIgcj10Lmxlbmd0aDtyZXR1cm4gZS5ib3goZS50eXBlcy5lc2RzLG5ldyBVaW50OEFycmF5KFswLDAsMCwwLDMsMjMrciwwLDAsMCw0LDE1K3IsNjQsMjEsMCw2LDAsMCwwLDIxOCwxOTIsMCwwLDIxOCwxOTIsNV0uY29uY2F0KFtyXSkuY29uY2F0KHQpLmNvbmNhdChbNiwxLDJdKSkpfX0se2tleToib3B1cyIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIHI9bmV3IFVpbnQ4QXJyYXkoWzAsMCwwLDAsMCwwLDAsMSwwLDAsMCwwLDAsMCwwLDAsMCx0LmNoYW5uZWxDb3VudCwwLDE2LDAsMCwwLDAsdC5zYW1wbGVSYXRlPj44JjI1NSwyNTUmdC5zYW1wbGVSYXRlLDAsMF0pLGE9dC5jb25maWcubGVuZ3RoP2UuZE9wcyh0KTpbXTtyZXR1cm4gZS5ib3goZS50eXBlcy5PcHVzLHIsYSl9fSx7a2V5OiJkT3BzIix2YWx1ZTpmdW5jdGlvbih0KXtpZih0LmNvbmZpZylyZXR1cm4gdC5jb25maWdbNF09dC5zYW1wbGVSYXRlPj4+MjQmMjU1LHQuY29uZmlnWzVdPXQuc2FtcGxlUmF0ZT4+PjE2JjI1NSx0LmNvbmZpZ1s2XT10LnNhbXBsZVJhdGU+Pj44JjI1NSx0LmNvbmZpZ1s3XT0yNTUmdC5zYW1wbGVSYXRlLGUuYm94KGUudHlwZXMuZE9wcyx0LmNvbmZpZyl9fSx7a2V5OiJtdmV4Iix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gZS5ib3guYXBwbHkoZSxbZS50eXBlcy5tdmV4XS5jb25jYXQoeSh0Lm1hcCgoZnVuY3Rpb24odCl7cmV0dXJuIGUudHJleCh0LmlkKX0pKSkpKX19LHtrZXk6InRyZXgiLHZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiBlLmJveChlLnR5cGVzLnRyZXgsbmV3IFVpbnQ4QXJyYXkoWzAsMCwwLDAsdD4+MjQsdD4+MTYmMjU1LHQ+PjgmMjU1LDI1NSZ0LDAsMCwwLDEsMCwwLDAsMCwwLDAsMCwwLDAsMSwwLDFdKSl9fSx7a2V5OiJ0cmV4MSIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIGUuYm94KGUudHlwZXMudHJleCxuZXcgVWludDhBcnJheShbMCwwLDAsMCx0Pj4yNCx0Pj4xNiYyNTUsdD4+OCYyNTUsMjU1JnQsMCwwLDAsMSwwLDAsMiwwLDAsMCwwLDAsMCwxLDAsMF0pKX19LHtrZXk6InRyZXgyIix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gZS5ib3goZS50eXBlcy50cmV4LG5ldyBVaW50OEFycmF5KFswLDAsMCwwLHQ+PjI0LHQ+PjE2JjI1NSx0Pj44JjI1NSwyNTUmdCwwLDAsMCwxLDAsMCw0LDAsMCwwLDAsMCwyLDAsMCwwXSkpfX0se2tleToibW9vZiIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIGUuYm94LmFwcGx5KGUsW2UudHlwZXMubW9vZixlLm1maGQodFswXS5zYW1wbGVzP3RbMF0uc2FtcGxlc1swXS5nb3BJZDowKV0uY29uY2F0KHkodC5tYXAoKGZ1bmN0aW9uKHQpe3JldHVybiBlLnRyYWYodCl9KSkpKSl9fSx7a2V5OiJtZmhkIix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gZS5ib3goZS50eXBlcy5tZmhkLG5ldyBVaW50OEFycmF5KFswLDAsMCwwLHQ+PjI0LHQ+PjE2JjI1NSx0Pj44JjI1NSwyNTUmdF0pKX19LHtrZXk6InRyYWYiLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciByPWUudGZoZCh0LmlkKSxhPWUudGZkdCh0LHQuYmFzZU1lZGlhRGVjb2RlVGltZSksbj0wO2lmKHQuaXNWaWRlbyYmdC52aWRlb1NlbmMmJnQudmlkZW9TZW5jLmZvckVhY2goKGZ1bmN0aW9uKGUpe24rPTgsZS5zdWJzYW1wbGVzJiZlLnN1YnNhbXBsZXMubGVuZ3RoJiYobis9MixuKz02KmUuc3Vic2FtcGxlcy5sZW5ndGgpfSkpLHQudmlkZW9TZW5jTGVuZ3RoPW4sdC51c2VFTUUmJih0LmlzVmlkZW9FbmNyeXB0aW9ufHx0LmlzQXVkaW9FbmNyeXB0aW9uKSl7aWYodC5pc1ZpZGVvRW5jcnlwdGlvbil7aWYodC5pc1ZpZGVvKXt2YXIgaT1lLnNhaXoodCkscz1lLnNhaW8odCksbz1lLnRydW4xKHQpLHU9ZS5zZW5jKHQpO3JldHVybiBlLmJveChlLnR5cGVzLnRyYWYscixhLGkscyxvLHUpfWlmKHQuaXNBdWRpb0VuY3J5cHRpb24pe3ZhciBjPWUuc2JncCgpLGw9ZS5zYWl6KHQpLGY9ZS5zYWlvKHQpLGQ9ZS5zZW5jKHQpLGg9ZS50cnVuMSh0KTtyZXR1cm4gZS5ib3goZS50eXBlcy50cmFmLHIsYSxjLGwsZixkLGgpfXZhciBwPWUuc2JncCgpLHY9ZS50cnVuMSh0KTtyZXR1cm4gZS5ib3goZS50eXBlcy50cmFmLHIsYSxwLHYpfWlmKHQuaXNWaWRlbyl7dmFyIHk9ZS50cnVuMSh0KTtyZXR1cm4gZS5ib3goZS50eXBlcy50cmFmLHIsYSx5KX12YXIgbT1lLnNiZ3AoKSxnPWUuc2Fpeih0KSxrPWUuc2Fpbyh0KSxiPWUuc2VuYyh0KSxfPWUudHJ1bjEodCk7cmV0dXJuIGUuYm94KGUudHlwZXMudHJhZixyLGEsbSxnLGssYixfKX12YXIgdz1lLnNkdHAodCk7cmV0dXJuIGUuYm94KGUudHlwZXMudHJhZixyLGEsdyxlLnRydW4odC5zYW1wbGVzLHcuYnl0ZUxlbmd0aCs3NikpfX0se2tleToic2R0cCIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIHI9bmV3IFBlO3JldHVybiB0LnNhbXBsZXMuZm9yRWFjaCgoZnVuY3Rpb24oZSl7ci53cml0ZShuZXcgVWludDhBcnJheSh0LmlzVmlkZW8/W2Uua2V5ZnJhbWU/MzI6MTZdOlsxNl0pKX0pKSxlLmJveChlLnR5cGVzLnNkdHAsdGhpcy5leHRlbnNpb24oMCwwKSxyLmJ1ZmZlcil9fSx7a2V5OiJ0cnVuMSIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIHI9bmV3IFBlLGE9UGUud3JpdGVVaW50MzIodC5zYW1wbGVzLmxlbmd0aCksbj1udWxsO2lmKHQuaXNWaWRlbyl7dmFyIGk9dC52aWRlb1NlbmNMZW5ndGg7bj1QZS53cml0ZVVpbnQzMigxNip0LnNhbXBsZXMubGVuZ3RoK2krMTQ5KSwhdC5pc1ZpZGVvRW5jcnlwdGlvbiYmdC5pc0F1ZGlvRW5jcnlwdGlvbiYmKG49UGUud3JpdGVVaW50MzIoMTYqdC5zYW1wbGVzLmxlbmd0aCs5MikpfWVsc2V7dmFyIHM9MTIqdC5zYW1wbGVzLmxlbmd0aCsxMjQ7dC5pc0F1ZGlvRW5jcnlwdGlvbiYmKHM9MTIqdC5zYW1wbGVzLmxlbmd0aCs4KnQuYXVkaW9TZW5jLmxlbmd0aCsxNzcpLG49UGUud3JpdGVVaW50MzIocyl9cmV0dXJuIHQuc2FtcGxlcy5mb3JFYWNoKChmdW5jdGlvbihlKXtyLndyaXRlKFBlLndyaXRlVWludDMyKGUuZHVyYXRpb24pKSxyLndyaXRlKFBlLndyaXRlVWludDMyKGUuc2l6ZSkpLHIud3JpdGUoUGUud3JpdGVVaW50MzIoZS5rZXlmcmFtZT8zMzU1NDQzMjo2NTUzNikpLHQuaXNWaWRlbyYmci53cml0ZShQZS53cml0ZVVpbnQzMihlLmN0cz9lLmN0czowKSl9KSksZS5ib3goZS50eXBlcy50cnVuLHRoaXMuZXh0ZW5zaW9uKDAsdC5mbGFncyksYSxuLHIuYnVmZmVyKX19LHtrZXk6InNlbmMiLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciByPW5ldyBQZSxhPXQuc2FtcGxlcy5sZW5ndGgsbj10LmlzVmlkZW8/MTY6OCxpPXQuaXNWaWRlbz8yOjAscz1bXSxvPTA7cmV0dXJuIHQuaXNWaWRlbz8ocz10LnZpZGVvU2VuYyxvPXQudmlkZW9TZW5jTGVuZ3RoKTpzPXQuYXVkaW9TZW5jLG89b3x8biphLHIud3JpdGUoUGUud3JpdGVVaW50MzIoMTYrbyksZS50eXBlcy5zZW5jLHRoaXMuZXh0ZW5zaW9uKDAsaSkpLHIud3JpdGUoUGUud3JpdGVVaW50MzIoYSkpLHMuZm9yRWFjaCgoZnVuY3Rpb24oZSl7Zm9yKHZhciB0PTA7dDxlLkluaXRpYWxpemF0aW9uVmVjdG9yLmxlbmd0aDt0Kyspci53cml0ZShuZXcgVWludDhBcnJheShbZS5Jbml0aWFsaXphdGlvblZlY3Rvclt0XV0pKTtlLnN1YnNhbXBsZXMmJmUuc3Vic2FtcGxlcy5sZW5ndGgmJihyLndyaXRlKFBlLndyaXRlVWludDE2KGUuc3Vic2FtcGxlcy5sZW5ndGgpKSxlLnN1YnNhbXBsZXMuZm9yRWFjaCgoZnVuY3Rpb24oZSl7ci53cml0ZShQZS53cml0ZVVpbnQxNihlLkJ5dGVzT2ZDbGVhckRhdGEpKSxyLndyaXRlKFBlLndyaXRlVWludDMyKGUuQnl0ZXNPZlByb3RlY3RlZERhdGEpKX0pKSl9KSksci5idWZmZXJ9fSx7a2V5OiJzYWlvIix2YWx1ZTpmdW5jdGlvbih0KXt2YXIgcj0xMip0LnNhbXBsZXMubGVuZ3RoKzE0MTshdC5pc1ZpZGVvJiZ0LmlzQXVkaW9FbmNyeXB0aW9uJiYocj0xNDkpO3ZhciBhPW5ldyBVaW50OEFycmF5KFsxLDAsMCwwLDAsMCwwLDEsMCwwLDAsMCxyPj4yNCYyNTUscj4+MTYmMjU1LHI+PjgmMjU1LDI1NSZyXSk7cmV0dXJuIGUuYm94KGUudHlwZXMuc2FpbyxhKX19LHtrZXk6InNhaXoiLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciByPXQuc2FtcGxlcy5sZW5ndGgsYT1uZXcgVWludDhBcnJheShbMCwwLDAsMCwxNixyPj4yNCYyNTUscj4+MTYmMjU1LHI+PjgmMjU1LDI1NSZyXSk7cmV0dXJuIGUuYm94KGUudHlwZXMuc2FpeixhKX19LHtrZXk6InNiZ3AiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIHQ9bmV3IFVpbnQ4QXJyYXkoWzExNCwxMTEsMTA4LDEwOCwwLDAsMCwxLDAsMCwxLDI1LDAsMCwwLDFdKTtyZXR1cm4gZS5ib3goZS50eXBlcy5zYmdwLHRoaXMuZXh0ZW5zaW9uKDAsMCksdCl9fSx7a2V5OiJleHRlbnNpb24iLHZhbHVlOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIG5ldyBVaW50OEFycmF5KFtlLHQ+PjE2JjI1NSx0Pj44JjI1NSwyNTUmdF0pfX0se2tleToidGZoZCIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIGUuYm94KGUudHlwZXMudGZoZCxuZXcgVWludDhBcnJheShbMCwwLDAsMCx0Pj4yNCx0Pj4xNiYyNTUsdD4+OCYyNTUsMjU1JnRdKSl9fSx7a2V5OiJ0ZmR0Iix2YWx1ZTpmdW5jdGlvbih0LHIpe3ZhciBhPU1hdGguZmxvb3Ioci8oSWUrMSkpLG49TWF0aC5mbG9vcihyJShJZSsxKSk7cmV0dXJuIHQudXNlRU1FJiYodC5pc1ZpZGVvRW5jcnlwdGlvbnx8dC5pc0F1ZGlvRW5jcnlwdGlvbik/ZS5ib3goZS50eXBlcy50ZmR0LG5ldyBVaW50OEFycmF5KFswLDAsMCwwLG4+PjI0LG4+PjE2JjI1NSxuPj44JjI1NSwyNTUmbl0pKTplLmJveChlLnR5cGVzLnRmZHQsbmV3IFVpbnQ4QXJyYXkoWzEsMCwwLDAsYT4+MjQsYT4+MTYmMjU1LGE+PjgmMjU1LDI1NSZhLG4+PjI0LG4+PjE2JjI1NSxuPj44JjI1NSwyNTUmbl0pKX19LHtrZXk6InRydW4iLHZhbHVlOmZ1bmN0aW9uKHQscil7dmFyIGE9dC5sZW5ndGgsbj0xMisxNiphO3IrPTgrbjt2YXIgaT1uZXcgVWludDhBcnJheShuKTtpLnNldChbMCwwLDE1LDEsYT4+PjI0JjI1NSxhPj4+MTYmMjU1LGE+Pj44JjI1NSwyNTUmYSxyPj4+MjQmMjU1LHI+Pj4xNiYyNTUscj4+PjgmMjU1LDI1NSZyXSwwKTtmb3IodmFyIHM9MDtzPGE7cysrKXt2YXIgbz10W3NdLHU9by5kdXJhdGlvbixjPW8uc2l6ZSxsPW8uZmxhZyxmPXZvaWQgMD09PWw/e306bCxkPW8uY3RzLGg9dm9pZCAwPT09ZD8wOmQ7aS5zZXQoW3U+Pj4yNCYyNTUsdT4+PjE2JjI1NSx1Pj4+OCYyNTUsMjU1JnUsYz4+PjI0JjI1NSxjPj4+MTYmMjU1LGM+Pj44JjI1NSwyNTUmYyxmLmlzTGVhZGluZzw8MnwobnVsbD09PWYuZGVwZW5kc09ufHx2b2lkIDA9PT1mLmRlcGVuZHNPbj8xOmYuZGVwZW5kc09uKSxmLmlzRGVwZW5kZWRPbjw8NnxmLmhhc1JlZHVuZGFuY3k8PDR8Zi5wYWRkaW5nVmFsdWU8PDF8KG51bGw9PT1mLmlzTm9uU3luY1NhbXBsZXx8dm9pZCAwPT09Zi5pc05vblN5bmNTYW1wbGU/MTpmLmlzTm9uU3luY1NhbXBsZSksNjE0NDAmZi5kZWdyYWRhdGlvblByaW9yaXR5LDE1JmYuZGVncmFkYXRpb25Qcmlvcml0eSxoPj4+MjQmMjU1LGg+Pj4xNiYyNTUsaD4+PjgmMjU1LDI1NSZoXSwxMisxNipzKX1yZXR1cm4gZS5ib3goZS50eXBlcy50cnVuLGkpfX0se2tleToibW9vdk1QNCIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIGUuYm94LmFwcGx5KGUsW2UudHlwZXMubW9vdixlLm12aGQodFswXS5kdXJhdGlvbix0WzBdLnRpbWVzY2FsZSldLmNvbmNhdCh5KHQubWFwKChmdW5jdGlvbih0KXtyZXR1cm4gZS50cmFja01QNCh0KX0pKSkpKX19LHtrZXk6InRyYWNrTVA0Iix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gZS5ib3goZS50eXBlcy50cmFrLGUudGtoZCh0LmlkLHQuZHVyYXRpb24sdC53aWR0aCx0LmhlaWdodCksZS5tZGlhTVA0KHQpKX19LHtrZXk6Im1kaWFNUDQiLHZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiBlLmJveChlLnR5cGVzLm1kaWEsZS5tZGhkKHQuZHVyYXRpb24sdC50aW1lc2NhbGUpLGUuaGRscih0LnR5cGUpLGUubWluZk1QNCh0KSl9fSx7a2V5OiJtaW5mTVA0Iix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gZS5ib3goZS50eXBlcy5taW5mLHQudHlwZT09PWI/ZS5WTUhEOmUuU01IRCxlLkRJTkYsZS5zdGJsTVA0KHQpKX19LHtrZXk6InN0YmxNUDQiLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciByPXQuZXh0LGE9W2Uuc3RzZCh0KSxlLnN0dHMoci5zdHRzKSxlLnN0c2Moci5zdHNjKSxlLnN0c3ooci5zdHN6KSxlLnN0Y28oci5zdGNvKV07cmV0dXJuIHIuc3Rzcy5sZW5ndGgmJmEucHVzaChlLnN0c3Moci5zdHNzKSksci5jdHRzLmxlbmd0aCYmYS5wdXNoKGUuY3R0cyhyLmN0dHMpKSxlLmJveC5hcHBseShlLFtlLnR5cGVzLnN0YmxdLmNvbmNhdChhKSl9fSx7a2V5OiJzdHRzIix2YWx1ZTpmdW5jdGlvbih0KXt2YXIgcj10Lmxlbmd0aCxhPW5ldyBVaW50OEFycmF5KDgqciksbj0wO3JldHVybiB0LmZvckVhY2goKGZ1bmN0aW9uKGUpe3ZhciB0PWUudmFsdWUscj1lLmNvdW50O2Euc2V0KFtyPj4yNCxyPj4xNiYyNTUscj4+OCYyNTUsMjU1JnIsdD4+MjQsdD4+MTYmMjU1LHQ+PjgmMjU1LDI1NSZ0XSxuKSxuKz04fSkpLGUuYm94KGUudHlwZXMuc3R0cyxKKG5ldyBVaW50OEFycmF5KFswLDAsMCwwLHI+PjI0LHI+PjE2JjI1NSxyPj44JjI1NSwyNTUmcl0pLGEpKX19LHtrZXk6InN0c2MiLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciByPXQubGVuZ3RoLGE9bmV3IFVpbnQ4QXJyYXkoMTIqciksbj0wO3JldHVybiB0LmZvckVhY2goKGZ1bmN0aW9uKGUpe3ZhciB0PWUuZmlyc3RDaHVuayxyPWUuc2FtcGxlc1BlckNodW5rLGk9ZS5zYW1wbGVEZXNjSW5kZXg7YS5zZXQoW3Q+PjI0LHQ+PjE2JjI1NSx0Pj44JjI1NSwyNTUmdCxyPj4yNCxyPj4xNiYyNTUscj4+OCYyNTUsMjU1JnIsaT4+MjQsaT4+MTYmMjU1LGk+PjgmMjU1LDI1NSZpXSxuKSxuKz0xMn0pKSxlLmJveChlLnR5cGVzLnN0c2MsSihuZXcgVWludDhBcnJheShbMCwwLDAsMCxyPj4yNCxyPj4xNiYyNTUscj4+OCYyNTUsMjU1JnJdKSxhKSl9fSx7a2V5OiJzdHN6Iix2YWx1ZTpmdW5jdGlvbih0KXt2YXIgcj10Lmxlbmd0aCxhPW5ldyBVaW50OEFycmF5KDQqciksbj0wO3JldHVybiB0LmZvckVhY2goKGZ1bmN0aW9uKGUpe2Euc2V0KFtlPj4yNCxlPj4xNiYyNTUsZT4+OCYyNTUsMjU1JmVdLG4pLG4rPTR9KSksZS5ib3goZS50eXBlcy5zdHN6LEoobmV3IFVpbnQ4QXJyYXkoWzAsMCwwLDAsMCwwLDAsMCxyPj4yNCxyPj4xNiYyNTUscj4+OCYyNTUsMjU1JnJdKSxhKSl9fSx7a2V5OiJzdGNvIix2YWx1ZTpmdW5jdGlvbih0KXt2YXIgcj10Lmxlbmd0aCxhPW5ldyBVaW50OEFycmF5KDQqciksbj0wO3JldHVybiB0LmZvckVhY2goKGZ1bmN0aW9uKGUpe2Euc2V0KFtlPj4yNCxlPj4xNiYyNTUsZT4+OCYyNTUsMjU1JmVdLG4pLG4rPTR9KSksZS5ib3goZS50eXBlcy5zdGNvLEoobmV3IFVpbnQ4QXJyYXkoWzAsMCwwLDAscj4+MjQscj4+MTYmMjU1LHI+PjgmMjU1LDI1NSZyXSksYSkpfX0se2tleToic3RzcyIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIHI9dC5sZW5ndGgsYT1uZXcgVWludDhBcnJheSg0KnIpLG49MDtyZXR1cm4gdC5mb3JFYWNoKChmdW5jdGlvbihlKXthLnNldChbZT4+MjQsZT4+MTYmMjU1LGU+PjgmMjU1LDI1NSZlXSxuKSxuKz00fSkpLGUuYm94KGUudHlwZXMuc3RzcyxKKG5ldyBVaW50OEFycmF5KFswLDAsMCwwLHI+PjI0LHI+PjE2JjI1NSxyPj44JjI1NSwyNTUmcl0pLGEpKX19LHtrZXk6ImN0dHMiLHZhbHVlOmZ1bmN0aW9uKHQpe3ZhciByPXQubGVuZ3RoLGE9bmV3IFVpbnQ4QXJyYXkoOCpyKSxuPTA7cmV0dXJuIHQuZm9yRWFjaCgoZnVuY3Rpb24oZSl7dmFyIHQ9ZS52YWx1ZSxyPWUuY291bnQ7YS5zZXQoW3I+PjI0LHI+PjE2JjI1NSxyPj44JjI1NSwyNTUmcix0Pj4yNCx0Pj4xNiYyNTUsdD4+OCYyNTUsMjU1JnRdLG4pLG4rPTh9KSksZS5ib3goZS50eXBlcy5jdHRzLEoobmV3IFVpbnQ4QXJyYXkoWzAsMCwwLDAscj4+MjQscj4+MTYmMjU1LHI+PjgmMjU1LDI1NSZyXSksYSkpfX0se2tleToic3R5cCIsdmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gZS5ib3goZS50eXBlcy5zdHlwLG5ldyBVaW50OEFycmF5KFsxMDksMTE1LDEwMCwxMDQsMCwwLDAsMCwxMDksMTE1LDEwMCwxMDQsMTA5LDExNSwxMDUsMTIwXSkpfX0se2tleToic2lkeCIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIHI9dC50aW1lc2NhbGUsYT10LnNhbXBsZXNbMF0uZHVyYXRpb24sbj1hKnQuc2FtcGxlcy5sZW5ndGgsaT10LnNhbXBsZXNbMF0uc2FtcGxlT2Zmc2V0KmEscz04O3Quc2FtcGxlcy5mb3JFYWNoKChmdW5jdGlvbihlKXtzKz1lLnNpemV9KSk7dmFyIG89MDtpZih0LmlzVmlkZW8pe3ZhciB1LGM9MDt0LnZpZGVvU2VuYyYmKHU9dC52aWRlb1NlbmMpLHQuaXNWaWRlbyYmdS5mb3JFYWNoKChmdW5jdGlvbihlKXtjKz04LGUuc3Vic2FtcGxlcyYmZS5zdWJzYW1wbGVzLmxlbmd0aCYmKGMrPTIsYys9NiplLnN1YnNhbXBsZXMubGVuZ3RoKX0pKSx0LnZpZGVvU2VuY0xlbmd0aD1jLG89cysxNDErMTYqdC5zYW1wbGVzLmxlbmd0aCtjLHQudXNlRU1FJiZ0LmlzQXVkaW9FbmNyeXB0aW9uJiYhdC5pc1ZpZGVvRW5jcnlwdGlvbiYmKG89cysxNip0LnNhbXBsZXMubGVuZ3RoKzg0KX1lbHNlIG89cysxMTYrMTIqdC5zYW1wbGVzLmxlbmd0aCx0LnVzZUVNRSYmdC5pc0F1ZGlvRW5jcnlwdGlvbiYmKG89cysxNjkrMTIqdC5zYW1wbGVzLmxlbmd0aCs4KnQuYXVkaW9TZW5jLmxlbmd0aCk7dmFyIGw9bmV3IFVpbnQ4QXJyYXkoWzAsMCwwLDAsMCwwLDAsMjU1JnQuaWQscj4+MjQmMjU1LHI+PjE2JjI1NSxyPj44JjI1NSwyNTUmcixpPj4yNCYyNTUsaT4+MTYmMjU1LGk+PjgmMjU1LDI1NSZpLDAsMCwwLDAsMCwwLDAsMSwwLG8+PjE2JjI1NSxvPj44JjI1NSwyNTUmbyxuPj4yNCYyNTUsbj4+MTYmMjU1LG4+PjgmMjU1LDI1NSZuLDE0NCwwLDAsMF0pO3JldHVybiBlLmJveChlLnR5cGVzLnNpZHgsbCl9fSx7a2V5OiJtZGF0Iix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gZS5ib3goZS50eXBlcy5tZGF0LHQpfX1dKSxlfSgpO2koTWUsInR5cGVzIixbIk9wdXMiLCJkT3BzIiwiYXYwMSIsImF2MUMiLCJhdmMxIiwiYXZjQyIsImh2YzEiLCJodmNDIiwiZGluZiIsImRyZWYiLCJlc2RzIiwiZnR5cCIsImhkbHIiLCJtZGF0IiwibWRoZCIsIm1kaWEiLCJtZmhkIiwibWluZiIsIm1vb2YiLCJtb292IiwibXA0YSIsIm12ZXgiLCJtdmhkIiwicGFzcCIsInN0YmwiLCJzdGNvIiwic3RzYyIsInN0c2QiLCJzdHN6Iiwic3R0cyIsInRmZHQiLCJ0ZmhkIiwidHJhZiIsInRyYWsiLCJ0cmV4IiwidGtoZCIsInZtaGQiLCJzbWhkIiwiY3R0cyIsInN0c3MiLCJzdHlwIiwicHNzaCIsInNpZHgiLCJzYmdwIiwic2FpeiIsInNhaW8iLCJzZW5jIiwidHJ1biIsImVuY3YiLCJlbmNhIiwic2luZiIsImJ0cnQiLCJmcm1hIiwidGVuYyIsInNjaG0iLCJzY2hpIiwibWVoZCIsImZpZWwiLCJzZHRwIl0ucmVkdWNlKChmdW5jdGlvbihlLHQpe3JldHVybiBlW3RdPVt0LmNoYXJDb2RlQXQoMCksdC5jaGFyQ29kZUF0KDEpLHQuY2hhckNvZGVBdCgyKSx0LmNoYXJDb2RlQXQoMyldLGV9KSxPYmplY3QuY3JlYXRlKG51bGwpKSksaShNZSwiSERMUl9UWVBFUyIse3ZpZGVvOm5ldyBVaW50OEFycmF5KFswLDAsMCwwLDAsMCwwLDAsMTE4LDEwNSwxMDAsMTAxLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDg2LDEwNSwxMDAsMTAxLDExMSw3Miw5NywxMTAsMTAwLDEwOCwxMDEsMTE0LDBdKSxhdWRpbzpuZXcgVWludDhBcnJheShbMCwwLDAsMCwwLDAsMCwwLDExNSwxMTEsMTE3LDExMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCw4MywxMTEsMTE3LDExMCwxMDAsNzIsOTcsMTEwLDEwMCwxMDgsMTAxLDExNCwwXSl9KSxpKE1lLCJGVFlQQVZDMSIsTWUuYm94KE1lLnR5cGVzLmZ0eXAsbmV3IFVpbnQ4QXJyYXkoWzEwNSwxMTUsMTExLDEwOSwwLDAsMCwxLDEwNSwxMTUsMTExLDEwOSw5NywxMTgsOTksNDldKSkpLGkoTWUsIkZUWVBIRVYxIixNZS5ib3goTWUudHlwZXMuZnR5cCxuZXcgVWludDhBcnJheShbMTA1LDExNSwxMTEsMTA5LDAsMCwwLDEsMTA1LDExNSwxMTEsMTA5LDEwNCwxMDEsMTE4LDQ5XSkpKSxpKE1lLCJESU5GIixNZS5ib3goTWUudHlwZXMuZGluZixNZS5ib3goTWUudHlwZXMuZHJlZixuZXcgVWludDhBcnJheShbMCwwLDAsMCwwLDAsMCwxLDAsMCwwLDEyLDExNywxMTQsMTA4LDMyLDAsMCwwLDFdKSkpKSxpKE1lLCJWTUhEIixNZS5ib3goTWUudHlwZXMudm1oZCxuZXcgVWludDhBcnJheShbMCwwLDAsMSwwLDAsMCwwLDAsMCwwLDBdKSkpLGkoTWUsIlNNSEQiLE1lLmJveChNZS50eXBlcy5zbWhkLG5ldyBVaW50OEFycmF5KFswLDAsMCwwLDAsMCwwLDBdKSkpLGkoTWUsIlN0YmxUYWJsZSIsbmV3IFVpbnQ4QXJyYXkoWzAsMCwwLDAsMCwwLDAsMF0pKSxpKE1lLCJTVFRTIixNZS5ib3goTWUudHlwZXMuc3R0cyxNZS5TdGJsVGFibGUpKSxpKE1lLCJTVFNDIixNZS5ib3goTWUudHlwZXMuc3RzYyxNZS5TdGJsVGFibGUpKSxpKE1lLCJTVFNaIixNZS5ib3goTWUudHlwZXMuc3RzeixuZXcgVWludDhBcnJheShbMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDBdKSkpLGkoTWUsIlNUQ08iLE1lLmJveChNZS50eXBlcy5zdGNvLE1lLlN0YmxUYWJsZSkpO3ZhciB6ZT1mdW5jdGlvbigpe2Z1bmN0aW9uIGUodCxhKXtyKHRoaXMsZSksdGhpcy5uYW1lPXR8fCIiLHRoaXMuX3ByZWZpeD0iWyIuY29uY2F0KHRoaXMubmFtZSwiXSIpLGUuZGlzYWJsZWQ9YX1yZXR1cm4gbihlLFt7a2V5OiJkZWJ1ZyIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgdDtpZighZS5kaXNhYmxlZCl7Zm9yKHZhciByPWFyZ3VtZW50cy5sZW5ndGgsYT1uZXcgQXJyYXkociksbj0wO248cjtuKyspYVtuXT1hcmd1bWVudHNbbl07KHQ9Y29uc29sZSkuZGVidWcuYXBwbHkodCxbdGhpcy5fcHJlZml4XS5jb25jYXQoYSkpfX19LHtrZXk6ImxvZyIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgdDtpZighZS5kaXNhYmxlZCl7Zm9yKHZhciByPWFyZ3VtZW50cy5sZW5ndGgsYT1uZXcgQXJyYXkociksbj0wO248cjtuKyspYVtuXT1hcmd1bWVudHNbbl07KHQ9Y29uc29sZSkubG9nLmFwcGx5KHQsW3RoaXMuX3ByZWZpeF0uY29uY2F0KGEpKX19fSx7a2V5OiJ3YXJuIix2YWx1ZTpmdW5jdGlvbigpe3ZhciB0O2lmKCFlLmRpc2FibGVkKXtmb3IodmFyIHI9YXJndW1lbnRzLmxlbmd0aCxhPW5ldyBBcnJheShyKSxuPTA7bjxyO24rKylhW25dPWFyZ3VtZW50c1tuXTsodD1jb25zb2xlKS53YXJuLmFwcGx5KHQsW3RoaXMuX3ByZWZpeF0uY29uY2F0KGEpKX19fSx7a2V5OiJlcnJvciIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgdDtpZighZS5kaXNhYmxlZCl7Zm9yKHZhciByPWFyZ3VtZW50cy5sZW5ndGgsYT1uZXcgQXJyYXkociksbj0wO248cjtuKyspYVtuXT1hcmd1bWVudHNbbl07KHQ9Y29uc29sZSkuZXJyb3IuYXBwbHkodCxbdGhpcy5fcHJlZml4XS5jb25jYXQoYSkpfX19LHtrZXk6InRhYmxlIix2YWx1ZTpmdW5jdGlvbigpe3ZhciB0O2UuZGlzYWJsZWR8fChjb25zb2xlLmdyb3VwKHRoaXMuX3ByZWZpeCksKHQ9Y29uc29sZSkudGFibGUuYXBwbHkodCxhcmd1bWVudHMpLGNvbnNvbGUuZ3JvdXBFbmQoKSl9fV0sW3trZXk6ImVuYWJsZSIsdmFsdWU6ZnVuY3Rpb24oKXtlLmRpc2FibGVkPSExfX0se2tleToiZGlzYWJsZSIsdmFsdWU6ZnVuY3Rpb24oKXtlLmRpc2FibGVkPSEwfX1dKSxlfSgpO2koemUsImRpc2FibGVkIiwhMCk7Zm9yKHZhciBPZT1mdW5jdGlvbigpe2Z1bmN0aW9uIGUodCxhLG4pe3IodGhpcyxlKSx0aGlzLnZpZGVvVHJhY2s9dCx0aGlzLmF1ZGlvVHJhY2s9YTt2YXIgaT0vQ2hyb21lXC8oW14uXSspLy5leGVjKG5hdmlnYXRvci51c2VyQWdlbnQpO3RoaXMuZm9yY2VGaXJzdElEUj1pJiZOdW1iZXIoaVsxXSk8NTAsdGhpcy5sb2c9bmV3IHplKCJGTVA0UmVtdXhlciIsIW58fCFuLm9wZW5Mb2d8fCFuLm9wZW5Mb2cpfXJldHVybiBuKGUsW3trZXk6InJlbXV4Iix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlLHQscixhLG4saT1hcmd1bWVudHMubGVuZ3RoPjAmJnZvaWQgMCE9PWFyZ3VtZW50c1swXSYmYXJndW1lbnRzWzBdLHM9YXJndW1lbnRzLmxlbmd0aD4xJiZ2b2lkIDAhPT1hcmd1bWVudHNbMV0/YXJndW1lbnRzWzFdOnt9LG89dGhpcy52aWRlb1RyYWNrLHU9dGhpcy5hdWRpb1RyYWNrLGM9by5leGlzdCgpLGw9dS5leGlzdCgpLGY9W107cmV0dXJuIGkmJihzJiZzLmluaXRNZXJnZT8oYyYmZi5wdXNoKHRoaXMudmlkZW9UcmFjayksbCYmZi5wdXNoKHRoaXMuYXVkaW9UcmFjaykscj1NZS5pbml0U2VnbWVudChmKSk6KGMmJihlPU1lLmluaXRTZWdtZW50KFt0aGlzLnZpZGVvVHJhY2tdKSksbCYmKHQ9TWUuaW5pdFNlZ21lbnQoW3RoaXMuYXVkaW9UcmFja10pKSkpLGMmJm8uaGFzU2FtcGxlKCkmJihhPXRoaXMuX3JlbXV4VmlkZW8oKSksbCYmdS5oYXNTYW1wbGUoKSYmKG49dGhpcy5fcmVtdXhBdWRpbygpKSxvLnNhbXBsZXM9W10sdS5zYW1wbGVzPVtdLHtpbml0U2VnbWVudDpyLHZpZGVvSW5pdFNlZ21lbnQ6ZSxhdWRpb0luaXRTZWdtZW50OnQsdmlkZW9TZWdtZW50OmEsYXVkaW9TZWdtZW50Om59fX0se2tleToiX3JlbXV4VmlkZW8iLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy52aWRlb1RyYWNrO3RoaXMuZm9yY2VGaXJzdElEUiYmKGUuc2FtcGxlc1swXS5mbGFnPXtkZXBlbmRzT246Mixpc05vblN5bmNTYW1wbGU6MH0pO3ZhciB0PWUuc2FtcGxlcyxyPS9hdjAxLy50ZXN0KGUuY29kZWMpLGE9MDtyP3QuZm9yRWFjaCgoZnVuY3Rpb24oZSl7YSs9ZS5kYXRhLmJ5dGVMZW5ndGh9KSk6dC5mb3JFYWNoKChmdW5jdGlvbihlKXthKz1lLnVuaXRzLnJlZHVjZSgoZnVuY3Rpb24oZSx0KXtyZXR1cm4gZSt0LmJ5dGVMZW5ndGh9KSwwKSxhKz00KmUudW5pdHMubGVuZ3RofSkpO3ZhciBuPW5ldyBVaW50OEFycmF5KGEpO2lmKHIpZm9yKHZhciBpLHM9MCxvPXQubGVuZ3RoLHU9MDtzPG87cysrKWk9dFtzXSxuLnNldChpLmRhdGEsdSksaS5zaXplPWkuZGF0YS5ieXRlTGVuZ3RoLHUrPWkuc2l6ZTtlbHNlIGZvcih2YXIgYyxsPW5ldyBEYXRhVmlldyhuLmJ1ZmZlciksZj1mdW5jdGlvbihlLHIpe3I9dFtkXTt2YXIgYT0wO3IudW5pdHMuZm9yRWFjaCgoZnVuY3Rpb24odCl7bC5zZXRVaW50MzIoZSx0LmJ5dGVMZW5ndGgpLGUrPTQsbi5zZXQodCxlKSxlKz10LmJ5dGVMZW5ndGgsYSs9NCt0LmJ5dGVMZW5ndGh9KSksci5zaXplPWEscD1lLGM9cn0sZD0wLGg9dC5sZW5ndGgscD0wO2Q8aDtkKyspZihwLGMpO3ZhciB2PU1lLm1kYXQobik7cmV0dXJuIEooTWUubW9vZihbZV0pLHYpfX0se2tleToiX3JlbXV4QXVkaW8iLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5hdWRpb1RyYWNrLHQ9bmV3IFVpbnQ4QXJyYXkoZS5zYW1wbGVzLnJlZHVjZSgoZnVuY3Rpb24oZSx0KXtyZXR1cm4gZSt0LnNpemV9KSwwKSk7ZS5zYW1wbGVzLnJlZHVjZSgoZnVuY3Rpb24oZSxyKXtyZXR1cm4gdC5zZXQoci5kYXRhLGUpLGUrci5zaXplfSksMCk7dmFyIHI9TWUubWRhdCh0KTtyZXR1cm4gSihNZS5tb29mKFtlXSkscil9fSx7a2V5OiJyZXNldCIsdmFsdWU6ZnVuY3Rpb24oKXt0aGlzLnZpZGVvVHJhY2sucmVzZXQoKSx0aGlzLmF1ZGlvVHJhY2sucmVzZXQoKX19XSksZX0oKSxSZT1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoKXtyKHRoaXMsZSl9cmV0dXJuIG4oZSxbe2tleToibWl4SW4iLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiBPYmplY3QuYXNzaWduKHRoaXMsZSl9fSx7a2V5OiJjbG9uZSIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT1uZXcgdGhpcy5jb25zdHJ1Y3RvcjtyZXR1cm4gT2JqZWN0LmFzc2lnbihlLHRoaXMpLGV9fV0sW3trZXk6ImNyZWF0ZSIsdmFsdWU6ZnVuY3Rpb24oKXtmb3IodmFyIGU9YXJndW1lbnRzLmxlbmd0aCx0PW5ldyBBcnJheShlKSxyPTA7cjxlO3IrKyl0W3JdPWFyZ3VtZW50c1tyXTtyZXR1cm4gbCh0aGlzLHQpfX1dKSxlfSgpLExlPWZ1bmN0aW9uKGUpe3MoYSxlKTt2YXIgdD1kKGEpO2Z1bmN0aW9uIGEoKXt2YXIgZSxuPWFyZ3VtZW50cy5sZW5ndGg+MCYmdm9pZCAwIT09YXJndW1lbnRzWzBdP2FyZ3VtZW50c1swXTpbXSxpPWFyZ3VtZW50cy5sZW5ndGg+MSYmdm9pZCAwIT09YXJndW1lbnRzWzFdP2FyZ3VtZW50c1sxXTo0Km4ubGVuZ3RoO3IodGhpcyxhKSxlPXQuY2FsbCh0aGlzKTt2YXIgcz1uO2lmKHMgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlciYmKHM9bmV3IFVpbnQ4QXJyYXkocykpLChzIGluc3RhbmNlb2YgSW50OEFycmF5fHxzIGluc3RhbmNlb2YgVWludDhDbGFtcGVkQXJyYXl8fHMgaW5zdGFuY2VvZiBJbnQxNkFycmF5fHxzIGluc3RhbmNlb2YgVWludDE2QXJyYXl8fHMgaW5zdGFuY2VvZiBJbnQzMkFycmF5fHxzIGluc3RhbmNlb2YgVWludDMyQXJyYXl8fHMgaW5zdGFuY2VvZiBGbG9hdDMyQXJyYXl8fHMgaW5zdGFuY2VvZiBGbG9hdDY0QXJyYXkpJiYocz1uZXcgVWludDhBcnJheShzLmJ1ZmZlcixzLmJ5dGVPZmZzZXQscy5ieXRlTGVuZ3RoKSkscyBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpe2Zvcih2YXIgbz1zLmJ5dGVMZW5ndGgsdT1bXSxjPTA7YzxvO2MrPTEpdVtjPj4+Ml18PXNbY108PDI0LWMlNCo4O2Uud29yZHM9dSxlLnNpZ0J5dGVzPW99ZWxzZSBlLndvcmRzPW4sZS5zaWdCeXRlcz1pO3JldHVybiBlfXJldHVybiBuKGEsW3trZXk6InRvU3RyaW5nIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPWFyZ3VtZW50cy5sZW5ndGg+MCYmdm9pZCAwIT09YXJndW1lbnRzWzBdP2FyZ3VtZW50c1swXTpWZTtyZXR1cm4gZS5zdHJpbmdpZnkodGhpcyl9fSx7a2V5OiJjb25jYXQiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMud29yZHMscj1lLndvcmRzLGE9dGhpcy5zaWdCeXRlcyxuPWUuc2lnQnl0ZXM7aWYodGhpcy5jbGFtcCgpLGElNClmb3IodmFyIGk9MDtpPG47aSs9MSl7dmFyIHM9cltpPj4+Ml0+Pj4yNC1pJTQqOCYyNTU7dFthK2k+Pj4yXXw9czw8MjQtKGEraSklNCo4fWVsc2UgZm9yKHZhciBvPTA7bzxuO28rPTQpdFthK28+Pj4yXT1yW28+Pj4yXTtyZXR1cm4gdGhpcy5zaWdCeXRlcys9bix0aGlzfX0se2tleToiY2xhbXAiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy53b3Jkcyx0PXRoaXMuc2lnQnl0ZXM7ZVt0Pj4+Ml0mPTQyOTQ5NjcyOTU8PDMyLXQlNCo4LGUubGVuZ3RoPU1hdGguY2VpbCh0LzQpfX0se2tleToiY2xvbmUiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9cChvKGEucHJvdG90eXBlKSwiY2xvbmUiLHRoaXMpLmNhbGwodGhpcyk7cmV0dXJuIGUud29yZHM9dGhpcy53b3Jkcy5zbGljZSgwKSxlfX1dLFt7a2V5OiJyYW5kb20iLHZhbHVlOmZ1bmN0aW9uKGUpe2Zvcih2YXIgdCxyPVtdLG49ZnVuY3Rpb24oZSl7dmFyIHQ9ZSxyPTk4NzY1NDMyMSxhPTQyOTQ5NjcyOTU7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGU9KChyPTM2OTY5Kig2NTUzNSZyKSsocj4+MTYpJmEpPDwxNikrKHQ9MThlMyooNjU1MzUmdCkrKHQ+PjE2KSZhKSZhO3JldHVybiBlLz00Mjk0OTY3Mjk2LChlKz0uNSkqKE1hdGgucmFuZG9tKCk+LjU/MTotMSl9fSxpPTA7aTxlO2krPTQpe3ZhciBzPW4oNDI5NDk2NzI5NioodHx8TWF0aC5yYW5kb20oKSkpO3Q9OTg3NjU0MDcxKnMoKSxyLnB1c2goNDI5NDk2NzI5NipzKCl8MCl9cmV0dXJuIG5ldyBhKHIsZSl9fV0pLGF9KFJlKSxWZT17c3RyaW5naWZ5OmZ1bmN0aW9uKGUpe2Zvcih2YXIgdD1lLndvcmRzLHI9ZS5zaWdCeXRlcyxhPVtdLG49MDtuPHI7bis9MSl7dmFyIGk9dFtuPj4+Ml0+Pj4yNC1uJTQqOCYyNTU7YS5wdXNoKChpPj4+NCkudG9TdHJpbmcoMTYpKSxhLnB1c2goKDE1JmkpLnRvU3RyaW5nKDE2KSl9cmV0dXJuIGEuam9pbigiIil9LHBhcnNlOmZ1bmN0aW9uKGUpe2Zvcih2YXIgdD1lLmxlbmd0aCxyPVtdLGE9MDthPHQ7YSs9MilyW2E+Pj4zXXw9cGFyc2VJbnQoZS5zdWJzdHIoYSwyKSwxNik8PDI0LWElOCo0O3JldHVybiBuZXcgTGUocix0LzIpfX0sRmU9ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PWUubGVuZ3RoLHI9W10sYT0wO2E8dDthKz0xKXJbYT4+PjJdfD0oMjU1JmUuY2hhckNvZGVBdChhKSk8PDI0LWElNCo4O3JldHVybiBuZXcgTGUocix0KX0sTmU9ZnVuY3Rpb24oZSl7cmV0dXJuIEZlKHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChlKSkpfSxqZT1mdW5jdGlvbihlKXtzKGEsZSk7dmFyIHQ9ZChhKTtmdW5jdGlvbiBhKCl7dmFyIGU7cmV0dXJuIHIodGhpcyxhKSwoZT10LmNhbGwodGhpcykpLl9taW5CdWZmZXJTaXplPTAsZX1yZXR1cm4gbihhLFt7a2V5OiJyZXNldCIsdmFsdWU6ZnVuY3Rpb24oKXt0aGlzLl9kYXRhPW5ldyBMZSx0aGlzLl9uRGF0YUJ5dGVzPTB9fSx7a2V5OiJfYXBwZW5kIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD1lOyJzdHJpbmciPT10eXBlb2YgdCYmKHQ9TmUodCkpLHRoaXMuX2RhdGEuY29uY2F0KHQpLHRoaXMuX25EYXRhQnl0ZXMrPXQuc2lnQnl0ZXN9fSx7a2V5OiJfcHJvY2VzcyIsdmFsdWU6ZnVuY3Rpb24oZSl7dmFyIHQscj10aGlzLl9kYXRhLGE9dGhpcy5ibG9ja1NpemUsbj1yLndvcmRzLGk9ci5zaWdCeXRlcyxzPWkvKDQqYSksbz0ocz1lP01hdGguY2VpbChzKTpNYXRoLm1heCgoMHxzKS10aGlzLl9taW5CdWZmZXJTaXplLDApKSphLHU9TWF0aC5taW4oNCpvLGkpO2lmKG8pe2Zvcih2YXIgYz0wO2M8bztjKz1hKXRoaXMuX2RvUHJvY2Vzc0Jsb2NrKG4sYyk7dD1uLnNwbGljZSgwLG8pLHIuc2lnQnl0ZXMtPXV9cmV0dXJuIG5ldyBMZSh0LHUpfX0se2tleToiY2xvbmUiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9cChvKGEucHJvdG90eXBlKSwiY2xvbmUiLHRoaXMpLmNhbGwodGhpcyk7cmV0dXJuIGUuX2RhdGE9dGhpcy5fZGF0YS5jbG9uZSgpLGV9fV0pLGF9KFJlKSxHZT1mdW5jdGlvbihlKXtzKGEsZSk7dmFyIHQ9ZChhKTtmdW5jdGlvbiBhKGUpe3ZhciBuO3JldHVybiByKHRoaXMsYSksKG49dC5jYWxsKHRoaXMpKS5ibG9ja1NpemU9MTYsbi5jZmc9T2JqZWN0LmFzc2lnbihuZXcgUmUsZSksbi5yZXNldCgpLG59cmV0dXJuIG4oYSxbe2tleToicmVzZXQiLHZhbHVlOmZ1bmN0aW9uKCl7cChvKGEucHJvdG90eXBlKSwicmVzZXQiLHRoaXMpLmNhbGwodGhpcyksdGhpcy5fZG9SZXNldCgpfX0se2tleToidXBkYXRlIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5fYXBwZW5kKGUpLHRoaXMuX3Byb2Nlc3MoKSx0aGlzfX0se2tleToiZmluYWxpemUiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiBlJiZ0aGlzLl9hcHBlbmQoZSksdGhpcy5fZG9GaW5hbGl6ZSgpfX1dLFt7a2V5OiJfY3JlYXRlSGVscGVyIix2YWx1ZTpmdW5jdGlvbihlKXtyZXR1cm4gZnVuY3Rpb24odCxyKXtyZXR1cm4gbmV3IGUocikuZmluYWxpemUodCl9fX0se2tleToiX2NyZWF0ZUhtYWNIZWxwZXIiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiBmdW5jdGlvbih0LHIpe3JldHVybiBuZXcgSGUoZSxyKS5maW5hbGl6ZSh0KX19fV0pLGF9KGplKSxIZT1mdW5jdGlvbihlKXtzKGEsZSk7dmFyIHQ9ZChhKTtmdW5jdGlvbiBhKGUsbil7dmFyIGk7cih0aGlzLGEpLGk9dC5jYWxsKHRoaXMpO3ZhciBzPW5ldyBlO2kuX2hhc2hlcj1zO3ZhciBvPW47InN0cmluZyI9PXR5cGVvZiBvJiYobz1OZShvKSk7dmFyIHU9cy5ibG9ja1NpemUsYz00KnU7by5zaWdCeXRlcz5jJiYobz1zLmZpbmFsaXplKG4pKSxvLmNsYW1wKCk7dmFyIGw9by5jbG9uZSgpO2kuX29LZXk9bDt2YXIgZj1vLmNsb25lKCk7aS5faUtleT1mO2Zvcih2YXIgZD1sLndvcmRzLGg9Zi53b3JkcyxwPTA7cDx1O3ArPTEpZFtwXV49MTU0OTU1NjgyOCxoW3BdXj05MDk1MjI0ODY7cmV0dXJuIGwuc2lnQnl0ZXM9YyxmLnNpZ0J5dGVzPWMsaS5yZXNldCgpLGl9cmV0dXJuIG4oYSxbe2tleToicmVzZXQiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5faGFzaGVyO2UucmVzZXQoKSxlLnVwZGF0ZSh0aGlzLl9pS2V5KX19LHtrZXk6InVwZGF0ZSIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2hhc2hlci51cGRhdGUoZSksdGhpc319LHtrZXk6ImZpbmFsaXplIix2YWx1ZTpmdW5jdGlvbihlKXt2YXIgdD10aGlzLl9oYXNoZXIscj10LmZpbmFsaXplKGUpO3JldHVybiB0LnJlc2V0KCksdC5maW5hbGl6ZSh0aGlzLl9vS2V5LmNsb25lKCkuY29uY2F0KHIpKX19XSksYX0oUmUpLEtlPXtzdHJpbmdpZnk6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS53b3JkcyxyPWUuc2lnQnl0ZXMsYT10aGlzLl9tYXA7ZS5jbGFtcCgpO2Zvcih2YXIgbj1bXSxpPTA7aTxyO2krPTMpZm9yKHZhciBzPSh0W2k+Pj4yXT4+PjI0LWklNCo4JjI1NSk8PDE2fCh0W2krMT4+PjJdPj4+MjQtKGkrMSklNCo4JjI1NSk8PDh8dFtpKzI+Pj4yXT4+PjI0LShpKzIpJTQqOCYyNTUsbz0wO288NCYmaSsuNzUqbzxyO28rPTEpbi5wdXNoKGEuY2hhckF0KHM+Pj42KigzLW8pJjYzKSk7dmFyIHU9YS5jaGFyQXQoNjQpO2lmKHUpZm9yKDtuLmxlbmd0aCU0OyluLnB1c2godSk7cmV0dXJuIG4uam9pbigiIil9LHBhcnNlOmZ1bmN0aW9uKGUpe3ZhciB0PWUubGVuZ3RoLHI9dGhpcy5fbWFwLGE9dGhpcy5fcmV2ZXJzZU1hcDtpZighYSl7dGhpcy5fcmV2ZXJzZU1hcD1bXSxhPXRoaXMuX3JldmVyc2VNYXA7Zm9yKHZhciBuPTA7bjxyLmxlbmd0aDtuKz0xKWFbci5jaGFyQ29kZUF0KG4pXT1ufXZhciBpPXIuY2hhckF0KDY0KTtpZihpKXt2YXIgcz1lLmluZGV4T2YoaSk7LTEhPT1zJiYodD1zKX1yZXR1cm4gZnVuY3Rpb24oZSx0LHIpe2Zvcih2YXIgYT1bXSxuPTAsaT0wO2k8dDtpKz0xKWlmKGklNCl7dmFyIHM9cltlLmNoYXJDb2RlQXQoaS0xKV08PGklNCoyfHJbZS5jaGFyQ29kZUF0KGkpXT4+PjYtaSU0KjI7YVtuPj4+Ml18PXM8PDI0LW4lNCo4LG4rPTF9cmV0dXJuIExlLmNyZWF0ZShhLG4pfShlLHQsYSl9LF9tYXA6IkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky89In0scWU9W10sV2U9MDtXZTw2NDtXZSs9MSlxZVtXZV09NDI5NDk2NzI5NipNYXRoLmFicyhNYXRoLnNpbihXZSsxKSl8MDt2YXIgWGU9ZnVuY3Rpb24oZSx0LHIsYSxuLGkscyl7dmFyIG89ZSsodCZyfH50JmEpK24rcztyZXR1cm4obzw8aXxvPj4+MzItaSkrdH0sWWU9ZnVuY3Rpb24oZSx0LHIsYSxuLGkscyl7dmFyIG89ZSsodCZhfHImfmEpK24rcztyZXR1cm4obzw8aXxvPj4+MzItaSkrdH0sWmU9ZnVuY3Rpb24oZSx0LHIsYSxuLGkscyl7dmFyIG89ZSsodF5yXmEpK24rcztyZXR1cm4obzw8aXxvPj4+MzItaSkrdH0sUWU9ZnVuY3Rpb24oZSx0LHIsYSxuLGkscyl7dmFyIG89ZSsocl4odHx+YSkpK24rcztyZXR1cm4obzw8aXxvPj4+MzItaSkrdH0sSmU9ZnVuY3Rpb24oZSl7cyhhLGUpO3ZhciB0PWQoYSk7ZnVuY3Rpb24gYSgpe3JldHVybiByKHRoaXMsYSksdC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9cmV0dXJuIG4oYSxbe2tleToiX2RvUmVzZXQiLHZhbHVlOmZ1bmN0aW9uKCl7dGhpcy5faGFzaD1uZXcgTGUoWzE3MzI1ODQxOTMsNDAyMzIzMzQxNywyNTYyMzgzMTAyLDI3MTczMzg3OF0pfX0se2tleToiX2RvUHJvY2Vzc0Jsb2NrIix2YWx1ZTpmdW5jdGlvbihlLHQpe2Zvcih2YXIgcj1lLGE9MDthPDE2O2ErPTEpe3ZhciBuPXQrYSxpPWVbbl07cltuXT0xNjcxMTkzNSYoaTw8OHxpPj4+MjQpfDQyNzgyNTUzNjAmKGk8PDI0fGk+Pj44KX12YXIgcz10aGlzLl9oYXNoLndvcmRzLG89clt0KzBdLHU9clt0KzFdLGM9clt0KzJdLGw9clt0KzNdLGY9clt0KzRdLGQ9clt0KzVdLGg9clt0KzZdLHA9clt0KzddLHY9clt0KzhdLHk9clt0KzldLG09clt0KzEwXSxnPXJbdCsxMV0saz1yW3QrMTJdLGI9clt0KzEzXSxfPXJbdCsxNF0sdz1yW3QrMTVdLHg9c1swXSxTPXNbMV0sRD1zWzJdLEE9c1szXTt4PVhlKHgsUyxELEEsbyw3LHFlWzBdKSxBPVhlKEEseCxTLEQsdSwxMixxZVsxXSksRD1YZShELEEseCxTLGMsMTcscWVbMl0pLFM9WGUoUyxELEEseCxsLDIyLHFlWzNdKSx4PVhlKHgsUyxELEEsZiw3LHFlWzRdKSxBPVhlKEEseCxTLEQsZCwxMixxZVs1XSksRD1YZShELEEseCxTLGgsMTcscWVbNl0pLFM9WGUoUyxELEEseCxwLDIyLHFlWzddKSx4PVhlKHgsUyxELEEsdiw3LHFlWzhdKSxBPVhlKEEseCxTLEQseSwxMixxZVs5XSksRD1YZShELEEseCxTLG0sMTcscWVbMTBdKSxTPVhlKFMsRCxBLHgsZywyMixxZVsxMV0pLHg9WGUoeCxTLEQsQSxrLDcscWVbMTJdKSxBPVhlKEEseCxTLEQsYiwxMixxZVsxM10pLEQ9WGUoRCxBLHgsUyxfLDE3LHFlWzE0XSksUz1YZShTLEQsQSx4LHcsMjIscWVbMTVdKSx4PVllKHgsUyxELEEsdSw1LHFlWzE2XSksQT1ZZShBLHgsUyxELGgsOSxxZVsxN10pLEQ9WWUoRCxBLHgsUyxnLDE0LHFlWzE4XSksUz1ZZShTLEQsQSx4LG8sMjAscWVbMTldKSx4PVllKHgsUyxELEEsZCw1LHFlWzIwXSksQT1ZZShBLHgsUyxELG0sOSxxZVsyMV0pLEQ9WWUoRCxBLHgsUyx3LDE0LHFlWzIyXSksUz1ZZShTLEQsQSx4LGYsMjAscWVbMjNdKSx4PVllKHgsUyxELEEseSw1LHFlWzI0XSksQT1ZZShBLHgsUyxELF8sOSxxZVsyNV0pLEQ9WWUoRCxBLHgsUyxsLDE0LHFlWzI2XSksUz1ZZShTLEQsQSx4LHYsMjAscWVbMjddKSx4PVllKHgsUyxELEEsYiw1LHFlWzI4XSksQT1ZZShBLHgsUyxELGMsOSxxZVsyOV0pLEQ9WWUoRCxBLHgsUyxwLDE0LHFlWzMwXSksUz1ZZShTLEQsQSx4LGssMjAscWVbMzFdKSx4PVplKHgsUyxELEEsZCw0LHFlWzMyXSksQT1aZShBLHgsUyxELHYsMTEscWVbMzNdKSxEPVplKEQsQSx4LFMsZywxNixxZVszNF0pLFM9WmUoUyxELEEseCxfLDIzLHFlWzM1XSkseD1aZSh4LFMsRCxBLHUsNCxxZVszNl0pLEE9WmUoQSx4LFMsRCxmLDExLHFlWzM3XSksRD1aZShELEEseCxTLHAsMTYscWVbMzhdKSxTPVplKFMsRCxBLHgsbSwyMyxxZVszOV0pLHg9WmUoeCxTLEQsQSxiLDQscWVbNDBdKSxBPVplKEEseCxTLEQsbywxMSxxZVs0MV0pLEQ9WmUoRCxBLHgsUyxsLDE2LHFlWzQyXSksUz1aZShTLEQsQSx4LGgsMjMscWVbNDNdKSx4PVplKHgsUyxELEEseSw0LHFlWzQ0XSksQT1aZShBLHgsUyxELGssMTEscWVbNDVdKSxEPVplKEQsQSx4LFMsdywxNixxZVs0Nl0pLFM9WmUoUyxELEEseCxjLDIzLHFlWzQ3XSkseD1RZSh4LFMsRCxBLG8sNixxZVs0OF0pLEE9UWUoQSx4LFMsRCxwLDEwLHFlWzQ5XSksRD1RZShELEEseCxTLF8sMTUscWVbNTBdKSxTPVFlKFMsRCxBLHgsZCwyMSxxZVs1MV0pLHg9UWUoeCxTLEQsQSxrLDYscWVbNTJdKSxBPVFlKEEseCxTLEQsbCwxMCxxZVs1M10pLEQ9UWUoRCxBLHgsUyxtLDE1LHFlWzU0XSksUz1RZShTLEQsQSx4LHUsMjEscWVbNTVdKSx4PVFlKHgsUyxELEEsdiw2LHFlWzU2XSksQT1RZShBLHgsUyxELHcsMTAscWVbNTddKSxEPVFlKEQsQSx4LFMsaCwxNSxxZVs1OF0pLFM9UWUoUyxELEEseCxiLDIxLHFlWzU5XSkseD1RZSh4LFMsRCxBLGYsNixxZVs2MF0pLEE9UWUoQSx4LFMsRCxnLDEwLHFlWzYxXSksRD1RZShELEEseCxTLGMsMTUscWVbNjJdKSxTPVFlKFMsRCxBLHgseSwyMSxxZVs2M10pLHNbMF09c1swXSt4fDAsc1sxXT1zWzFdK1N8MCxzWzJdPXNbMl0rRHwwLHNbM109c1szXStBfDB9fSx7a2V5OiJfZG9GaW5hbGl6ZSIsdmFsdWU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLl9kYXRhLHQ9ZS53b3JkcyxyPTgqdGhpcy5fbkRhdGFCeXRlcyxhPTgqZS5zaWdCeXRlczt0W2E+Pj41XXw9MTI4PDwyNC1hJTMyO3ZhciBuPU1hdGguZmxvb3Ioci80Mjk0OTY3Mjk2KSxpPXI7dFsxNSsoYSs2ND4+Pjk8PDQpXT0xNjcxMTkzNSYobjw8OHxuPj4+MjQpfDQyNzgyNTUzNjAmKG48PDI0fG4+Pj44KSx0WzE0KyhhKzY0Pj4+OTw8NCldPTE2NzExOTM1JihpPDw4fGk+Pj4yNCl8NDI3ODI1NTM2MCYoaTw8MjR8aT4+PjgpLGUuc2lnQnl0ZXM9NCoodC5sZW5ndGgrMSksdGhpcy5fcHJvY2VzcygpO2Zvcih2YXIgcz10aGlzLl9oYXNoLG89cy53b3Jkcyx1PTA7dTw0O3UrPTEpe3ZhciBjPW9bdV07b1t1XT0xNjcxMTkzNSYoYzw8OHxjPj4+MjQpfDQyNzgyNTUzNjAmKGM8PDI0fGM+Pj44KX1yZXR1cm4gc319LHtrZXk6ImNsb25lIix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlPXAobyhhLnByb3RvdHlwZSksImNsb25lIix0aGlzKS5jYWxsKHRoaXMpO3JldHVybiBlLl9oYXNoPXRoaXMuX2hhc2guY2xvbmUoKSxlfX1dKSxhfShHZSk7R2UuX2NyZWF0ZUhlbHBlcihKZSksR2UuX2NyZWF0ZUhtYWNIZWxwZXIoSmUpO3ZhciAkZT1mdW5jdGlvbihlKXtzKGEsZSk7dmFyIHQ9ZChhKTtmdW5jdGlvbiBhKGUpe3ZhciBuO3JldHVybiByKHRoaXMsYSksKG49dC5jYWxsKHRoaXMpKS5jZmc9T2JqZWN0LmFzc2lnbihuZXcgUmUse2tleVNpemU6NCxoYXNoZXI6SmUsaXRlcmF0aW9uczoxfSxlKSxufXJldHVybiBuKGEsW3trZXk6ImNvbXB1dGUiLHZhbHVlOmZ1bmN0aW9uKGUsdCl7Zm9yKHZhciByLGE9dGhpcy5jZmcsbj1hLmhhc2hlci5jcmVhdGUoKSxpPUxlLmNyZWF0ZSgpLHM9aS53b3JkcyxvPWEua2V5U2l6ZSx1PWEuaXRlcmF0aW9ucztzLmxlbmd0aDxvOyl7ciYmbi51cGRhdGUocikscj1uLnVwZGF0ZShlKS5maW5hbGl6ZSh0KSxuLnJlc2V0KCk7Zm9yKHZhciBjPTE7Yzx1O2MrPTEpcj1uLmZpbmFsaXplKHIpLG4ucmVzZXQoKTtpLmNvbmNhdChyKX1yZXR1cm4gaS5zaWdCeXRlcz00Km8saX19XSksYX0oUmUpLGV0PWZ1bmN0aW9uKGUpe3MoYSxlKTt2YXIgdD1kKGEpO2Z1bmN0aW9uIGEoZSxuLGkpe3ZhciBzO3JldHVybiByKHRoaXMsYSksKHM9dC5jYWxsKHRoaXMpKS5jZmc9T2JqZWN0LmFzc2lnbihuZXcgUmUsaSkscy5feGZvcm1Nb2RlPWUscy5fa2V5PW4scy5yZXNldCgpLHN9cmV0dXJuIG4oYSxbe2tleToicmVzZXQiLHZhbHVlOmZ1bmN0aW9uKCl7cChvKGEucHJvdG90eXBlKSwicmVzZXQiLHRoaXMpLmNhbGwodGhpcyksdGhpcy5fZG9SZXNldCgpfX0se2tleToicHJvY2VzcyIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuX2FwcGVuZChlKSx0aGlzLl9wcm9jZXNzKCl9fSx7a2V5OiJmaW5hbGl6ZSIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuIGUmJnRoaXMuX2FwcGVuZChlKSx0aGlzLl9kb0ZpbmFsaXplKCl9fV0sW3trZXk6ImNyZWF0ZUVuY3J5cHRvciIsdmFsdWU6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdGhpcy5jcmVhdGUodGhpcy5fRU5DX1hGT1JNX01PREUsZSx0KX19LHtrZXk6ImNyZWF0ZURlY3J5cHRvciIsdmFsdWU6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdGhpcy5jcmVhdGUodGhpcy5fREVDX1hGT1JNX01PREUsZSx0KX19LHtrZXk6Il9jcmVhdGVIZWxwZXIiLHZhbHVlOmZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKGUpe3JldHVybiJzdHJpbmciPT10eXBlb2YgZT9sdDp1dH07cmV0dXJue2VuY3J5cHQ6ZnVuY3Rpb24ocixhLG4pe3JldHVybiB0KGEpLmVuY3J5cHQoZSxyLGEsbil9LGRlY3J5cHQ6ZnVuY3Rpb24ocixhLG4pe3JldHVybiB0KGEpLmRlY3J5cHQoZSxyLGEsbil9fX19XSksYX0oamUpO2V0Ll9FTkNfWEZPUk1fTU9ERT0xLGV0Ll9ERUNfWEZPUk1fTU9ERT0yLGV0LmtleVNpemU9NCxldC5pdlNpemU9NDt2YXIgdHQ9ZnVuY3Rpb24oZSl7cyhhLGUpO3ZhciB0PWQoYSk7ZnVuY3Rpb24gYShlLG4pe3ZhciBpO3JldHVybiByKHRoaXMsYSksKGk9dC5jYWxsKHRoaXMpKS5fY2lwaGVyPWUsaS5faXY9bixpfXJldHVybiBuKGEsbnVsbCxbe2tleToiY3JlYXRlRW5jcnlwdG9yIix2YWx1ZTpmdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLkVuY3J5cHRvci5jcmVhdGUoZSx0KX19LHtrZXk6ImNyZWF0ZURlY3J5cHRvciIsdmFsdWU6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdGhpcy5EZWNyeXB0b3IuY3JlYXRlKGUsdCl9fV0pLGF9KFJlKTtmdW5jdGlvbiBydChlLHQscil7dmFyIGEsbj1lLGk9dGhpcy5faXY7aT8oYT1pLHRoaXMuX2l2PXZvaWQgMCk6YT10aGlzLl9wcmV2QmxvY2s7Zm9yKHZhciBzPTA7czxyO3MrPTEpblt0K3NdXj1hW3NdfXZhciBhdD1mdW5jdGlvbihlKXtzKGEsZSk7dmFyIHQ9ZChhKTtmdW5jdGlvbiBhKCl7cmV0dXJuIHIodGhpcyxhKSx0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX1yZXR1cm4gbihhKX0odHQpO2F0LkVuY3J5cHRvcj1mdW5jdGlvbihlKXtzKGEsZSk7dmFyIHQ9ZChhKTtmdW5jdGlvbiBhKCl7cmV0dXJuIHIodGhpcyxhKSx0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX1yZXR1cm4gbihhLFt7a2V5OiJwcm9jZXNzQmxvY2siLHZhbHVlOmZ1bmN0aW9uKGUsdCl7dmFyIHI9dGhpcy5fY2lwaGVyLGE9ci5ibG9ja1NpemU7cnQuY2FsbCh0aGlzLGUsdCxhKSxyLmVuY3J5cHRCbG9jayhlLHQpLHRoaXMuX3ByZXZCbG9jaz1lLnNsaWNlKHQsdCthKX19XSksYX0oYXQpLGF0LkRlY3J5cHRvcj1mdW5jdGlvbihlKXtzKGEsZSk7dmFyIHQ9ZChhKTtmdW5jdGlvbiBhKCl7cmV0dXJuIHIodGhpcyxhKSx0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX1yZXR1cm4gbihhLFt7a2V5OiJwcm9jZXNzQmxvY2siLHZhbHVlOmZ1bmN0aW9uKGUsdCl7dmFyIHI9dGhpcy5fY2lwaGVyLGE9ci5ibG9ja1NpemUsbj1lLnNsaWNlKHQsdCthKTtyLmRlY3J5cHRCbG9jayhlLHQpLHJ0LmNhbGwodGhpcyxlLHQsYSksdGhpcy5fcHJldkJsb2NrPW59fV0pLGF9KGF0KTt2YXIgbnQ9e3BhZDpmdW5jdGlvbihlLHQpe2Zvcih2YXIgcj00KnQsYT1yLWUuc2lnQnl0ZXMlcixuPWE8PDI0fGE8PDE2fGE8PDh8YSxpPVtdLHM9MDtzPGE7cys9NClpLnB1c2gobik7dmFyIG89TGUuY3JlYXRlKGksYSk7ZS5jb25jYXQobyl9LHVucGFkOmZ1bmN0aW9uKGUpe3ZhciB0PWUscj0yNTUmdC53b3Jkc1t0LnNpZ0J5dGVzLTE+Pj4yXTt0LnNpZ0J5dGVzLT1yfX0saXQ9ZnVuY3Rpb24oZSl7cyhhLGUpO3ZhciB0PWQoYSk7ZnVuY3Rpb24gYShlLG4saSl7dmFyIHM7cmV0dXJuIHIodGhpcyxhKSwocz10LmNhbGwodGhpcyxlLG4sT2JqZWN0LmFzc2lnbih7bW9kZTphdCxwYWRkaW5nOm50fSxpKSkpLmJsb2NrU2l6ZT00LHN9cmV0dXJuIG4oYSxbe2tleToicmVzZXQiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGU7cChvKGEucHJvdG90eXBlKSwicmVzZXQiLHRoaXMpLmNhbGwodGhpcyk7dmFyIHQ9dGhpcy5jZmcscj10Lml2LG49dC5tb2RlO3RoaXMuX3hmb3JtTW9kZT09PXRoaXMuY29uc3RydWN0b3IuX0VOQ19YRk9STV9NT0RFP2U9bi5jcmVhdGVFbmNyeXB0b3I6KGU9bi5jcmVhdGVEZWNyeXB0b3IsdGhpcy5fbWluQnVmZmVyU2l6ZT0xKSx0aGlzLl9tb2RlPWUuY2FsbChuLHRoaXMsciYmci53b3JkcyksdGhpcy5fbW9kZS5fX2NyZWF0b3I9ZX19LHtrZXk6Il9kb1Byb2Nlc3NCbG9jayIsdmFsdWU6ZnVuY3Rpb24oZSx0KXt0aGlzLl9tb2RlLnByb2Nlc3NCbG9jayhlLHQpfX0se2tleToiX2RvRmluYWxpemUiLHZhbHVlOmZ1bmN0aW9uKCl7dmFyIGUsdD10aGlzLmNmZy5wYWRkaW5nO3JldHVybiB0aGlzLl94Zm9ybU1vZGU9PT10aGlzLmNvbnN0cnVjdG9yLl9FTkNfWEZPUk1fTU9ERT8odC5wYWQodGhpcy5fZGF0YSx0aGlzLmJsb2NrU2l6ZSksZT10aGlzLl9wcm9jZXNzKCEwKSk6KGU9dGhpcy5fcHJvY2VzcyghMCksdC51bnBhZChlKSksZX19XSksYX0oZXQpLHN0PWZ1bmN0aW9uKGUpe3MoYSxlKTt2YXIgdD1kKGEpO2Z1bmN0aW9uIGEoZSl7dmFyIG47cmV0dXJuIHIodGhpcyxhKSwobj10LmNhbGwodGhpcykpLm1peEluKGUpLG59cmV0dXJuIG4oYSxbe2tleToidG9TdHJpbmciLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybihlfHx0aGlzLmZvcm1hdHRlcikuc3RyaW5naWZ5KHRoaXMpfX1dKSxhfShSZSksb3Q9e3N0cmluZ2lmeTpmdW5jdGlvbihlKXt2YXIgdD1lLmNpcGhlcnRleHQscj1lLnNhbHQ7cmV0dXJuKHI/TGUuY3JlYXRlKFsxMzk4ODkzNjg0LDE3MDEwNzY4MzFdKS5jb25jYXQocikuY29uY2F0KHQpOnQpLnRvU3RyaW5nKEtlKX0scGFyc2U6ZnVuY3Rpb24oZSl7dmFyIHQscj1LZS5wYXJzZShlKSxhPXIud29yZHM7cmV0dXJuIDEzOTg4OTM2ODQ9PT1hWzBdJiYxNzAxMDc2ODMxPT09YVsxXSYmKHQ9TGUuY3JlYXRlKGEuc2xpY2UoMiw0KSksYS5zcGxpY2UoMCw0KSxyLnNpZ0J5dGVzLT0xNiksc3QuY3JlYXRlKHtjaXBoZXJ0ZXh0OnIsc2FsdDp0fSl9fSx1dD1mdW5jdGlvbihlKXtzKGEsZSk7dmFyIHQ9ZChhKTtmdW5jdGlvbiBhKCl7cmV0dXJuIHIodGhpcyxhKSx0LmFwcGx5KHRoaXMsYXJndW1lbnRzKX1yZXR1cm4gbihhLG51bGwsW3trZXk6ImVuY3J5cHQiLHZhbHVlOmZ1bmN0aW9uKGUsdCxyLGEpe3ZhciBuPU9iamVjdC5hc3NpZ24obmV3IFJlLHRoaXMuY2ZnLGEpLGk9ZS5jcmVhdGVFbmNyeXB0b3IocixuKSxzPWkuZmluYWxpemUodCksbz1pLmNmZztyZXR1cm4gc3QuY3JlYXRlKHtjaXBoZXJ0ZXh0OnMsa2V5OnIsaXY6by5pdixhbGdvcml0aG06ZSxtb2RlOm8ubW9kZSxwYWRkaW5nOm8ucGFkZGluZyxibG9ja1NpemU6aS5ibG9ja1NpemUsZm9ybWF0dGVyOm4uZm9ybWF0fSl9fSx7a2V5OiJkZWNyeXB0Iix2YWx1ZTpmdW5jdGlvbihlLHQscixhKXt2YXIgbj10LGk9T2JqZWN0LmFzc2lnbihuZXcgUmUsdGhpcy5jZmcsYSk7cmV0dXJuIG49dGhpcy5fcGFyc2UobixpLmZvcm1hdCksZS5jcmVhdGVEZWNyeXB0b3IocixpKS5maW5hbGl6ZShuLmNpcGhlcnRleHQpfX0se2tleToiX3BhcnNlIix2YWx1ZTpmdW5jdGlvbihlLHQpe3JldHVybiJzdHJpbmciPT10eXBlb2YgZT90LnBhcnNlKGUsdGhpcyk6ZX19XSksYX0oUmUpO3V0LmNmZz1PYmplY3QuYXNzaWduKG5ldyBSZSx7Zm9ybWF0Om90fSk7dmFyIGN0PXtleGVjdXRlOmZ1bmN0aW9uKGUsdCxyLGEpe3ZhciBuPWE7bnx8KG49TGUucmFuZG9tKDgpKTt2YXIgaT0kZS5jcmVhdGUoe2tleVNpemU6dCtyfSkuY29tcHV0ZShlLG4pLHM9TGUuY3JlYXRlKGkud29yZHMuc2xpY2UodCksNCpyKTtyZXR1cm4gaS5zaWdCeXRlcz00KnQsc3QuY3JlYXRlKHtrZXk6aSxpdjpzLHNhbHQ6bn0pfX0sbHQ9ZnVuY3Rpb24oZSl7cyhhLGUpO3ZhciB0PWQoYSk7ZnVuY3Rpb24gYSgpe3JldHVybiByKHRoaXMsYSksdC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9cmV0dXJuIG4oYSxudWxsLFt7a2V5OiJlbmNyeXB0Iix2YWx1ZTpmdW5jdGlvbihlLHQscixhKXt2YXIgbj1PYmplY3QuYXNzaWduKG5ldyBSZSx0aGlzLmNmZyxhKSxpPW4ua2RmLmV4ZWN1dGUocixlLmtleVNpemUsZS5pdlNpemUpO24uaXY9aS5pdjt2YXIgcz11dC5lbmNyeXB0LmNhbGwodGhpcyxlLHQsaS5rZXksbik7cmV0dXJuIHMubWl4SW4oaSksc319LHtrZXk6ImRlY3J5cHQiLHZhbHVlOmZ1bmN0aW9uKGUsdCxyLGEpe3ZhciBuPXQsaT1PYmplY3QuYXNzaWduKG5ldyBSZSx0aGlzLmNmZyxhKTtuPXRoaXMuX3BhcnNlKG4saS5mb3JtYXQpO3ZhciBzPWkua2RmLmV4ZWN1dGUocixlLmtleVNpemUsZS5pdlNpemUsbi5zYWx0KTtyZXR1cm4gaS5pdj1zLml2LHV0LmRlY3J5cHQuY2FsbCh0aGlzLGUsbixzLmtleSxpKX19XSksYX0odXQpO2x0LmNmZz1PYmplY3QuYXNzaWduKHV0LmNmZyx7a2RmOmN0fSk7Zm9yKHZhciBmdD1bXSxkdD1bXSxodD1bXSxwdD1bXSx2dD1bXSx5dD1bXSxtdD1bXSxndD1bXSxrdD1bXSxidD1bXSxfdD1bXSx3dD0wO3d0PDI1Njt3dCs9MSlfdFt3dF09d3Q8MTI4P3d0PDwxOnd0PDwxXjI4Mztmb3IodmFyIHh0PTAsU3Q9MCxEdD0wO0R0PDI1NjtEdCs9MSl7dmFyIEF0PVN0XlN0PDwxXlN0PDwyXlN0PDwzXlN0PDw0O0F0PUF0Pj4+OF4yNTUmQXReOTksZnRbeHRdPUF0LGR0W0F0XT14dDt2YXIgVHQ9X3RbeHRdLEJ0PV90W1R0XSxFdD1fdFtCdF0sVXQ9MjU3Kl90W0F0XV4xNjg0MzAwOCpBdDtodFt4dF09VXQ8PDI0fFV0Pj4+OCxwdFt4dF09VXQ8PDE2fFV0Pj4+MTYsdnRbeHRdPVV0PDw4fFV0Pj4+MjQseXRbeHRdPVV0LFV0PTE2ODQzMDA5KkV0XjY1NTM3KkJ0XjI1NypUdF4xNjg0MzAwOCp4dCxtdFtBdF09VXQ8PDI0fFV0Pj4+OCxndFtBdF09VXQ8PDE2fFV0Pj4+MTYsa3RbQXRdPVV0PDw4fFV0Pj4+MjQsYnRbQXRdPVV0LHh0Pyh4dD1UdF5fdFtfdFtfdFtFdF5UdF1dXSxTdF49X3RbX3RbU3RdXSk6eHQ9U3Q9MX12YXIgQ3Q9WzAsMSwyLDQsOCwxNiwzMiw2NCwxMjgsMjcsNTRdLFB0PWZ1bmN0aW9uKGUpe3MoYSxlKTt2YXIgdD1kKGEpO2Z1bmN0aW9uIGEoKXtyZXR1cm4gcih0aGlzLGEpLHQuYXBwbHkodGhpcyxhcmd1bWVudHMpfXJldHVybiBuKGEsW3trZXk6Il9kb1Jlc2V0Iix2YWx1ZTpmdW5jdGlvbigpe3ZhciBlO2lmKCF0aGlzLl9uUm91bmRzfHx0aGlzLl9rZXlQcmlvclJlc2V0IT09dGhpcy5fa2V5KXt0aGlzLl9rZXlQcmlvclJlc2V0PXRoaXMuX2tleTt2YXIgdD10aGlzLl9rZXlQcmlvclJlc2V0LHI9dC53b3JkcyxhPXQuc2lnQnl0ZXMvNDt0aGlzLl9uUm91bmRzPWErNjt2YXIgbj00Kih0aGlzLl9uUm91bmRzKzEpO3RoaXMuX2tleVNjaGVkdWxlPVtdO2Zvcih2YXIgaT10aGlzLl9rZXlTY2hlZHVsZSxzPTA7czxuO3MrPTEpczxhP2lbc109cltzXTooZT1pW3MtMV0scyVhP2E+NiYmcyVhPT00JiYoZT1mdFtlPj4+MjRdPDwyNHxmdFtlPj4+MTYmMjU1XTw8MTZ8ZnRbZT4+PjgmMjU1XTw8OHxmdFsyNTUmZV0pOihlPWZ0WyhlPWU8PDh8ZT4+PjI0KT4+PjI0XTw8MjR8ZnRbZT4+PjE2JjI1NV08PDE2fGZ0W2U+Pj44JjI1NV08PDh8ZnRbMjU1JmVdLGVePUN0W3MvYXwwXTw8MjQpLGlbc109aVtzLWFdXmUpO3RoaXMuX2ludktleVNjaGVkdWxlPVtdO2Zvcih2YXIgbz10aGlzLl9pbnZLZXlTY2hlZHVsZSx1PTA7dTxuO3UrPTEpe3ZhciBjPW4tdTtlPXUlND9pW2NdOmlbYy00XSxvW3VdPXU8NHx8Yzw9ND9lOm10W2Z0W2U+Pj4yNF1dXmd0W2Z0W2U+Pj4xNiYyNTVdXV5rdFtmdFtlPj4+OCYyNTVdXV5idFtmdFsyNTUmZV1dfX19fSx7a2V5OiJlbmNyeXB0QmxvY2siLHZhbHVlOmZ1bmN0aW9uKGUsdCl7dGhpcy5fZG9DcnlwdEJsb2NrKGUsdCx0aGlzLl9rZXlTY2hlZHVsZSxodCxwdCx2dCx5dCxmdCl9fSx7a2V5OiJkZWNyeXB0QmxvY2siLHZhbHVlOmZ1bmN0aW9uKGUsdCl7dmFyIHI9ZSxhPXJbdCsxXTtyW3QrMV09clt0KzNdLHJbdCszXT1hLHRoaXMuX2RvQ3J5cHRCbG9jayhyLHQsdGhpcy5faW52S2V5U2NoZWR1bGUsbXQsZ3Qsa3QsYnQsZHQpLGE9clt0KzFdLHJbdCsxXT1yW3QrM10sclt0KzNdPWF9fSx7a2V5OiJfZG9DcnlwdEJsb2NrIix2YWx1ZTpmdW5jdGlvbihlLHQscixhLG4saSxzLG8pe2Zvcih2YXIgdT1lLGM9dGhpcy5fblJvdW5kcyxsPXVbdF1eclswXSxmPXVbdCsxXV5yWzFdLGQ9dVt0KzJdXnJbMl0saD11W3QrM11eclszXSxwPTQsdj0xO3Y8Yzt2Kz0xKXt2YXIgeT1hW2w+Pj4yNF1ebltmPj4+MTYmMjU1XV5pW2Q+Pj44JjI1NV1ec1syNTUmaF1ecltwXTtwKz0xO3ZhciBtPWFbZj4+PjI0XV5uW2Q+Pj4xNiYyNTVdXmlbaD4+PjgmMjU1XV5zWzI1NSZsXV5yW3BdO3ArPTE7dmFyIGc9YVtkPj4+MjRdXm5baD4+PjE2JjI1NV1eaVtsPj4+OCYyNTVdXnNbMjU1JmZdXnJbcF07cCs9MTt2YXIgaz1hW2g+Pj4yNF1ebltsPj4+MTYmMjU1XV5pW2Y+Pj44JjI1NV1ec1syNTUmZF1ecltwXTtwKz0xLGw9eSxmPW0sZD1nLGg9a312YXIgYj0ob1tsPj4+MjRdPDwyNHxvW2Y+Pj4xNiYyNTVdPDwxNnxvW2Q+Pj44JjI1NV08PDh8b1syNTUmaF0pXnJbcF07cCs9MTt2YXIgXz0ob1tmPj4+MjRdPDwyNHxvW2Q+Pj4xNiYyNTVdPDwxNnxvW2g+Pj44JjI1NV08PDh8b1syNTUmbF0pXnJbcF07cCs9MTt2YXIgdz0ob1tkPj4+MjRdPDwyNHxvW2g+Pj4xNiYyNTVdPDwxNnxvW2w+Pj44JjI1NV08PDh8b1syNTUmZl0pXnJbcF07cCs9MTt2YXIgeD0ob1toPj4+MjRdPDwyNHxvW2w+Pj4xNiYyNTVdPDwxNnxvW2Y+Pj44JjI1NV08PDh8b1syNTUmZF0pXnJbcF07cCs9MSx1W3RdPWIsdVt0KzFdPV8sdVt0KzJdPXcsdVt0KzNdPXh9fV0pLGF9KGl0KTtQdC5rZXlTaXplPTg7dmFyIEl0PWl0Ll9jcmVhdGVIZWxwZXIoUHQpLE10PWZ1bmN0aW9uKGUpe3MoYSxlKTt2YXIgdD1kKGEpO2Z1bmN0aW9uIGEoKXtyZXR1cm4gcih0aGlzLGEpLHQuYXBwbHkodGhpcyxhcmd1bWVudHMpfXJldHVybiBuKGEpfSh0dCk7TXQuRW5jcnlwdG9yPWZ1bmN0aW9uKGUpe3MoYSxlKTt2YXIgdD1kKGEpO2Z1bmN0aW9uIGEoKXtyZXR1cm4gcih0aGlzLGEpLHQuYXBwbHkodGhpcyxhcmd1bWVudHMpfXJldHVybiBuKGEsW3trZXk6InByb2Nlc3NCbG9jayIsdmFsdWU6ZnVuY3Rpb24oZSx0KXt2YXIgcj1lLGE9dGhpcy5fY2lwaGVyLG49YS5ibG9ja1NpemUsaT10aGlzLl9pdixzPXRoaXMuX2NvdW50ZXI7aSYmKHRoaXMuX2NvdW50ZXI9aS5zbGljZSgwKSxzPXRoaXMuX2NvdW50ZXIsdGhpcy5faXY9dm9pZCAwKTt2YXIgbz1zLnNsaWNlKDApO2EuZW5jcnlwdEJsb2NrKG8sMCksc1tuLTFdPXNbbi0xXSsxfDA7Zm9yKHZhciB1PTA7dTxuO3UrPTEpclt0K3VdXj1vW3VdfX1dKSxhfShNdCksTXQuRGVjcnlwdG9yPU10LkVuY3J5cHRvcjt2YXIgenQ9e3BhZDpmdW5jdGlvbigpe30sdW5wYWQ6ZnVuY3Rpb24oKXt9fSxPdD17ZGVjcnlwdFdvcmRBcnJheTpmdW5jdGlvbihlLHQscil7dmFyIGE9VmUucGFyc2UodCksbj1WZS5wYXJzZShuZShyKSksaT1MZS5jcmVhdGUobmV3IFVpbnQ4QXJyYXkoZSkpLHM9SXQuZGVjcnlwdChzdC5jcmVhdGUoe2NpcGhlcnRleHQ6aX0pLGEse2l2Om4sbW9kZTpNdCxwYWRkaW5nOnp0fSk7cmV0dXJuIE90LndvcmRBcnJheVRvVWludDhBcnJheShzKX0sd29yZEFycmF5VG9VaW50OEFycmF5OmZ1bmN0aW9uKGUpe2Zvcih2YXIgdD1lLnNpZ0J5dGVzLHI9ZS53b3JkcyxhPW5ldyBVaW50OEFycmF5KHQpLG49MCxpPTA7biE9PXQ7KXt2YXIgcz1yW2krK107aWYoYVtuKytdPSg0Mjc4MTkwMDgwJnMpPj4+MjQsbj09PXQpYnJlYWs7aWYoYVtuKytdPSgxNjcxMTY4MCZzKT4+PjE2LG49PT10KWJyZWFrO2lmKGFbbisrXT0oNjUyODAmcyk+Pj44LG49PT10KWJyZWFrO2FbbisrXT0yNTUmc31yZXR1cm4gYX0sZGVjb2RlckFFU0NUUkRhdGE6ZnVuY3Rpb24oZSx0LHIpe2lmKGUudmlkZW9TZW5jKXt2YXIgYT1lLmtpZFZhbHVlLG49ZS52aWRlb1NlbmM7ZS5zYW1wbGVzLmZvckVhY2goKGZ1bmN0aW9uKHQsaSl7dmFyIHM9bltpXSxvPXQuZGF0YSx1PVtdLGM9W10sbD1zLkluaXRpYWxpemF0aW9uVmVjdG9yO2lmKHMuc3Vic2FtcGxlcyYmcy5zdWJzYW1wbGVzLmxlbmd0aClzLnN1YnNhbXBsZXMuZm9yRWFjaCgoZnVuY3Rpb24oZSl7dmFyIHQ9ZS5CeXRlc09mQ2xlYXJEYXRhK2UuQnl0ZXNPZlByb3RlY3RlZERhdGEscj1vLnNsaWNlKDAsdCk7dS5wdXNoKHIuc2xpY2UoMCxlLkJ5dGVzT2ZDbGVhckRhdGEpKSxjLnB1c2goci5zbGljZShlLkJ5dGVzT2ZDbGVhckRhdGEpKSxvPW8uc2xpY2UodCl9KSk7ZWxzZXt2YXIgZj10LnNpemU7dS5wdXNoKG8uc2xpY2UoMCwwKSksYy5wdXNoKG8uc2xpY2UoMCxmKSksbz1vLnNsaWNlKGYpfXZhciBkPW5ldyBQZTtkLndyaXRlLmFwcGx5KGQsYyk7dmFyIGg9cj9yKGQuYnVmZmVyLGEsbCk6T3QuZGVjcnlwdFdvcmRBcnJheShkLmJ1ZmZlcixhLGwpLHA9bmV3IFBlO3UuZm9yRWFjaCgoZnVuY3Rpb24oZSx0KXt2YXIgcj1jW3RdLmxlbmd0aCxhPWguc2xpY2UoMCxyKTtwLndyaXRlKGUpLHAud3JpdGUoYSksaD1oLnNsaWNlKHIpfSkpLGUuc2FtcGxlc1tpXS5kYXRhPXAuYnVmZmVyfSkpfWlmKHQuYXVkaW9TZW5jKXt2YXIgaT10LmtpZFZhbHVlLHM9dC5hdWRpb1NlbmM7dC5zYW1wbGVzLmZvckVhY2goKGZ1bmN0aW9uKGUsYSl7dmFyIG49c1thXSxvPXI/cihlLmRhdGEsaSxuLkluaXRpYWxpemF0aW9uVmVjdG9yKTpPdC5kZWNyeXB0V29yZEFycmF5KGUuZGF0YSxpLG4uSW5pdGlhbGl6YXRpb25WZWN0b3IpO3Quc2FtcGxlc1thXS5kYXRhPW99KSl9fX0sUnQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHQsYSxuLHMpe3ZhciBvPXRoaXM7cih0aGlzLGUpLGkodGhpcywiX3ZpZGVvU2FtcGxlcyIsW10pLGkodGhpcywiX2F1ZGlvU2FtcGxlcyIsW10pLGkodGhpcywiX2xhc3RSZW1haW5CdWZmZXIiLFtdKSxpKHRoaXMsIl9sYXN0UmVtYWluQnVmZmVyU3RhcnRQb3MiLDApLHRoaXMudmlkZW9UcmFjaz1uZXcgTyx0aGlzLmF1ZGlvVHJhY2s9bmV3IFIsdGhpcy5tZXRhZGF0YVRyYWNrPW58fG5ldyBHLHRoaXMubG9nPW5ldyB6ZSgiTVA0RGVtdXhlciIsIXN8fCFzLm9wZW5Mb2d8fCFzLm9wZW5Mb2cpLHQmJnQuZm9yRWFjaCgoZnVuY3Rpb24oZSl7dmFyIHQ7KHQ9by5fdmlkZW9TYW1wbGVzKS5wdXNoLmFwcGx5KHQseShlLmZyYW1lcykpfSkpLGEmJmEuZm9yRWFjaCgoZnVuY3Rpb24oZSl7dmFyIHQ7KHQ9by5fYXVkaW9TYW1wbGVzKS5wdXNoLmFwcGx5KHQseShlLmZyYW1lcykpfSkpfXJldHVybiBuKGUsW3trZXk6InBhcnNlU2FtcGxlcyIsdmFsdWU6ZnVuY3Rpb24oZSl7aWYoIWUpdGhyb3cgbmV3IEVycm9yKCJtb292IGlzIHJlcXVpcmVkIik7aWYodGhpcy52aWRlb1RyYWNrLmNvZGVjfHx0aGlzLmF1ZGlvVHJhY2suY29kZWN8fChTZS5tb292VG9UcmFjayhlLHRoaXMudmlkZW9UcmFjayx0aGlzLmF1ZGlvVHJhY2spLHRoaXMudmlkZW9TZW5jPXRoaXMudmlkZW9UcmFjay52aWRlb1NlbmMsdGhpcy5hdWRpb1NlbmM9dGhpcy5hdWRpb1RyYWNrLmF1ZGlvU2VuYyksIXRoaXMuX2F1ZGlvU2FtcGxlcy5sZW5ndGgmJiF0aGlzLl92aWRlb1NhbXBsZXMubGVuZ3RoKXt2YXIgdD1TZS5tb292VG9TYW1wbGVzKGUpO2lmKCF0KXRocm93IG5ldyBFcnJvcigiY2Fubm90IHBhcnNlIHNhbXBsZXMgZnJvbSBtb292IGJveCIpO3RoaXMuX3ZpZGVvU2FtcGxlcz10LnZpZGVvU2FtcGxlc3x8W10sdGhpcy5fYXVkaW9TYW1wbGVzPXQuYXVkaW9TYW1wbGVzfHxbXX19fSx7a2V5OiJkZW11eCIsdmFsdWU6ZnVuY3Rpb24oZSx0LHIsYSxuKXt0aGlzLnBhcnNlU2FtcGxlcyhuKTt2YXIgaSxzLG8sdT10aGlzLnZpZGVvVHJhY2ssYz10aGlzLmF1ZGlvVHJhY2s7aWYodS5zYW1wbGVzPVtdLGMuc2FtcGxlcz1bXSxyKXtmb3IodmFyIGwsZj0wLGQ9clswXSxoPXJbMV07ZDw9aDtkKyspe2lmKCEoaT10aGlzLl92aWRlb1NhbXBsZXNbZF0pKXRocm93IG5ldyBFcnJvcigiY2Fubm90IGZvdW5kIHZpZGVvIGZyYW1lICMiLmNvbmNhdChkKSk7bz1pLm9mZnNldC10LHM9ZS5zdWJhcnJheShvLG8raS5zaXplKSwobD1uZXcgTChpLnB0c3x8aS5kdHMsaS5kdHMpKS5kdXJhdGlvbj1pLmR1cmF0aW9uLGwuZ29wSWQ9aS5nb3BJZCxpLmtleWZyYW1lJiZsLnNldFRvS2V5ZnJhbWUoKTtmb3IodmFyIHA9MCx2PXMubGVuZ3RoLTE7cDx2OylmPXRlKHMscCkscCs9NCxsLnVuaXRzLnB1c2gocy5zdWJhcnJheShwLHArZikpLHArPWY7dS5zYW1wbGVzLnB1c2gobCl9dS5iYXNlTWVkaWFEZWNvZGVUaW1lPXUuc2FtcGxlc1swXS5kdHN9aWYoYSl7Zm9yKHZhciB5PWFbMF0sbT1hWzFdO3k8PW07eSsrKXtpZighKGk9dGhpcy5fYXVkaW9TYW1wbGVzW3ldKSl0aHJvdyBuZXcgRXJyb3IoImNhbm5vdCBmb3VuZCB2aWRlbyBmcmFtZSAjIi5jb25jYXQoeSkpO289aS5vZmZzZXQtdCxzPWUuc3ViYXJyYXkobyxvK2kuc2l6ZSksYy5zYW1wbGVzLnB1c2gobmV3IFYoaS5kdHMscyxpLmR1cmF0aW9uKSl9Yy5iYXNlTWVkaWFEZWNvZGVUaW1lPWMuc2FtcGxlc1swXS5kdHN9cmV0dXJue3ZpZGVvVHJhY2s6dSxhdWRpb1RyYWNrOmMsbWV0YWRhdGFUcmFjazp0aGlzLm1ldGFkYXRhVHJhY2t9fX0se2tleToiZGVtdXhQYXJ0Iix2YWx1ZTpmdW5jdGlvbihlLHQscixhLG4saSxzLG8pe2lmKHRoaXMucGFyc2VTYW1wbGVzKG4pLHRoaXMudmlkZW9UcmFjay51c2VFTUU9aSx0aGlzLmF1ZGlvVHJhY2sudXNlRU1FPWksdGhpcy5fbGFzdFJlbWFpbkJ1ZmZlciYmdGhpcy5fbGFzdFJlbWFpbkJ1ZmZlci5ieXRlTGVuZ3RoPjAmJnQ+dGhpcy5fbGFzdFJlbWFpbkJ1ZmZlclN0YXJ0UG9zJiZ0PD10aGlzLl9sYXN0UmVtYWluQnVmZmVyU3RhcnRQb3MrdGhpcy5fbGFzdFJlbWFpbkJ1ZmZlci5ieXRlTGVuZ3RoKWZvcih2YXIgdT0wO3U8MjA7KXRyeXt2YXIgYz10aGlzLl9sYXN0UmVtYWluQnVmZmVyLnN1YmFycmF5KDAsdC10aGlzLl9sYXN0UmVtYWluQnVmZmVyU3RhcnRQb3MpLGw9bmV3IFVpbnQ4QXJyYXkoZS5ieXRlTGVuZ3RoK2MuYnl0ZUxlbmd0aCk7bC5zZXQoYywwKSxsLnNldChuZXcgVWludDhBcnJheShlKSxjLmJ5dGVMZW5ndGgpLGU9bCx0LT1jLmJ5dGVMZW5ndGgsdGhpcy5fbGFzdFJlbWFpbkJ1ZmZlcj1udWxsLHRoaXMuX2xhc3RSZW1haW5CdWZmZXJTdGFydFBvcz0wO2JyZWFrfWNhdGNoKFQpe2lmKCEodTwyMCkpdGhyb3cgbmV3IEVycm9yKCJuZXcgVWludDhBcnJheSBlcnJvcjosIitULmVycm9yTWVzc2FnZSk7dSsrfXZhciBmLGQsaCxwPXRoaXMudmlkZW9UcmFjayx2PXRoaXMuYXVkaW9UcmFjaztwLnNhbXBsZXM9W10sdi5zYW1wbGVzPVtdLHAudmlkZW9TZW5jPW51bGwsdi5hdWRpb1NlbmM9bnVsbDt2YXIgeT0wLG09MDtpZih0aGlzLl92aWRlb1NhbXBsZXMubGVuZ3RoPjAmJnIubGVuZ3RoPjApe2Zvcih2YXIgZyxrPWUuYnl0ZUxlbmd0aCt0LGI9clswXTtiPD1yWzFdO2IrKyl7aWYoIShmPXRoaXMuX3ZpZGVvU2FtcGxlc1tiXSkpdGhyb3cgbmV3IEVycm9yKCJjYW5ub3QgZm91bmQgdmlkZW8gZnJhbWUgIyIuY29uY2F0KGIpKTtmLm9mZnNldD49dCYmZi5vZmZzZXQrZi5zaXplPD1rJiYoeT0oaD1mLm9mZnNldC10KStmLnNpemUsZD1lLnN1YmFycmF5KGgseSksKGc9bmV3IEwoZi5wdHN8fGYuZHRzLGYuZHRzKSkuZHVyYXRpb249Zi5kdXJhdGlvbixnLmdvcElkPWYuZ29wSWQsZy5zYW1wbGVPZmZzZXQ9Zi5pbmRleCxmLmtleWZyYW1lJiZnLnNldFRvS2V5ZnJhbWUoKSxnLmRhdGE9ZCxnLnNpemU9Zi5zaXplLHAuc2FtcGxlcy5wdXNoKGcpKX1wLnNhbXBsZXMubGVuZ3RoPjAmJihwLmdvcElkPXAuc2FtcGxlc1swXS5nb3BJZCxwLmJhc2VNZWRpYURlY29kZVRpbWU9cC5zYW1wbGVzWzBdLmR0cyxwLnN0YXJ0UHRzPXAuc2FtcGxlc1swXS5wdHMvcC50aW1lc2NhbGUscC5lbmRQdHM9cC5zYW1wbGVzW3Auc2FtcGxlcy5sZW5ndGgtMV0ucHRzL3AudGltZXNjYWxlLHRoaXMudmlkZW9TZW5jJiYocC52aWRlb1NlbmM9dGhpcy52aWRlb1NlbmMuc2xpY2UocC5zYW1wbGVzWzBdLnNhbXBsZU9mZnNldCxwLnNhbXBsZXNbMF0uc2FtcGxlT2Zmc2V0K3Auc2FtcGxlcy5sZW5ndGgpLHAua2lkVmFsdWU9cykpfWlmKHRoaXMuX2F1ZGlvU2FtcGxlcy5sZW5ndGg+MCYmYS5sZW5ndGg+MCl7Zm9yKHZhciBfPWFbMF07Xzw9YVsxXTtfKyspe2lmKCEoZj10aGlzLl9hdWRpb1NhbXBsZXNbX10pKXRocm93IG5ldyBFcnJvcigiY2Fubm90IGZvdW5kIHZpZGVvIGZyYW1lICMiLmNvbmNhdChfKSk7Zi5vZmZzZXQ+PXQmJmYub2Zmc2V0K2Yuc2l6ZTw9ZS5ieXRlTGVuZ3RoK3QmJihtPShoPWYub2Zmc2V0LXQpK2Yuc2l6ZSxkPWUuc3ViYXJyYXkoaCxtKSx2LnNhbXBsZXMucHVzaChuZXcgVihmLmR0cyxkLGYuZHVyYXRpb24sZi5pbmRleCkpKX12LnNhbXBsZXMubGVuZ3RoPjAmJih2LmdvcElkPXYuc2FtcGxlc1swXS5nb3BJZHx8cC5nb3BJZCx2LmJhc2VNZWRpYURlY29kZVRpbWU9di5zYW1wbGVzWzBdLmR0cyx2LnN0YXJ0UHRzPXYuc2FtcGxlc1swXS5wdHMvdi50aW1lc2NhbGUsdi5lbmRQdHM9di5zYW1wbGVzW3Yuc2FtcGxlcy5sZW5ndGgtMV0ucHRzL3YudGltZXNjYWxlLHRoaXMuYXVkaW9TZW5jJiYodi5hdWRpb1NlbmM9dGhpcy5hdWRpb1NlbmMuc2xpY2Uodi5zYW1wbGVzWzBdLnNhbXBsZU9mZnNldCx2LnNhbXBsZXNbMF0uc2FtcGxlT2Zmc2V0K3Yuc2FtcGxlcy5sZW5ndGgpLHYua2lkVmFsdWU9cykpfXRoaXMuZGVjb2RlckRhdGEocCx2LG8pO2Zvcih2YXIgdz0wLHg9MDt4PHAuc2FtcGxlcy5sZW5ndGg7eCsrKWZvcih2YXIgUz0wLEQ9cC5zYW1wbGVzW3hdLmRhdGEsQT1ELmxlbmd0aC0xO1M8QTspdz10ZShELFMpLFMrPTQscC5zYW1wbGVzW3hdLnVuaXRzLnB1c2goRC5zdWJhcnJheShTLFMrdykpLFMrPXc7cmV0dXJuIHRoaXMuX2xhc3RSZW1haW5CdWZmZXI9ZS5zdWJhcnJheShNYXRoLm1heCh5LG0pKSx0aGlzLl9sYXN0UmVtYWluQnVmZmVyLmJ5dGVMZW5ndGg+MD90aGlzLl9sYXN0UmVtYWluQnVmZmVyU3RhcnRQb3M9dCtlLmJ5dGVMZW5ndGgtdGhpcy5fbGFzdFJlbWFpbkJ1ZmZlci5ieXRlTGVuZ3RoOnRoaXMuX2xhc3RSZW1haW5CdWZmZXJTdGFydFBvcz0wLHt2aWRlb1RyYWNrOnAsYXVkaW9UcmFjazp2LG1ldGFkYXRhVHJhY2s6dGhpcy5tZXRhZGF0YVRyYWNrfX19LHtrZXk6InJlc2V0Iix2YWx1ZTpmdW5jdGlvbigpe3RoaXMuX3ZpZGVvU2FtcGxlcz1bXSx0aGlzLl9hdWRpb1NhbXBsZXM9W10sdGhpcy5fbGFzdFJlbWFpbkJ1ZmZlcj1udWxsLHRoaXMuX2xhc3RSZW1haW5CdWZmZXJTdGFydFBvcz0wLHRoaXMudmlkZW9UcmFjay5yZXNldCgpLHRoaXMuYXVkaW9UcmFjay5yZXNldCgpLHRoaXMubWV0YWRhdGFUcmFjay5yZXNldCgpfX0se2tleToiZGVjb2RlckRhdGEiLHZhbHVlOmZ1bmN0aW9uKGUsdCxyKXtlLnVzZUVNRXx8dC51c2VFTUV8fE90LmRlY29kZXJBRVNDVFJEYXRhKGUsdCxyKX19XSxbe2tleToicHJvYmUiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybiBTZS5wcm9iZShlKX19XSksZX0oKSxMdD17bm93VGltZTpmdW5jdGlvbigpe3RyeXtyZXR1cm4gcGFyc2VJbnQocGVyZm9ybWFuY2Uubm93KCksMTApfWNhdGNoKGUpe3JldHVybihuZXcgRGF0ZSkuZ2V0VGltZSgpfX0sY29uY2F0RGF0YTpmdW5jdGlvbihlLHQpe3ZhciByPVtdLGE9MDtlJiZyLnB1c2goZSksdCYmci5wdXNoKHQpLHIuZXZlcnkoKGZ1bmN0aW9uKGUpe3JldHVybiBlJiYoYSs9ZS5ieXRlTGVuZ3RoKSwhMH0pKTt2YXIgbj1uZXcgVWludDhBcnJheShhKSxpPTA7cmV0dXJuIHIuZXZlcnkoKGZ1bmN0aW9uKGUpe3JldHVybiBlJiYobi5zZXQoZSxpKSxpKz1lLmJ5dGVMZW5ndGgpLCEwfSkpLG59fTtvbm1lc3NhZ2U9ZnVuY3Rpb24oZSl7dmFyIHI9ZS5kYXRhO3N3aXRjaChyLm1ldGhvZCl7Y2FzZSJpbml0Ijp0aGlzLmNvZGVjVHlwZT1yLmFyZ3MuY29kZWNUeXBlLHRoaXMub3BlbmxvZz1yLmFyZ3Mub3BlbkxvZyx0aGlzLk1QNERlbXV4ZXI9bnVsbCx0aGlzLkZNUDRSZW11eGVyPW51bGwsdGhpcy5fbmVlZEluaXRTZWdtZW50PSEwLHRoaXMuc3VwcG9ydEhldmM9ci5hcmdzLnN1cHBvcnRIZXZjO2JyZWFrO2Nhc2UidHJhbnNtdXgiOnZhciBhPWUuZGF0YS5hcmdzLG49bmV3IFVpbnQ4QXJyYXkoZS5kYXRhLmJ1ZmZlcik7dGhpcy5NUDREZW11eGVyfHwodGhpcy5NUDREZW11eGVyPW5ldyBSdChudWxsLG51bGwsbnVsbCx7b3BlbmxvZzp0aGlzLm9wZW5sb2d9KSk7dmFyIGkscz10aGlzLk1QNERlbXV4ZXIuZGVtdXhQYXJ0KG4sYS5zdGFydCxhLnZpZGVvSWR4LGEuYXVkaW9JZHgsYS5tb292LGEudXNlRU1FLGEua2lkVmFsdWUpO2lmKHRoaXMuRk1QNFJlbXV4ZXJ8fCJoMjY1Ij09PXRoaXMuY29kZWNUeXBlJiYhdGhpcy5zdXBwb3J0SGV2Y3x8KHRoaXMuRk1QNFJlbXV4ZXI9bmV3IE9lKHRoaXMuTVA0RGVtdXhlci52aWRlb1RyYWNrLHRoaXMuTVA0RGVtdXhlci5hdWRpb1RyYWNrLHtvcGVuTG9nOnRoaXMub3BlbmxvZ30pKSx0aGlzLkZNUDRSZW11eGVyKXt2YXIgbz10aGlzLkZNUDRSZW11eGVyLnJlbXV4KHRoaXMuX25lZWRJbml0U2VnbWVudCx7aW5pdE1lcmdlOiEwfSk7by5pbml0U2VnbWVudCYmKHRoaXMuX25lZWRJbml0U2VnbWVudD0hMSksaT17YnVmZmVyOkx0LmNvbmNhdERhdGEoby5hdWRpb1NlZ21lbnQsby52aWRlb1NlZ21lbnQpLHJhbmdlOmEuY29udGV4dC5yYW5nZSxzdGF0ZTphLmNvbnRleHQuc3RhdGUsY29udGV4dDp7cmFuZ2U6YS5jb250ZXh0LnJhbmdlLGZyYWdJbmRleDphLmNvbnRleHQuZnJhZ0luZGV4LHN0YXJ0UHRzOk1hdGgubWluKHMudmlkZW9UcmFjay5zdGFydFB0cyxzLmF1ZGlvVHJhY2suc3RhcnRQdHMpLGVuZFB0czpNYXRoLm1heChzLnZpZGVvVHJhY2suZW5kUHRzLHMuYXVkaW9UcmFjay5lbmRQdHMpfSxpbml0U2VnOm8uaW5pdFNlZ21lbnR9fXRoaXMucG9zdE1lc3NhZ2Uoe21ldGhvZDoidHJhbnNtdXgiLGlkOmUuZGF0YS5pZCxhcmdzOnQoe30saSl9KTticmVhaztjYXNlInJlc2V0Ijp0aGlzLkZNUDRSZW11eGVyJiZ0aGlzLkZNUDRSZW11eGVyLnJlc2V0KCksdGhpcy5NUDREZW11eGVyJiZ0aGlzLk1QNERlbXV4ZXIucmVzZXQoKSx0aGlzLkZNUDRSZW11eGVyPW51bGwsdGhpcy5NUDREZW11eGVyPW51bGwsdGhpcy5fbmVlZEluaXRTZWdtZW50PSEwfX19KCk7Cg==",Wn="undefined"!=typeof window&&window.Blob&&new Blob([atob(Ln)],{type:"text/javascript;charset=utf-8"});function Gn(){var e=Wn&&(window.URL||window.webkitURL).createObjectURL(Wn);try{return e?new Worker(e,{}):new Worker("data:application/javascript;base64,"+Ln,{type:"module"})}finally{e&&(window.URL||window.webkitURL).revokeObjectURL(e)}}var vn=function(e){v(i,e);var t=w(i);function i(e){var n;return X(this,i),(n=t.call(this)).openlog=e.openLog,n.codecType=e.codecType,n.supportHevc=e.supportHevc,n.worker=new Gn,n.worker.onmessage=function(e){n.emit(e.data.method,e.data)},n.worker.postMessage({method:"init",id:e.id||0,args:{openlog:n.openlog,supportHevc:n.supportHevc,codecType:n.codecType}}),n}return W(i,[{key:"transmux",value:function(e,t,i,n,s,a,r,l,o){var d=t.buffer;this.worker&&this.worker.postMessage({method:"transmux",id:e,buffer:d,args:{start:i,videoIdx:n,audioIdx:s,moov:a,useEME:r,kidValue:l,context:o}},[d])}},{key:"reset",value:function(){this.worker&&this.worker.postMessage({method:"reset"})}},{key:"destroy",value:function(){this.worker&&this.worker.terminate()}}]),i}(j),xn="error",Sn="metaReady",gn="moov_request_Progress",Vn="update_load_fragmentIdx",Yn=function(e){v(u,e);var t,i,n,s,a,r,l,o,d,c=w(u);function u(e,t){var i;if(X(this,u),G(R(i=c.call(this)),"onprogressDataArrive",function(){var e=f(Z().mark((function e(t,n,s){var a;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t&&t.byteLength>0&&((a=i.timeRange[s.index].range)&&s.range[1]>=a[1]&&!n&&(n=!0),i.log("[mp4.loadFragment onprogressDataArrive ] receive data, >>> index,",s.index,",range,",JSON.stringify(s.range),", dataLen,",t.byteLength),i._mux(t,s.range[0],s.index,n)),n&&(i.timeRange[s.index].downloaded=!0,i.bufferLoadedPos=-1,i.log("[FragLoadDowned],fragmentIdx,",s.index,",rangeEnd,",s.range[1]));case 2:case"end":return e.stop()}}),e)})));return function(t,i,n){return e.apply(this,arguments)}}()),i.url=e,i.options=u.getDefaultConfig(),Object.keys(t).map((function(e){void 0!==t[e]&&null!==t[e]&&(i.options[e]=t[e])})),i.timeRange=[],i.CHUNK_SIZE=i.options.chunkSize,i.bufferLoaded=new Uint8Array(0),i.bufferLoadedPos=0,i.meta=null,i.videoTrak=null,i.audioTrak=null,i.canDownload=!0,i._loadSuccessCallBack=null,i._isPending=!1,i._metaLoading=!1,i.MP4Loader=new Zn(p(p({segmentDuration:i.options.segmentDuration,url:e,vid:t.vid,retry:i.options.retryCount,retryDelay:i.options.retryDelay,timeout:i.options.timeout},t.reqOptions),{},{openLog:fn()})),i.fMP4Demuxer=null,i.MP4Demuxer=null,i.FMP4Remuxer=null,i._needInitSegment=!0,i._switchBitRate=!1,i.enableWorker=i.options.enableWorker,i.enableWorker&&"undefined"!=typeof Worker)try{i.workerSequence=0,i.transmuxerWorkerControl=new vn({id:i.workerSequence,codecType:t.codecType,supportHevc:i.options.supportHevc,openLog:fn()}),i.transmuxerWorkerControl.on("transmux",(function(e){var t=e.args;i.log("[transmuxerworker end] ,range, ",JSON.stringify(t.range),",dataLen,",t.buffer.byteLength,t.context),i._loadSuccessCallBack&&i._loadSuccessCallBack(t)}))}catch(n){i.log("Error in worker:",n),i.enableWorker=!1,i.transmuxerWorkerControl=null}return i.enableWorker||(i.MP4Demuxer=null,i.FMP4Remuxer=null),i.seekTime=-1,i.changeBitRateTime=-1,i}return W(u,[{key:"changeBitRate",value:(d=f(Z().mark((function e(t){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.url=t.url,e.next=3,this.MP4Loader.changeUrl(this.url,this.options.vid+Date.now(),this.CHUNK_SIZE);case 3:this._switchBitRate=!0,this.log("[switchBitrate] changeUrl, bitRate,",this.url);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"log",value:function(e){for(var t=this.options,i=t&&t.vid?"[MP4] ".concat(t.vid," ").concat(e):"[MP4] ".concat(e),n=arguments.length,s=new Array(n>1?n-1:0),a=1;a<n;a++)s[a-1]=arguments[a];Xn.apply(void 0,[i].concat(s))}},{key:"errorHandler",value:(o=f(Z().mark((function e(t,i){var n,s,a,r;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.response,s=t.message,a=this.options?this.options.vid:"",r=null,this._isPending=!0,n?(r=new sn("network",n.status,{httpText:n.httpText,message:s,url:n.url}),this.emit(xn,r)):(console.log("[MP4] [".concat(a,"] errorHandler,"),t),r=t,this.emit(xn,r));case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"init",value:(l=f(Z().mark((function e(){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.url){e.next=3;break}return e.next=3,this.MP4Loader.changeUrl(this.url,this.options.vid+Date.now(),this.CHUNK_SIZE);case 3:return e.next=5,this.getMetaInfo();case 5:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"getTimeRange",value:function(){for(var e=[],t=null,i=0;this.videoTrak&&i<this.videoTrak.length;i++)t={startTime:this.videoTrak[i].startTime,endTime:this.videoTrak[i].endTime,downloaded:!1,isLoading:!1},e.push(t);if(this.audioTrak&&this.audioTrak.length>e.length)for(var n=e.length;n<this.audioTrak.length;n++)t={startTime:Math.max(this.audioTrak[n].startTime,t?t.endTime:0),endTime:Math.max(this.audioTrak[n].endTime,t?t.endTime:0),downloaded:!1,isLoading:!1},e.push(t);return e}},{key:"getMetaInfo",value:(r=f(Z().mark((function e(){var t,i,n,s=this,a=arguments;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!(a.length>0&&void 0!==a[0])||a[0],e.prev=1,this._metaLoading=!0,this.log("getMetaInfo start"),this.bufferLoaded=new Uint8Array(0),i=0,n=function(){var e=f(Z().mark((function e(n,a,r){var l;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s.log("getMetaInfo onProgressHandle, dataLen,",n?n.byteLength:-1,", state,",a,",range,",JSON.stringify(r.range)),n&&r.range[0]===i&&(s.bufferLoaded=E(Uint8Array,s.bufferLoaded,new Uint8Array(n)),i+=n.byteLength),r.meta&&!s.meta&&(l=r.meta,s.videoTrak=l.videoSegments,s.audioTrak=l.audioSegments,s.timeRange=s.getTimeRange(),s.meta=p(p({},l.meta),{},{ext:{videoTrak:s.videoTrak,audioTrak:s.audioTrak}}),l.bufferLoaded=s.bufferLoaded,s.log("meta reach"),t&&s.emit(Sn,s.meta)),s.meta&&a&&(s.log("[getMetaInfo req end]"),s._metaLoading=!1),s.meta&&(n||a)&&(s.log("emit moov_req_progress"),s.emit(gn));case 5:case"end":return e.stop()}}),e)})));return function(t,i,n){return e.apply(this,arguments)}}(),e.next=9,this.MP4Loader.loadMetaProcess(this.MP4Loader.cache,[0,this.CHUNK_SIZE],n);case 9:e.next=15;break;case 11:e.prev=11,e.t0=e.catch(1),console.error("[MP4] trigger errorHandler getMetaInfo",null===e.t0||void 0===e.t0?void 0:e.t0.message),this.loadError(e.t0,"getMetaInfo");case 15:case"end":return e.stop()}}),e,this,[[1,11]])}))),function(){return r.apply(this,arguments)})},{key:"getFragmentIdx",value:function(e){var t,i;if(this.videoTrak.length){if(t=this.videoTrak.find((function(t){return t.startTime<=e&&t.endTime>e})),i=this.audioTrak.find((function(t){return t.startTime<=e&&t.endTime>e})),t&&i)return Math.min(t.index,i.index);if(t||i)return t?t.index:i.index;var n=Number.MAX_VALUE;return this.videoTrak&&this.videoTrak.length>0&&(n=this.videoTrak.length-1),this.audioTrak&&this.audioTrak.length>0&&(n=Math.min(this.audioTrak.length-1,n)),n}return(i=this.audioTrak.find((function(t){return t.startTime<=e&&t.endTime>e})))?i.index:0}},{key:"_checkHasMeta",value:(a=f(Z().mark((function e(){var t;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.log(" loadMeta start"),this._metaLoading=!0,e.next=4,this.MP4Loader.loadMeta(this.MP4Loader.cache,Math.round(this.CHUNK_SIZE/2));case 4:return t=e.sent,this._metaLoading=!1,this.videoTrak=t.videoSegments,this.audioTrak=t.audioSegments,this.meta=p(p({},t.meta),{},{ext:{videoTrak:this.videoTrak,audioTrak:this.audioTrak}}),this.timeRange=this.getTimeRange(),this.bufferLoaded=new Uint8Array(0),t.bufferLoaded=this.bufferLoaded,e.abrupt("return",!0);case 13:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"resetFragmentLoadState",value:function(e){for(var t=0;t<this.timeRange.length;t++)t<e?(this.timeRange[t].downloaded=!0,this.timeRange[t].isLoading=!0):(this.timeRange[t].downloaded=!1,this.timeRange[t].isLoading=!1)}},{key:"getFragRange",value:function(e){var t,i,n,s,a=null;this.videoTrak&&(a=e<this.videoTrak.length?this.videoTrak[e]:this.videoTrak[this.videoTrak.length-1]);var r=null;this.audioTrak&&(r=e<this.audioTrak.length?this.audioTrak[e]:this.audioTrak[this.audioTrak.length-1]);var l=0,o=0;this.videoTrak&&e>=this.videoTrak.length-1&&(l=-1),this.audioTrak&&e>=this.audioTrak.length-1&&(o=-1);var d=[Math.min((null===(t=a)||void 0===t?void 0:t.range[0])||1/0,(null===(i=r)||void 0===i?void 0:i.range[0])||1/0),Math.max((null===(n=a)||void 0===n?void 0:n.range[1])+l||0,(null===(s=r)||void 0===s?void 0:s.range[1])+o||0)];return e<this.timeRange.length&&(this.timeRange[e].range=d),d}},{key:"load",value:(s=f(Z().mark((function e(t,i){var n,s,a;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._loadSuccessCallBack=i,!this._switchBitRate||this._metaLoading){e.next=12;break}return this.log("[switchBitrate], switch bitRate start load, time,",t>=this.videoTrak.length?this.audioTrak[t].startTime:this.videoTrak[t].startTime,", fragIndex,",t),e.next=5,this._checkHasMeta();case 5:n=e.sent,this.changeBitRateTime>0&&(this.timeRange[t].startTime<=this.changeBitRateTime&&this.changeBitRateTime<this.timeRange[t].endTime?this.log("[switchBitrate], not need update load fragIndex",t,",stTime,",this.changeBitRateTime):(t=this.getFragmentIdx(this.changeBitRateTime),this.log("[switchBitrate], need update load fragIndex",t,",stTime,",this.changeBitRateTime,",newBitrateTimeRange,",this.timeRange[t].startTime,"-",this.timeRange[t].endTime),this.emit(Vn,t)),this.seekTime=this.changeBitRateTime,this.changeBitRateTime=-1),this.resetFragmentLoadState(t),this.log("[switchBitrate], reset timerange state,",t),this._needInitSegment=!0,this.resetTansmuxer(),n&&(this._switchBitRate=!1);case 12:if(!this._switchBitRate||!this._metaLoading){e.next=14;break}return e.abrupt("return");case 14:s=this.getFragRange(t),this.log("loadFragment,",t,",range,",JSON.stringify(s)),this.seekTime>0?(a=this.getSubRange(t,this.seekTime,s),this.loadFragment(t,a),this.seekTime=-1):this.loadFragment(t,s);case 17:case"end":return e.stop()}}),e,this)}))),function(e,t){return s.apply(this,arguments)})},{key:"getSubRange",value:function(e,t,i){var n=i[0],s=i[0],a=1,r=!1;if(this.log(">>>>>getSubRange time,",t,JSON.stringify(i)),this.videoTrak){var l=e<this.videoTrak.length?this.videoTrak[e]:this.videoTrak[this.videoTrak.length-1];if(0===l.frames.length)return this.log(">>>>>getSubRange video, no frames"),i;var o=l.frames.filter(kn),d=this.meta.videoTimescale,c=o[0].startTime/d;this.log(">>>>>getSubRange video, startTime,",l.startTime,",endTime,",l.endTime);for(var u=0;u<o.length;u++)this.log(">>>>>getSubRange video keyFrameList, startTime,",o[u].startTime/d,",range,",o[u].offset);for(;a<o.length;a++){var m=o[a].startTime/d;if(c<=t&&t<m&&i[0]<o[a-1].offset){n=o[a-1].offset,r=!0,this.log(">>>>>getSubRange video end, startTime,",c,",endTime,",m,",startRange,",n,", keyFrameIndex,",a-1);break}c=m}!r&&c<=t&&t<l.endTime+.8&&(n=o[a-1].offset,this.log(">>>>>getSubRange video last, startTime,",c,",endTime,",l.endTime,",startRange,",n))}if(a=1,this.audioTrak){var h=e<this.audioTrak.length?this.audioTrak[e]:this.audioTrak[this.audioTrak.length-1];if(0===h.frames.length)return this.log(">>>>>getSubRange video, no frames"),i;var p=h.frames,Z=this.meta.audioTimescale;a=Math.floor((t*Z-p[0].startTime)/h.frames[0].duration);for(var y=(a=Math.min(p.length-1,a))>0?p[a-1].startTime/Z:p[0].startTime/Z;a>=0&&a<p.length;)if(a>0&&y>t)y=p[a-=1].startTime/Z;else{var b=(p[a].startTime+p[a].duration)/Z;if(y<=t&&t<b&&i[0]<p[a].offset){s=p[a].offset,r=!0,this.log(">>>>>getSubRange audio end, startTime,",y,",endTime,",b,",startRange,",s,", index,",a);break}y=b,a++}}var f=[Math.min(s,n),i[1]];return this.log(">>>>>getSubRange finalRange ",JSON.stringify(f),",oldRange,",JSON.stringify(i)),f}},{key:"_mux",value:function(e,t,i,n){var s=this.getSamplesRange(i,"video"),a=this.getSamplesRange(i,"audio"),r=[t,t+e.byteLength];if(this.transmuxerWorkerControl&&!this.meta.isFragmentMP4){var l={range:r,state:n,fragIndex:i};this.log("[transmuxerworker start] ,range, ",JSON.stringify(r),",dataLen,",e.byteLength,l),this.transmuxerWorkerControl.transmux(this.workerSequence,e,t,s,a,this.meta.moov,this.useEME,this.kidValue,l)}else try{var o,d;this.meta.isFragmentMP4?(this.fMP4Demuxer||(this.fMP4Demuxer=new nt),o=this.fMP4Demuxer.demuxPart(e,t,this.meta.moov)):(this.MP4Demuxer||(this.MP4Demuxer=new ui(this.videoTrak,this.audioTrak,null,{openLog:fn()})),o=this.MP4Demuxer.demuxPart(e,t,s,a,this.meta.moov,this.useEME,this.kidValue)),this.FMP4Remuxer||this.checkCodecH265()&&!this.options.supportHevc||(this.FMP4Remuxer=new dt(o.videoTrack,o.audioTrack,{openLog:fn()})),this.log("[mux], videoTimeRange,",o.videoTrack?[o.videoTrack.startPts,o.videoTrack.endPts]:null,",audioTimeRange,",o.audioTrack?[o.audioTrack.startPts,o.audioTrack.endPts]:null);var c=[Math.min(o.videoTrack.startPts,o.audioTrack.startPts),Math.max(o.videoTrack.endPts,o.audioTrack.endPts)];if(this.FMP4Remuxer){var u=this.FMP4Remuxer.remux(this._needInitSegment,{initMerge:!0,range:r});u.initSegment&&(this._needInitSegment=!1),d={buffer:rn.concatData(u.audioSegment,u.videoSegment),range:r,state:n,context:{range:r,fragIndex:i,timeRange:c},initSeg:u.initSegment}}else d={videoTrack:o.videoTrack,audioTrack:o.audioTrack,buffer:null,range:r,state:n,context:{range:r,fragIndex:i,timeRange:c}};this._loadSuccessCallBack&&this._loadSuccessCallBack(d)}catch(h){console.error("mux err:",h);var m=new an(nn.remux,tn.muxError,{msg:JSON.stringify(h)});this.errorHandler(m,"mux",{fragIndex:i,range:[t,t+e.byteLength]})}}},{key:"getSamplesRange",value:function(e,t){var i=[];switch(t){case"video":if(this.videoTrak&&e<this.videoTrak.length){var n=this.videoTrak[e].frames;if(!n.length)break;i.push(n[0].index),i.push(n[n.length-1].index)}break;case"audio":if(this.audioTrak&&e<this.audioTrak.length){var s=this.audioTrak[e].frames;if(!s.length)break;i.push(s[0].index),i.push(s[s.length-1].index)}break;default:console.warn("[getSamplesRange] type ",t," is invalid")}return i}},{key:"loadFragment",value:(n=f(Z().mark((function e(t,i){var n,s,a,r;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this._isPending||i.length>0&&0===i[0]&&0===i[1]||this.timeRange[t].isLoading)){e.next=2;break}return e.abrupt("return");case 2:if(this.log("[MP4.loadFragment] ,fragIndex,",t,",range ",i,",len ,",i[1]-i[0],", bufferLoaded_Len,",this.bufferLoaded.byteLength),!(i.length>=2&&i[1]&&i[1]>0&&i[1]<=this.bufferLoaded.byteLength)){e.next=13;break}this.timeRange[t].isLoading=!0,n=Math.max(i[0],this.bufferLoadedPos),s=new Uint8Array(this.bufferLoaded.slice(n,i[1])),this.log("[mp4.loadFragment] has all data: ",n,i[1]),this.timeRange[t].downloaded=!0,this.bufferLoadedPos=-1,this._mux(s,n,t,!0),e.next=34;break;case 13:if(!(i.length>=2&&i[0]&&i[0]<=this.bufferLoaded.byteLength)){e.next=29;break}if(this.timeRange[t].isLoading){e.next=27;break}if(a=Math.max(i[0],this.bufferLoadedPos),!((r=new Uint8Array(this.bufferLoaded.slice(a,i[1]))).byteLength>0)){e.next=22;break}return this.bufferLoadedPos=a+r.byteLength,this.log("[mp4.loadFragment] has part data: ",a,a+r.byteLength),this._mux(r,a,t,i[1]<=this.bufferLoadedPos),e.abrupt("return");case 22:if(this._metaLoading||this.timeRange[t].isLoading){e.next=27;break}return this.log("[mp4.loadFragment] ready to load part data >>> ",this.bufferLoaded.byteLength,i[1]),this.timeRange[t].isLoading=!0,e.next=27,this.startLoad([this.bufferLoaded.byteLength,i[1]],t);case 27:e.next=34;break;case 29:if(this._metaLoading&&!(i[0]>=this.CHUNK_SIZE)||this.timeRange[t].isLoading){e.next=34;break}return this.timeRange[t].isLoading=!0,this.log("[mp4.loadFragment],ready to load all data ,segmentIdx, ",t,",range >>> ",JSON.stringify(i)),e.next=34,this.startLoad(i,t);case 34:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"startLoad",value:(i=f(Z().mark((function e(t,i){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.MP4Loader.loadData(t,this.MP4Loader.cache,{index:i,onProgress:this.onprogressDataArrive,onProcessMinLen:this.options.onProcessMinLen});case 3:e.next=9;break;case 5:e.prev=5,e.t0=e.catch(0),console.error("[MP4] trigger errorHandler getMetaInfo",null===e.t0||void 0===e.t0?void 0:e.t0.message),this.loadError(e.t0,"loadFragment",{range:t,fragIndex:i});case 9:case"end":return e.stop()}}),e,this,[[0,5]])}))),function(e,t){return i.apply(this,arguments)})},{key:"loadError",value:function(e,t,i){var n;!e.response&&(e.response={}),e.isTimeout?e.response.status="timeout":null!=e&&null!==(n=e.response)&&void 0!==n&&n.status||(e.response.status="networkError"),this.errorHandler(e,t,i)}},{key:"cancelLoading",value:(t=f(Z().mark((function e(){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.MP4Loader;case 2:if(e.t0=e.sent,!e.t0){e.next=5;break}this.MP4Loader.cancel();case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"update",value:function(e){this.url=e}},{key:"checkCodecH265",value:function(){return this.meta&&(this.meta.videoCodec.indexOf("hvc1")>-1||this.meta.videoCodec.indexOf("hev1")>-1)}},{key:"destroy",value:function(){this.hasDestroyed||(this.resetTansmuxer(),this.transmuxerWorkerControl&&this.transmuxerWorkerControl.destroy(),this._isPending=!1,this._metaLoading=!1,this.bufferLoadedPos=0,this.bufferLoaded=new Uint8Array(0),this.MP4Loader&&(this.MP4Loader.cancel(),this.MP4Loader.destroy()),this.hasDestroyed=!0)}},{key:"resetTansmuxer",value:function(){this.MP4Demuxer&&this.MP4Demuxer.reset(),this.MP4Demuxer=null,this.FMP4Remuxer&&this.FMP4Remuxer.reset(),this.FMP4Remuxer=null,this.transmuxerWorkerControl&&this.transmuxerWorkerControl.reset()}}],[{key:"getDefaultConfig",value:function(){return{segmentDuration:5,onProcessMinLen:1024,chunkSize:8e5,retryCount:3,retryDelay:1e3,timeout:3e3,enableWorker:!1,playerId:"",vid:"",ext:{}}}}]),u}(j);function kn(e){if(e.keyframe)return e}var Rn=function(){function e(t){X(this,e),this.onTick_=t,this.cancelPending_=null}return W(e,[{key:"tickAfter",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.stop();var n=!0,s=null;this.cancelPending_=function(){window.clearTimeout(s),n=!1};var a=function(){n&&(t.onTick_(),i&&i())};return s=window.setTimeout(a,1e3*e),this}},{key:"tickEvery",value:function(e){var t=this;this.tickAfter(e,(function(){t.tickEvery(e)}))}},{key:"stop",value:function(){this.cancelPending_&&(this.cancelPending_(),this.cancelPending_=null)}}]),e}(),Tn=function(){function e(){var t,i;X(this,e);var n=new Promise((function(e,n){t=e,i=n}));return n.resolve=function(e){t(e),n.state="fulfilled"},n.reject=function(e){i(e),n.state="rejected",n.isBreak="DESTROYED"===e},n.state="pending",n}return W(e,[{key:"resolve",value:function(e){}},{key:"reject",value:function(e){}}]),e}(),wn=null,Mn=null,Kn=null,In=null,Hn=function(e){v(a,e);var t,i,n,s=w(a);function a(e){var t;return X(this,a),G(R(t=s.call(this,e)),"_onMp4DataCallBack",(function(){t._isMseInit&&t._onTimeUpdate()})),G(R(t),"_onMp4MetaReady",(function(e){var i=R(t).config,n=t.mp4.checkCodecH265();try{if(n&&!t.config.supportHevc){var s="browser not support HEVC",a=new m.Errors(t.player,{errorType:"runtime",errorTypeCode:nn.runtime,errorCode:tn.h265Error,errorMessage:s,vid:i.vid,mediaError:{code:tn.h265Error,message:s}});t._errorHandler(a)}else t._initMse(e),t._initPromise.resolve()}catch(l){var r=new m.Errors(t.player,{errorType:"runtime",errorTypeCode:nn.runtime,errorCode:tn.mse,errorMessage:null==l?void 0:l.message,vid:i.vid,mediaError:{code:tn.other1,message:null==l?void 0:l.message}});return void t._errorHandler(r)}t._loadData()})),G(R(t),"_onMp4Error",(function(e){var i=t.playerConfig.vid;console.error("[Index] _onMp4Error",i,e),t._errorHandler(e)})),G(R(t),"_loadDataSuccess",(function(e){if(!t.isDestroy&&t.mse){t.log("[loadFragment] _loadDataSuccess ",JSON.stringify(e.context.range),",dataLen,",e.buffer?e.buffer.byteLength:0,e.state);try{e.initSeg&&(t._appendInitSeg(e.initSeg),(!e.buffer||e.buffer.byteLength<1)&&(t.log("no data, must load data"),t._onTimeUpdate()));var i=e.buffer,n=e.state,s=e.context;if(t.mse&&n&&(!i||i.byteLength<=0)&&s.fragIndex===t.mp4.timeRange.length-1){var a=t.player.buffered;a&&a.length>0&&(t.bufferEndTime=a.end(a.length-1)),t._isEnded(),t.log("loaded ended !!!==>>>",JSON.stringify(s.range),", fragIndex,",s.fragIndex,", bufferEndTime,",t.bufferEndTime,",meta_duration,",t.mp4.meta.duration)}if(t.mse&&n&&s.fragIndex===t.mp4.timeRange.length-1&&(!i||i.byteLength<=0)){var r=t.player.buffered;r&&r.length>0&&(t.bufferEndTime=r.end(r.length-1)),t._isEnded(),t.log("load ended !!!==>>>",t.playerConfig.vid,JSON.stringify(s.range),", fragIndex,",s.fragIndex,", bufferEndTime,",t.bufferEndTime,",meta_duration,",t.mp4.meta.duration)}i&&t.mse&&i&&i.byteLength>0&&t._appendBuffer(wi.VIDEO,i,s,n)}catch(o){t.log("appendBuffer error",o);var l=new m.Errors(t.player,{errorType:"runtime",errorTypeCode:nn.runtime,errorCode:tn.mse,vid:t.player.config.vid,errorMessage:o.message,mediaError:{code:tn.mse,message:o.message}});t._errorHandler(l)}null!=e&&e.state&&t._onTimeUpdate()}})),G(R(t),"_onWaiting",(function(){var e=R(t),i=e.player,n=e.config;clearTimeout(t._waitInBufferTimer),t._waitInBufferTimer=null;var s=i.currentTime,a=i.bufferedPoint;a.end>0&&a.end-i.currentTime>=2&&t._waitAdjustTimeCnt<n.waitJampBufferMaxCnt&&(t._waitInBufferTimer=setTimeout((function(){t._waitAdjustTimeCnt++,i.currentTime=i.currentTime+.5,t.log("[waitInBufferTimeout], waitAdjustTimeCnt,",t._waitAdjustTimeCnt,",curtime,",s,rn.nowTime())}),n.waitingInBufferTimeOut))})),G(R(t),"_onSeeking",f(Z().mark((function e(){var i,n,s,a,r,l,o,d,c,u,m;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=R(t),n=i.player,s=i.mp4,a=n.currentTime,t.log("[seekTime], curTime,",a,",buffer,",n.buffered2.bufferedList),s&&s.meta){e.next=5;break}return e.abrupt("return");case 5:if(t.endofstream=!1,s.bufferLoadedPos=-1,s._metaLoading=!1,r=n.bufferedPoint,l=!1,o=0,!(r.end>0)){e.next=25;break}if(l=!0,!(s.meta.duration-r.end<.5)){e.next=17;break}return t._startProgress(),t.log("[seeking in buffered range], buffer end,",r.end,", duration,",s.meta.duration),e.abrupt("return");case 17:if(o=s.getFragmentIdx(r.end),t._curLoadSegmentIdx!==o){e.next=22;break}return t._startProgress(),t.log("[seeking in buffered range], seek fragIndex is current load segmentIdx",o),e.abrupt("return");case 22:s.seekTime=r.end,o<0&&(o=t._curLoadSegmentIdx),t.log("[seeking in buffered range], seekTime ",a,",bufferRange,",r.start,"-",r.end,", fragIndex,",o);case 25:return l||(s.seekTime=a,(o=s.getFragmentIdx(a))<0&&(o=t._curLoadSegmentIdx),t.log("[seekTime out buffer range], curTime,",a,", Idx,",o),d=R(t),(c=d.mse)&&c.isFull()&&(u=n.buffered2.bufferedList,m=u[u.length-1],c.clearOpQueues(wi.VIDEO),t._checkRemoveSourceBuffer([m.start,m.end],n.currentTime,!0,!0))),e.next=28,s.cancelLoading();case 28:s.resetFragmentLoadState(o),t._curLoadSegmentIdx=o,t._onTimeUpdate(),t._startProgress(),t._isEnded();case 33:case"end":return e.stop()}}),e)})))),G(R(t),"changeDefineCanPlay",(function(e,i,n,s){var a=R(t).player;a.ended?a.currentTime=0:(t.log("[oldChangeDefinition],this._changeDefState,",t._changeDefState),a.currentTime=t._changeDefState?t._changeDefState.currentTime:e,(t._changeDefState?t._changeDefState.paused:i)?a.pause():a.play(),t._changeDefState=null,a.emit(m.Events.AFTER_DEFINITION_CHANGE,{from:n,to:s}))})),G(R(t),"changeDefinition",function(){var e=f(Z().mark((function e(i,n){var s,a,r,l,o,d,c;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=R(t),a=s.player,r=s.config,l=s.mp4,n||(n=a.curDefinition),t._MSEError=!1,!r.witchBitRateWay){e.next=6;break}return t.oldChangeDefinition(i,n),e.abrupt("return");case 6:if(a.emit(m.Events.DEFINITION_CHANGE,{from:n,to:i}),o=a.currentTime,(d=l.getFragmentIdx(o))<0&&(d=t._curLoadSegmentIdx),t.log("switchBitrate:point,fragIndex,",d,",startTime,",l.timeRange[d].startTime,",currentTime,",a.currentTime),!l){e.next=16;break}return t.mp4.changeBitRateTime=o,e.next=15,l.cancelLoading();case 15:l._metaLoading&&(l._metaLoading=!1);case 16:return t._removeBuffeEndTime=l.timeRange[d].startTime,t._isChangeDefinition=!0,(c=a.getBufferedRange(a.buffered))[1]>0&&c[1]-a.currentTime>5&&(t.mse.clearOpQueues(wi.VIDEO),t.mse.remove(wi.VIDEO,a.currentTime+5,c[1])),t.log("switchBitrate: resetFragmentLoadState,",d),l.resetFragmentLoadState(d),t._curLoadSegmentIdx=d,e.next=25,t.mp4.changeBitRate(i);case 25:t._onTimeUpdate(),a.emit("RESOLUTION_UPDATE",i);case 27:case"end":return e.stop()}}),e)})));return function(t,i){return e.apply(this,arguments)}}()),G(R(t),"_replayHook",(function(){var e;return null===(e=t.player)||void 0===e||e.play(),!1})),G(R(t),"_retryHook",(function(){return t.beforePlayerInit(),!1})),t.mp4=null,t.mse=null,t._waitAdjustTimeCnt=0,t._lastCheckTime=rn.nowTime(),t._removeBuffeEndTime=0,t._pendingPromises=[],t}return W(a,[{key:"afterCreate",value:function(){var e=this;window.__mp4player=this;try{m.BasePlugin.defineGetterOrSetter(this.player,{__url:{get:function(){try{return e.mse?e.mse.url:e.config.url}catch(t){return null}}}})}catch(t){}this._proxyPlayer()}},{key:"attachEvents",value:function(){this.off(m.Events.SEEKING,this._onSeeking),this.on(m.Events.SEEKING,this._onSeeking),this.on(m.Events.WAITING,this._onWaiting),this.off(m.Events.URL_CHANGE,this.switchURL),this.on(m.Events.URL_CHANGE,this.switchURL)}},{key:"detachEvents",value:function(){this.off(m.Events.SEEKING,this._onSeeking),this.off(m.Events.WAITING,this._onWaiting),this.off(m.Events.URL_CHANGE,this.switchURL)}},{key:"_proxyPlayer",value:function(){var e=this;"function"==typeof this.player.playNext&&(wn=this.player.playNext),this.player.playNext=function(){e.playNext.apply(e,arguments)},Mn=this.player._startInit,In=this.player.switchURL,Kn=this.player.changeDefinition,this.player._startInit=this._playerStartInit.bind(this),this.player.switchURL=this.switchURL.bind(this),this.player.changeDefinition=this.changeDefinition.bind(this),this.player.removeHooks("replay",this._replayHook),this.player.removeHooks("retry",this._retryHook)}},{key:"_playerStartInit",value:function(e){var t=this,i=this.config,n=this.playerConfig;void 0===i.supportHevc&&null!==m.Sniffer&&void 0!==m.Sniffer&&m.Sniffer.isHevcSupported&&m.Sniffer.isHevcSupported()&&(i.supportHevc=!0);var s=this.initMp4();this._initPromise=s,this._addPendingPromise(this._initPromise),this.mse&&"String"===m.Util.typeOf(e)&&/^blob/.test(e)&&e!==this.mse.url&&(e=n.url),s.then((function(){t.mse&&(e=t.mse.url),t.attachEvents(),t._startProgress()})).catch((function(i){var n=!!t._initPromise&&t._initPromise.isBreak;if(!t.isDestroy&&!n){var s=i;s.errorCode||((s=new m.Errors(t.player,{errorType:nn.RUNTIME,errorCode:(null==i?void 0:i.errorCode)||tn.other,vid:t.playerConfig.vid,errorMessage:(null==i?void 0:i.errorMessage)||(null==i?void 0:i.message),mediaError:{code:(null==i?void 0:i.httpCode)||tn.other,message:(null==i?void 0:i.errorMessage)||(null==i?void 0:i.message),errorType:null==i?void 0:i.errorType}})).url=e),t.useVideoLoad=!0,t.player.vtype="MP4_1",t.player.emit("playCatch",t.player.vtype,s)}})).finally((function(){if(t._initPromise){var i=t._initPromise.isBreak;i||(t._initPromise&&t._removePendingPromise(t._initPromise),t._initPromise=null,!t.isDestroy&&!i&&Mn.call(t.player,e))}}))}},{key:"initMp4",value:function(){var e=this,t=this.player;t.config.vid||(t.config.vid=Date.now());var i=new Tn;return this.mp4&&(this.mp4.off(Sn,this._onMp4MetaReady),this.mp4.off(xn,this._onMp4Error),this.mp4.off(gn,this._onMp4DataCallBack),this.mp4.destroy(),this.mp4=null),this.mp4=new Yn(t.config.url,p(p({},this.config),{},{vid:t.config.vid})),this.mp4.on(Sn,this._onMp4MetaReady),this.mp4.on(xn,this._onMp4Error),this.mp4.on(gn,this._onMp4DataCallBack),this.mp4.on(Vn,(function(t){e._curLoadSegmentIdx=t,e.log("[update curLoadSegmentIdx]",t)})),this.mp4.init(),i}},{key:"setConfig",value:function(e){this.config=Object.assign(this.config,e)}},{key:"playNext",value:function(e){var t=this.player;this._defInited=!1,t.resetState(),t._currentTime=0,t._duration=0,t.isPlaying=!1,this._MSEError=!1,t.pause(),this._reset(),t.setConfig(e),this.log("[Index] playNext",e),t.play(),this.emit("playnext")}},{key:"checkDegrade",value:function(e){return!this.config.closeDowngrade||"networkError"===e.httpCode}},{key:"_errorHandler",value:function(e){var t,i=this.player,n=this.config;if(i&&!this.useVideoLoad){!e.url&&null!==(t=this.mp4)&&void 0!==t&&t.url&&(e.url=this.mp4.url);var s=i.paused;if(console.error("final error !!!!, ",n.vid,e),this.player.vtype="MP4_2",this.player.emit("playCatch",this.player.vtype,e),this.checkDegrade(e))this._initPromise?this._removeAndRejectInitPromise(e):this._startDegradedPlayback(e,s);else{this.player.pause(),this._reset();var a=i.currentTime;this.destroyMSE(),i.currentTime=a,this.emit("error",e)}}}},{key:"_startDegradedPlayback",value:function(e,t){var i=this;console.log(">>>_startDegradedPlayback");var n=this.player,s=this.playerConfig;this.useVideoLoad=!0,this.destroyMSE(),this._currentTime=n.currentTime,this.__onmetadataHandle=function(){i._currentTime&&(n.currentTime=i._currentTime),t?i.player.pause():i.player.play(),n.media.removeEventListener("loadedmetadata",i.__onmetadataHandle),i.__onmetadataHandle=null},n.media.addEventListener("loadedmetadata",this.__onmetadataHandle);var a=s.url;n.media.src=a}},{key:"_addPendingPromise",value:function(e){this._pendingPromises.push(e)}},{key:"_removePendingPromise",value:function(e){var t=this._pendingPromises.indexOf(e);t>-1&&this._pendingPromises.splice(t,1)}},{key:"_cancelPendingPromises",value:function(){this._pendingPromises.length>0&&this._pendingPromises.forEach((function(e){e.reject("DESTROYED")})),this._pendingPromises=[]}},{key:"_removeAndRejectInitPromise",value:function(e){this._initPromise&&(this._removePendingPromise(this._initPromise),this._initPromise.reject(e))}},{key:"_initMse",value:(n=f(Z().mark((function e(t){var i,n,s,a,r=this;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.mse){e.next=4;break}return e.next=3,this.mse.unbindMedia();case 3:this.mse=null;case 4:i=!!t.videoCodec,n=!!t.audioCodec,s=i&&n?'video/mp4; codecs="'.concat(t.videoCodec,', mp4a.40.5"'):i?'video/mp4; codecs="'.concat(t.videoCodec,'"'):'video/mp4; codecs="mp4a.40.5"',a=G({},wi.VIDEO,{mimeType:"video/mp4",codec:s}),this.mse=new wi,this.mse.bindMedia(this.player.video).then((function(){var e=Object.keys(a);try{for(var t=0;t<e.length;t++){var i=e[t];r.mse.createSource(i,a[i].codec)}}catch(n){console.error("MSE error: ",n),r._errorHandler(n)}r._isMseInit=!0,r._onTimeUpdate()}));case 11:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"destroyMSE",value:(i=f(Z().mark((function e(){var t;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(t=this.mse)||void 0===t?void 0:t.unbindMedia();case 2:this.mse=null;case 3:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"_onTimeUpdate",value:function(){var e=this,t=this.mse,i=this.mp4,n=this.player,s=this.config;if(i){var a=i.timeRange,r=n.getBufferedRange(n.buffered2);if(t&&i&&i.canDownload){rn.nowTime()-this._lastCheckTime>1e3&&(this._lastCheckTime=rn.nowTime(),this._loadStuckCheck(),this._checkRemoveSourceBuffer(r,n.currentTime));var l=n.paused?n.currentTime+s.minBufferLength:n.currentTime+s.maxBufferLength;r[1]-l<0&&a.every((function(t,i){return!!t.downloaded||(!e._isChangeDefinition&&t.endTime-t.startTime>1&&e._isInBuffer(t)?(t.downloaded=!0,t.isLoading=!0,e.log("onTimeUpdate, ".concat(i," download segment, has buffer"),t.startTime,t.endTime),!0):void(t.startTime-n.currentTime<s.maxBufferLength&&(e._curLoadSegmentIdx=i,e.log("[onTimeUpdate],load index==>>>, ",i,",IdxTimeRange, ",t.startTime,"-",t.endTime,",buffEnd, ",r[1],",playCurTime,",n.currentTime,", bufferLen,",r[1]-n.currentTime,",bufferRangeList,",e.player.buffered2?e.player.buffered2.bufferedList:null),e._loadData())))})),this._isEnded()}this.checkRemoveOldBitrateBuffer()}}},{key:"checkRemoveOldBitrateBuffer",value:function(){var e=this.mse,t=this.player;e&&this._removeBuffeEndTime>0&&t.currentTime>this._removeBuffeEndTime+1&&(this.log("remove old bitrate buffer",this._removeBuffeEndTime),e.remove(wi.VIDEO,0,this._removeBuffeEndTime-1),this._removeBuffeEndTime=0)}},{key:"_isInBuffer",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=!1,n=this.player.video.buffered,s=0;s<n.length;s++){var a=n.start(s)-t,r=n.end(s)+t;if(a<=e.startTime&&e.endTime<=r){i=!0;break}}return i}},{key:"_loadData",value:(t=f(Z().mark((function e(){return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.mp4&&this._isMseInit){e.next=3;break}return this.log("loadData, player.mp4 null",this._isMseInit),e.abrupt("return");case 3:return e.prev=3,e.next=6,this.mp4.load(this._curLoadSegmentIdx,this._loadDataSuccess);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(3),console.error("[Index] _loadData error",this.playerConfig.vid,e.t0);case 11:case"end":return e.stop()}}),e,this,[[3,8]])}))),function(){return t.apply(this,arguments)})},{key:"_appendInitSeg",value:function(e){var t=this;this.mp4&&this.mse&&this.mse.append(wi.VIDEO,e,{vid:this.playerConfig.vid,range:null,dataLen:e.byteLength,isinit:!0}).then((function(e){t.log("appendInitSeg end ==>>>",e.context?e.context:null,", costTime,",e.costtime)}))}},{key:"_appendBuffer",value:function(e,t){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3?arguments[3]:void 0,a=this.mse,r=this.config;a.append(e,t,{vid:r.vid,fragIndex:n.fragIndex,range:n.range,dataLen:t.byteLength,state:s}).then((function(e){if(i.log("player appendBuffer end ==>>>",e.context?e.context:null,", costTime,",e.costtime,", opt,",e.name,",bufferRange,",i.player.getBufferedRange()),i.mse&&n.state&&n.fragIndex===i.mp4.timeRange.length-1){var t=i.player.buffered;t&&t.length>0&&(i.bufferEndTime=t.end(t.length-1)),i._isEnded(),i.log("loaded ended !!!==>>>",n.range,", fragIndex,",n.fragIndex,", bufferEndTime,",i.bufferEndTime,",meta_duration,",i.mp4.meta.duration)}})).catch((function(e){if(console.log("[MSE error]",e),e&&null!=a&&a.isFull()){var t=i.player.getBufferedRange(i.player.buffered2);i._checkRemoveSourceBuffer(t,i.player.currentTime,!0)}}))}},{key:"_checkRemoveSourceBuffer",value:function(e,t,i){var n=this,s=this.mse,a=this.mp4,r=this.player;if(s&&a&&r&&(i&&(clearTimeout(this._removeBufferTimer),this._removeBufferTimer=null),e||(e=r.getBufferedRange(r.buffered2)),t||(t=r.currentTime),!(!i&&rn.nowTime()-this._checkRemoveBufferLastTime<=this.config.removeBufferLen||this.endofstream)&&(this._checkRemoveBufferLastTime=rn.nowTime(),e&&e[0]>=0&&(t-e[0]>this.config.removeBufferLen||s.isFull())))){var l=e[1],o=a.getFragmentIdx(l);if(o>=0&&a.timeRange[o].startTime<t){var d=Math.floor(Math.min(a.timeRange[o].startTime,e[1]));e[0]<d?(this.log("[checkremoveSourceBuffer], remove range==>>>",e[0],d),s.remove(wi.VIDEO,e[0],d)):s.isFull()&&!this._removeBufferTimer&&(this._removeBufferTimer=setTimeout((function(){n._checkRemoveSourceBuffer(null,null,!0)}),1e4))}}}},{key:"_isEnded",value:function(){var e=this.player,t=this.mp4,i=e.bufferedPoint,n=i?i.end:0;return!this.endofstream&&this.mse&&t.meta.duration-e.currentTime<.5&&(this.log("[check player isEnded],deal mse.endOfStream, currentTime,",e.currentTime,", bufferend,",n,", duration,",t.meta.duration),this.endofstream=!0,this.mse.endOfStream()),!!(t&&t.meta&&t.meta.duration-e.currentTime<.5)&&(this._stopProgress(),this.log("[check player isEnded],stopProgress and endOfStream,currentTime, ",e.currentTime,", bufferend,",n,", duration,",t.meta.duration),this.mse&&this.mse.endOfStream(),!0)}},{key:"switchURL",value:function(e){this.changeDefinition(e)}},{key:"oldChangeDefinition",value:function(e,t){var i=this,n=this.config,s=this.player;this.log("[oldChangeDefinition],currentTime,",s.currentTime,",from,",t,",to,",e);var a=s.currentTime,r=s.paused;this._changeDefState||(this._changeDefState={currentTime:a,paused:r},this.log("[oldChangeDefinition],currentTime,",s.currentTime,",pause,",r)),s.config.url=e.url,n.focusUserDefinition=!0,s.currentTime=0,s.pause(),this._reset(),this._isMseInit=!1,this._changeDefineCanPlay&&s.off("canplay",this._changeDefineCanPlay),this._changeDefineCanPlay=function(){i.changeDefineCanPlay(a,r,t,e),i._changeDefineCanPlay=null},s.once("canplay",this._changeDefineCanPlay),this.player.video.load(),this.initMp4()}},{key:"_loadStuckCheck",value:function(){var e=this,t=this.config,i=this.player;t.disableBufferBreakCheck||(i.currentTime-(this._lastCurrentTime||0)>.1||i.paused?1!==this._bufferBreakFlag&&2!==this._bufferBreakFlag||(this.log("视频没有卡死,重置卡死标记"),this._bufferBreakFlag=0,clearTimeout(this._bufferBreakTimer),this._bufferBreakFlag=null):this._bufferBreakFlag||(this._bufferBreakFlag=1,this.log("卡死计时开始! 持续".concat(t.waitingTimeOut,"毫秒则确认卡死")),this._bufferBreakTimer=setTimeout((function(){e.isDestroy||(1===e._bufferBreakFlag&&(e._bufferBreakFlag=2,e.log("确认卡死!!!"),e._errorHandler(new m.Errors(e.player,{errorType:"runtime",errorTypeCode:nn.runtime,errorCode:tn.waitTimeout,errorMessage:"wait_timeout",vid:t.vid}))),e._bufferBreakTimer=null)}),t.waitingTimeOut)),this._lastCurrentTime=i.currentTime)}},{key:"isDestroy",get:function(){return!this.player}},{key:"_stopProgress",value:function(){this._hasStartProgress=!1,this._requestTimer&&(this._requestTimer.stop(),this._requestTimer=null),this._bufferBreakTimer&&(clearTimeout(this._bufferBreakTimer),this._bufferBreakTimer=null,this._bufferBreakFlag=void 0)}},{key:"_startProgress",value:function(){var e=this;this._hasStartProgress||(this._stopProgress(),this._requestTimer=new Rn((function(){e._requestTimer&&e._onTimeUpdate()})),this._requestTimer.tickEvery(this.config.tickInSeconds),this._hasStartProgress=!0)}},{key:"log",value:function(e){for(var t=this.playerConfig,i=t&&t.vid?"[Index]".concat(t.vid," ").concat(e):"[Index] ".concat(e),n=arguments.length,s=new Array(n>1?n-1:0),a=1;a<n;a++)s[a-1]=arguments[a];Xn.apply(void 0,[i].concat(s))}},{key:"_reset",value:function(){this._isMseInit=!1,this.endofstream=!1,this._curLoadSegmentIdx=0,this._removeBuffeEndTime=0,this._isChangeDefinition=!1,this._stopProgress(),this.mp4&&(this.mp4.off(Sn,this._onMp4MetaReady),this.mp4.off(xn,this._onMp4Error),this.mp4.off(gn,this._onMp4DataCallBack),this.mp4.destroy(),this.mp4=null),this.mse&&(this.mse.unbindMedia(),this.mse=null),this._unloadVideo()}},{key:"_unloadVideo",value:function(){var e=this.player;try{this.log("unloadVideo src ".concat(e.video.src)),e.video&&e.video.src&&(e.video.removeAttribute("src"),e.video.load())}catch(t){this.log("unloadVideo error",t)}}},{key:"destroy",value:function(){var e=this.player;e.removeHooks("replay",this._replayHook),e.removeHooks("retry",this._retryHook),this.detachEvents(),this._reset(),this.player.playNext=wn,this.player._startInit=Mn,this.player.changeDefinition=Kn,this.player.switchURL=In,this._bufferBreakTimer&&clearInterval(this._bufferBreakTimer),this._removeBufferTimer&&(clearTimeout(this._removeBufferTimer),this._removeBufferTimer=null),this._waitInBufferTimer&&(clearTimeout(this._waitInBufferTimer),this._waitInBufferTimer=null)}}],[{key:"pluginName",get:function(){return"mp4Plugin"}},{key:"defaultConfig",get:function(){return{maxBufferLength:40,minBufferLength:5,disableBufferBreakCheck:!1,waitingTimeOut:15e3,waitingInBufferTimeOut:5e3,waitJampBufferMaxCnt:3,tickInSeconds:.1,reqOptions:null,closeDowngrade:!1}}},{key:"version",get:function(){return"3.0.20"}}]),a}(m.BasePlugin);return Hn}));
//# sourceMappingURL=index.min.js.map
